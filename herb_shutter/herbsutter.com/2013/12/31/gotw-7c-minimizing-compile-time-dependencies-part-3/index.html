<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
<head profile="http://gmpg.org/xfn/11">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>GotW #7c: Minimizing Compile-Time Dependencies, Part 3 | Sutter’s Mill</title>
<link rel="pingback" href="https://herbsutter.com/xmlrpc.php" />
<script type="text/javascript">
  WebFontConfig = {"typekit":{"id":"eyo0tqd"}};
  (function() {
    var wf = document.createElement('script');
    wf.src = 'https://s0.wp.com/wp-content/plugins/custom-fonts/js/webfont.js';
    wf.type = 'text/javascript';
    wf.async = 'true';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(wf, s);
	})();
</script><style id="jetpack-custom-fonts-css">.wf-active #header h1{font-size:2.12em;font-family:"ff-dagny-web-pro-1","ff-dagny-web-pro-2",sans-serif;font-style:normal;font-weight:400}.wf-active body{font-size:89.7%;font-family:"ff-basic-gothic-web-pro-1","ff-basic-gothic-web-pro-2",sans-serif}.wf-active #navigation{font-family:"ff-basic-gothic-web-pro-1","ff-basic-gothic-web-pro-2",sans-serif}.wf-active #navigation ul li.search{font-size:1.06em}.wf-active #navigation ul li.search input#searchsubmit{font-size:1.06em}.wf-active #content .post-info, .wf-active #content .postmetadata{font-size:1.06em}.wf-active #sidebar{font-size:1.06em}.wf-active #footer p.right{font-size:1.06em}.wf-active .commentnum{font-size:1.77em}.wf-active .commentlist li .cmtinfo{font-size:1.18em}.wf-active .commentlist li .cmtinfo em{font-size:1.06em}.wf-active #respond label{font-size:11.8px}.wf-active #respond .required{font-size:11.8px}.wf-active #respond .subscribe-label{font-size:14.2px}.wf-active #respond .comment-notes{font-size:13px}.wf-active .wp-caption p.wp-caption-text{font-size:13px}.wf-active #content h1, .wf-active h2, .wf-active h3, .wf-active h4, .wf-active h5, .wf-active h6{font-family:"ff-dagny-web-pro-1","ff-dagny-web-pro-2",sans-serif;font-style:normal;font-weight:400}.wf-active #header h2{font-size:1.18em;font-weight:400;font-family:"ff-dagny-web-pro-1","ff-dagny-web-pro-2",sans-serif;font-style:normal}.wf-active #content h3{font-size:1.65em;font-weight:400;font-style:normal}.wf-active #content h4{font-size:1.3em;font-style:normal;font-weight:400}.wf-active #content h5{font-size:1.18em;font-style:normal;font-weight:400}.wf-active #content .post h2{font-size:1.65em;font-weight:400;font-style:normal}.wf-active li.sidebox h2{font-weight:400;font-size:1.89em;font-style:normal}.wf-active .post h4{font-size:1.18em;font-weight:400;font-family:"ff-dagny-web-pro-1","ff-dagny-web-pro-2",sans-serif;font-style:normal}.wf-active .post h4 em{font-style:normal;font-weight:400}</style>
		<script src='https://r-login.wordpress.com/remote-login.php?action=js&amp;host=herbsutter.com&amp;id=3379246&amp;t=1542965385&amp;back=https%3A%2F%2Fherbsutter.com%2F2013%2F12%2F31%2Fgotw-7c-minimizing-compile-time-dependencies-part-3%2F' type="text/javascript"></script>
		<script type="text/javascript">
		/* <![CDATA[ */
			if ( 'function' === typeof WPRemoteLogin ) {
				document.cookie = "wordpress_test_cookie=test; path=/";
				if ( document.cookie.match( /(;|^)\s*wordpress_test_cookie\=/ ) ) {
					WPRemoteLogin();
				}
			}
		/* ]]> */
		</script>
		<link rel='dns-prefetch' href='//s2.wp.com' />
<link rel='dns-prefetch' href='//s0.wp.com' />
<link rel='dns-prefetch' href='//s1.wp.com' />
<link rel='dns-prefetch' href='//herbsutter.wordpress.com' />
<link rel="alternate" type="application/rss+xml" title="Sutter’s Mill &raquo; Feed" href="https://herbsutter.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Sutter’s Mill &raquo; Comments Feed" href="https://herbsutter.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Sutter’s Mill &raquo; GotW #7c: Minimizing Compile-Time Dependencies, Part&nbsp;3 Comments Feed" href="https://herbsutter.com/2013/12/31/gotw-7c-minimizing-compile-time-dependencies-part-3/feed/" />
	<script type="text/javascript">
		/* <![CDATA[ */
		function addLoadEvent(func) {
			var oldonload = window.onload;
			if (typeof window.onload != 'function') {
				window.onload = func;
			} else {
				window.onload = function () {
					oldonload();
					func();
				}
			}
		}
		/* ]]> */
	</script>
			<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s0.wp.com\/wp-content\/mu-plugins\/wpcom-smileys\/twemoji\/2\/72x72\/","ext":".png","svgUrl":"https:\/\/s0.wp.com\/wp-content\/mu-plugins\/wpcom-smileys\/twemoji\/2\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/s1.wp.com\/wp-includes\/js\/wp-emoji-release.min.js?m=1532082729h&ver=4.9.8"}};
			!function(a,b,c){function d(a,b){var c=String.fromCharCode;l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,a),0,0);var d=k.toDataURL();l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,b),0,0);var e=k.toDataURL();return d===e}function e(a){var b;if(!l||!l.fillText)return!1;switch(l.textBaseline="top",l.font="600 32px Arial",a){case"flag":return!(b=d([55356,56826,55356,56819],[55356,56826,8203,55356,56819]))&&(b=d([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]),!b);case"emoji":return b=d([55358,56760,9792,65039],[55358,56760,8203,9792,65039]),!b}return!1}function f(a){var c=b.createElement("script");c.src=a,c.defer=c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var g,h,i,j,k=b.createElement("canvas"),l=k.getContext&&k.getContext("2d");for(j=Array("flag","emoji"),c.supports={everything:!0,everythingExceptFlag:!0},i=0;i<j.length;i++)c.supports[j[i]]=e(j[i]),c.supports.everything=c.supports.everything&&c.supports[j[i]],"flag"!==j[i]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[j[i]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(h=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",h,!1),a.addEventListener("load",h,!1)):(a.attachEvent("onload",h),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),g=c.source||{},g.concatemoji?f(g.concatemoji):g.wpemoji&&g.twemoji&&(f(g.twemoji),f(g.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
	<link rel='stylesheet' id='all-css-0-1' href='https://s2.wp.com/_static/??-eJyNkN1uwjAMhV9onsUG69W0Z0laE0zzp8QR6tvjUlUCwSpuonOS81knxkuGPkWhKBgaZN8cx4qeR6p4JsmmH+HmPvtaP/B1nOORI8uEcqKgYG4WA1eZfErjFtinQnofspE5EWhgQ15nRNnCQv5ZqVmetORmv0vWNFibC9UKegZuAZayT9wKuabWUnEwt0Tb2A9ofbotxBZTJpx/SE8DXi3hn+h9Rx4cSUVJGXKqqt5GaurZeGCNPJoFZoxJlsdVbE11lEB/aYRTfDBw9IbLFlpI9+NUOtTUnZ2hv/C7O+y/uu9uf+jOV8Xg7sY=?cssminify=yes' type='text/css' media='all' />
<link rel='stylesheet' id='print-css-1-1' href='https://s2.wp.com/wp-content/mu-plugins/global-print/global-print.css?m=1465851035h&cssminify=yes' type='text/css' media='print' />
<link rel='stylesheet' id='all-css-2-1' href='https://s0.wp.com/_static/??/wp-content/mu-plugins/actionbar/actionbar.css,/wp-content/themes/h4/global.css?m=1516985148j&cssminify=yes' type='text/css' media='all' />
<script type='text/javascript' src='https://s0.wp.com/_static/??-eJyFztEKwjAMBdAfsquTiXsRv6XWOFKXtDbphn69HeiDMBQCgdzDJXZOBtmP5QJiQ517gfx4rybIxv4ChnDITqEh5A/2kRVYF0vxjCOYIpDdUG+16BpXXIqiBCIVraTfLyFPCPNfFkCT8zeTQfC5tJ7o2Hb9Yde3+24bXjRNW9I='></script>
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://herbsutter.wordpress.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://s1.wp.com/wp-includes/wlwmanifest.xml" /> 
<link rel='prev' title='GotW #7b Solution: Minimizing Compile-Time Dependencies, Part&nbsp;2' href='https://herbsutter.com/2013/12/31/gotw-7b-solution-minimizing-compile-time-dependencies-part-2/' />
<link rel='next' title='GotW #7c Solution: Minimizing Compile-Time Dependencies, Part&nbsp;3' href='https://herbsutter.com/2014/01/06/gotw-7c-solution-minimizing-compile-time-dependencies-part-3/' />
<meta name="generator" content="WordPress.com" />
<link rel="canonical" href="https://herbsutter.com/2013/12/31/gotw-7c-minimizing-compile-time-dependencies-part-3/" />
<link rel='shortlink' href='https://wp.me/peb5Y-Cv' />
<link rel="alternate" type="application/json+oembed" href="https://public-api.wordpress.com/oembed/?format=json&amp;url=https%3A%2F%2Fherbsutter.com%2F2013%2F12%2F31%2Fgotw-7c-minimizing-compile-time-dependencies-part-3%2F&amp;for=wpcom-auto-discovery" /><link rel="alternate" type="application/xml+oembed" href="https://public-api.wordpress.com/oembed/?format=xml&amp;url=https%3A%2F%2Fherbsutter.com%2F2013%2F12%2F31%2Fgotw-7c-minimizing-compile-time-dependencies-part-3%2F&amp;for=wpcom-auto-discovery" />
<!-- Jetpack Open Graph Tags -->
<meta property="og:type" content="article" />
<meta property="og:title" content="GotW #7c: Minimizing Compile-Time Dependencies, Part 3" />
<meta property="og:url" content="https://herbsutter.com/2013/12/31/gotw-7c-minimizing-compile-time-dependencies-part-3/" />
<meta property="og:description" content="Now the unnecessary headers have been removed, and avoidable dependencies on the internals of the class have been eliminated. Is there any further decoupling that can be done? The answer takes us b…" />
<meta property="article:published_time" content="2013-12-31T20:32:15+00:00" />
<meta property="article:modified_time" content="2013-12-31T20:32:15+00:00" />
<meta property="og:site_name" content="Sutter’s Mill" />
<meta property="og:image" content="https://secure.gravatar.com/blavatar/4554b8d24c7f200dc5e2e1b18db1893f?s=200&amp;ts=1542965385" />
<meta property="og:image:width" content="200" />
<meta property="og:image:height" content="200" />
<meta property="og:locale" content="en_US" />
<meta name="twitter:site" content="@wordpressdotcom" />
<meta name="twitter:text:title" content="GotW #7c: Minimizing Compile-Time Dependencies, Part&nbsp;3" />
<meta name="twitter:image" content="https://secure.gravatar.com/blavatar/4554b8d24c7f200dc5e2e1b18db1893f?s=240" />
<meta name="twitter:card" content="summary" />
<meta property="article:publisher" content="https://www.facebook.com/WordPresscom" />

<!-- End Jetpack Open Graph Tags -->
<link rel="shortcut icon" type="image/x-icon" href="https://secure.gravatar.com/blavatar/4554b8d24c7f200dc5e2e1b18db1893f?s=32" sizes="16x16" />
<link rel="icon" type="image/x-icon" href="https://secure.gravatar.com/blavatar/4554b8d24c7f200dc5e2e1b18db1893f?s=32" sizes="16x16" />
<link rel="apple-touch-icon-precomposed" href="https://secure.gravatar.com/blavatar/4554b8d24c7f200dc5e2e1b18db1893f?s=114" />
<link rel='openid.server' href='https://herbsutter.wordpress.com/?openidserver=1' />
<link rel='openid.delegate' href='https://herbsutter.wordpress.com/' />
<link rel="search" type="application/opensearchdescription+xml" href="https://herbsutter.com/osd.xml" title="Sutter’s Mill" />
<link rel="search" type="application/opensearchdescription+xml" href="https://s1.wp.com/opensearch.xml" title="WordPress.com" />
		<style id="wpcom-hotfix-masterbar-style">
			@media screen and (min-width: 783px) {
				#wpadminbar .quicklinks li#wp-admin-bar-my-account.with-avatar > a img {
					margin-top: 5px;
				}
			}
		</style>
		<script type="text/javascript" id="webfont-output">
  
  WebFontConfig = {"typekit":{"id":"cjs1oxc"}};
  (function() {
    var wf = document.createElement('script');
    wf.src = ('https:' == document.location.protocol ? 'https' : 'http') +
      '://ajax.googleapis.com/ajax/libs/webfont/1/webfont.js';
    wf.type = 'text/javascript';
    wf.async = 'true';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(wf, s);
	})();
</script><style type="text/css">
.widget_twitter li {
	word-wrap: break-word;
}
</style>
<meta name="application-name" content="Sutter’s Mill" /><meta name="msapplication-window" content="width=device-width;height=device-height" /><meta name="msapplication-tooltip" content="Herb Sutter on software development" /><meta name="msapplication-task" content="name=Subscribe;action-uri=https://herbsutter.com/feed/;icon-uri=https://secure.gravatar.com/blavatar/4554b8d24c7f200dc5e2e1b18db1893f?s=16" /><meta name="msapplication-task" content="name=Sign up for a free blog;action-uri=http://wordpress.com/signup/;icon-uri=https://s1.wp.com/i/favicon.ico" /><meta name="msapplication-task" content="name=WordPress.com Support;action-uri=http://support.wordpress.com/;icon-uri=https://s1.wp.com/i/favicon.ico" /><meta name="msapplication-task" content="name=WordPress.com Forums;action-uri=http://forums.wordpress.com/;icon-uri=https://s1.wp.com/i/favicon.ico" /><meta name="description" content="Now the unnecessary headers have been removed, and avoidable dependencies on the internals of the class have been eliminated. Is there any further decoupling that can be done? The answer takes us back to basic principles of solid class design.  Problem JG Question 1. What is the tightest coupling you can express in C++? And&hellip;" />
<style type="text/css">
			#header h1 a,
		#header h2 {
			color: #265E15 !important;
		}
				#headerimage {
			background: url('https://herbsutter.files.wordpress.com/2011/10/cropped-blog-header.jpg') no-repeat;
			height: 200px;
		}
	</style>
<link rel="amphtml" href="https://herbsutter.com/2013/12/31/gotw-7c-minimizing-compile-time-dependencies-part-3/amp/"><style type="text/css" id="syntaxhighlighteranchor"></style>
		<link rel="stylesheet" id="custom-css-css" type="text/css" href="https://s2.wp.com/?custom-css=1&#038;csblog=eb5Y&#038;cscache=6&#038;csrev=60" />
		</head>
<body id="section-index" class="post-template-default single single-post postid-2387 single-format-standard mp6 customizer-styles-applied highlander-enabled highlander-light">


<div id="navigation" class="clearfix">
		<div class="menu">
		<ul>
			<li ><a href="https://herbsutter.com/" title="Home">Home</a></li>
			<li class="page_item page-item-912"><a href="https://herbsutter.com/welcome-to-the-jungle/">Welcome to the&nbsp;Jungle</a></li>
<li class="page_item page-item-864 page_item_has_children"><a href="https://herbsutter.com/gotw/">GotW</a></li>
<li class="page_item page-item-761"><a href="https://herbsutter.com/elements-of-modern-c-style/">Elements of Modern C++&nbsp;Style</a></li>
<li class="page_item page-item-2 page_item_has_children"><a href="https://herbsutter.com/about/">About</a></li>
									<li class="search"><form method="get" id="searchform" action="https://herbsutter.com"><input type="text" class="textbox" value="" name="s" id="s" /><input type="submit" id="searchsubmit" value="Search" /></form></li>
					</ul>
	</div>
</div><!-- end id:navigation -->

<div id="container">

<div id="header">
<h1><a href="https://herbsutter.com/" title="Sutter’s Mill">Sutter’s Mill</a></h1>
<h2>Herb Sutter on software development</h2>
</div><!-- end id:header -->


	
		<div id="feedarea">
	<dl>
		<dt><strong>Feeds:</strong></dt>

			<dd><a href="https://herbsutter.com/feed/">Posts</a></dd>
	
			<dd><a href="https://herbsutter.com/comments/feed/">Comments</a></dd>
		</dl>
	</div><!-- end id:feedarea -->
	
	<div id="headerimage">
</div><!-- end id:headerimage -->

<div id="content">
<div id="content-main">

		
									<div class="postnav">
				<div class="alignleft">&laquo; <a href="https://herbsutter.com/2013/12/31/gotw-7b-solution-minimizing-compile-time-dependencies-part-2/" rel="prev">GotW #7b Solution: Minimizing Compile-Time Dependencies, Part&nbsp;2</a></div>
				<div class="alignright"><a href="https://herbsutter.com/2014/01/06/gotw-7c-solution-minimizing-compile-time-dependencies-part-3/" rel="next">GotW #7c Solution: Minimizing Compile-Time Dependencies, Part&nbsp;3</a> &raquo;</div>
			</div>
			
			<div class="post-2387 post type-post status-publish format-standard hentry category-gotw" id="post-2387">
				<div class="posttitle">
					<h2>GotW #7c: Minimizing Compile-Time Dependencies, Part&nbsp;3</h2>
					<p class="post-info">2013-12-31 by <a href="https://herbsutter.com/author/herbsutter/" title="Posts by Herb Sutter">Herb Sutter</a>  </p>
				</div>

				<div class="entry">
					<p><span style="color:#5a5a5a;"><em>Now the unnecessary headers have been removed, and avoidable dependencies on the internals of the class have been eliminated. Is there any further decoupling that can be done? The answer takes us back to basic principles of solid class design.<br />
</em></span></p>
<p>
 </p>
<h1>Problem<br />
</h1>
<h2>JG Question<br />
</h2>
<p>1. What is the tightest coupling you can express in C++? And what&#8217;s the second-tightest?
</p>
<h2>Guru Question<br />
</h2>
<p>2. The Incredible Shrinking Header has now been greatly trimmed, but there may still be ways to reduce the dependencies further. What further <span style="color:#2e74b5;">#include</span>s could be removed if we made further changes to <span style="color:#2e74b5;">X</span>, and how?
</p>
<p>This time, you may make any changes at all to <span style="color:#2e74b5;">X</span> as long as they don&#8217;t change its public interface, so that existing code that uses <span style="color:#2e74b5;">X</span> is unaffected. Again, note that the comments are important.
</p>
<p style="background:#ffffcc;margin-left:14pt;">
<pre><code>//  x.h: after converting to use a Pimpl to hide implementation details<br />//<br />#include &lt;iosfwd&gt;<br />#include &lt;memory&gt;<br />#include "a.h"  // class A (has virtual functions)<br />#include "b.h"  // class B (has no virtual functions)<br />class C;<br />class E;<br /><br />class X : public A, private B {<br />public:<br />       X( const C&amp; );<br />    B  f( int, char* );<br />    C  f( int, C );<br />    C&amp; g( B );<br />    E  h( E );<br />    virtual std::ostream&amp; print( std::ostream&amp; ) const;<br /><br />private:<br />    struct impl;<br />    std::unique_ptr&lt;impl&gt; pimpl;   // ptr to a forward-declared class<br />};<br /><br />std::ostream&amp; operator&lt;&lt;( std::ostream&amp; os, const X&amp; x ) {<br />    return x.print(os);<br />}
</code></pre></p>
									</div>

				<p class="postmetadata">
					Posted in <a href="https://herbsutter.com/category/c/gotw/" rel="category tag">GotW</a> | 											14 Comments									</p>
				
<!-- You can start editing here. -->

<h3 id="comments">14 Responses</h3>

	<ol class="commentlist">
			<li class="comment even thread-even depth-1 highlander-comment" id="comment-14037">
		<div id="div-comment-14037">
		<div class="cmtinfo"><em> on <a href="#comment-14037" title="">2014-01-06 at 3:46 am</a></em> <img alt='' src='https://2.gravatar.com/avatar/5fb79b33a16b20271f377e4847f0ae92?s=48&#038;d=identicon&#038;r=G' class='avatar avatar-48' height='48' width='48' /> <cite>Klimax</cite></div>
						<div class="pd-rating" id="pd_rating_holder_468178_comm_14037"></div><p>@Roman M:<br />
Timing can be enabled by setting:<br />
Tools-&gt;Options-&gt;Projects and Solutions-&gt;VC++ Project Settings-&gt;Build Timing<br />
(IIRC at least since VS 2010, but might be even earlier)</p>
<p>Output looks like</p>
<pre class="brush: plain; title: ; notranslate" title="">
12&gt;Project Performance Summary:
12&gt;    326932 ms  C:\Dan\Klimax-tools\tools\net\EmuleMorphXT\MorphXT\emule100.vcxproj   1 calls
12&gt;              326932 ms  Rebuild                                    1 calls

12&gt;Target Performance Summary:
12&gt;        0 ms  AfterRebuild                               1 calls
12&gt;        0 ms  ResolveReferences                          1 calls
12&gt;        0 ms  SelectClCompile                            1 calls
12&gt;        0 ms  _CheckForCompileOutputs                    1 calls
12&gt;        0 ms  GetResolvedWinMD                           1 calls
12&gt;        0 ms  CleanPublishFolder                         1 calls
12&gt;        0 ms  CleanReferencedProjects                    1 calls
12&gt;        0 ms  _PrepareForBuild                           1 calls
12&gt;        0 ms  _Midl                                      1 calls
12&gt;        0 ms  BuildCompile                               1 calls
12&gt;        0 ms  ComputeManifestGeneratedLinkerInputs       1 calls
12&gt;        0 ms  BeforeClean                                1 calls
12&gt;        0 ms  CreateCustomManifestResourceNames          1 calls
12&gt;        0 ms  AfterCppClean                              1 calls
12&gt;        0 ms  BeforeLink                                 1 calls
12&gt;        0 ms  AfterBuild                                 1 calls
12&gt;        0 ms  AfterBuildCompileEvent                     1 calls
12&gt;        0 ms  _BuildLinkAction                           1 calls
12&gt;        0 ms  BeforeResourceCompile                      1 calls
12&gt;        0 ms  AfterMidl                                  1 calls
12&gt;        0 ms  PreLinkEvent                               1 calls
12&gt;        0 ms  _ClCompile                                 1 calls
12&gt;        0 ms  AfterClean                                 1 calls
12&gt;        0 ms  SelectCustomBuild                          1 calls
12&gt;        0 ms  AfterClCompile                             1 calls
12&gt;        0 ms  _CopySourceItemsToOutputDirectory          1 calls
12&gt;        0 ms  AfterResourceCompile                       1 calls
12&gt;        0 ms  ComputeCustomBuildOutput                   1 calls
12&gt;        0 ms  _Xsd                                       1 calls
12&gt;        0 ms  AfterBuildGenerateSources                  1 calls
12&gt;        0 ms  Rebuild                                    1 calls
12&gt;        0 ms  MakeDirsForBscMake                         1 calls
12&gt;        0 ms  BeforeRebuild                              1 calls
12&gt;        0 ms  MakeDirsForResourceCompile                 1 calls
12&gt;        0 ms  _ResourceCompile                           1 calls
12&gt;        0 ms  ComputeLinkInputsFromProject               1 calls
12&gt;        0 ms  BeforeCppClean                             1 calls
12&gt;        0 ms  _Link                                      1 calls
12&gt;        0 ms  BuildLinkTraverse                          1 calls
12&gt;        0 ms  PrepareForRun                              1 calls
12&gt;        0 ms  _XdcMake                                   1 calls
12&gt;        0 ms  CreateSatelliteAssemblies                  1 calls
12&gt;        0 ms  MakeDirsForManifest                        1 calls
12&gt;        0 ms  SelectResourceCompile                      1 calls
12&gt;        0 ms  ExpandSDKReferences                        1 calls
12&gt;        0 ms  BuildCompileTraverse                       1 calls
12&gt;        0 ms  _GenerateSatelliteAssemblyInputs           1 calls
12&gt;        0 ms  _Deploy                                    1 calls
12&gt;        0 ms  ComputeMIDLGeneratedCompileInputs          1 calls
12&gt;        0 ms  CppClean                                   1 calls
12&gt;        0 ms  PrepareResourceNames                       1 calls
12&gt;        0 ms  AfterBuildGenerateSourcesEvent             1 calls
12&gt;        0 ms  _SplitProjectReferencesByFileExistence     1 calls
12&gt;        0 ms  BeforeClCompile                            1 calls
12&gt;        0 ms  _SelectedFiles                             1 calls
12&gt;        0 ms  AfterResolveReferences                     1 calls
12&gt;        0 ms  BeforeResolveReferences                    1 calls
12&gt;        0 ms  AfterLink                                  1 calls
12&gt;        0 ms  _ALink                                     1 calls
12&gt;        0 ms  PreBuildEvent                              1 calls
12&gt;        0 ms  MakeDirsForMidl                            1 calls
12&gt;        0 ms  _BscMake                                   1 calls
12&gt;        0 ms  ResolveSDKReferences                       1 calls
12&gt;        0 ms  _BuildGenerateSourcesAction                1 calls
12&gt;        0 ms  _Appverifier                               1 calls
12&gt;        0 ms  ComputeMASMOutput                          1 calls
12&gt;        0 ms  Clean                                      1 calls
12&gt;        0 ms  ComputeRCGeneratedLinkInputs               1 calls
12&gt;        0 ms  BuildGenerateSourcesTraverse               1 calls
12&gt;        0 ms  MakeDirsForXdcMake                         1 calls
12&gt;        0 ms  Build                                      1 calls
12&gt;        0 ms  BeforeBuildGenerateSources                 1 calls
12&gt;        0 ms  ResolvedXDCMake                            1 calls
12&gt;        0 ms  _PrepareForRebuild                         1 calls
12&gt;        0 ms  GetInstalledSDKLocations                   1 calls
12&gt;        0 ms  _BuildCompileAction                        1 calls
12&gt;        0 ms  BuildLink                                  1 calls
12&gt;        0 ms  ComputeLegacyManifestEmbedding             1 calls
12&gt;        0 ms  BuildGenerateSources                       1 calls
12&gt;        1 ms  PGInstrumentedClean                        1 calls
12&gt;        1 ms  ResolveAssemblyReferences                  1 calls
12&gt;        1 ms  CoreClean                                  1 calls
12&gt;        1 ms  ComputeLinkSwitches                        1 calls
12&gt;        1 ms  FinalizeBuildStatus                        1 calls
12&gt;        1 ms  CopyFilesToOutputDirectory                 1 calls
12&gt;        1 ms  AssignProjectConfiguration                 1 calls
12&gt;        1 ms  ComputeRCOutputs                           1 calls
12&gt;        1 ms  ResolveProjectReferences                   1 calls
12&gt;        1 ms  ComputeReferenceCLInput                    1 calls
12&gt;        1 ms  ComputeCLCompileGeneratedSbrFiles          1 calls
12&gt;        1 ms  GetCopyToOutputDirectoryXamlAppDefs        1 calls
12&gt;        1 ms  _PrepareForClean                           1 calls
12&gt;        1 ms  _CheckForInvalidConfigurationAndPlatform   1 calls
12&gt;        1 ms  ComputeManifestInputsTargets               1 calls
12&gt;        1 ms  GetFrameworkPaths                          1 calls
12&gt;        1 ms  GetReferenceAssemblyPaths                  1 calls
12&gt;        1 ms  GetCopyToOutputDirectoryItems              1 calls
12&gt;        1 ms  PlatformPrepareForBuild                    1 calls
12&gt;        1 ms  SplitResourcesByCulture                    1 calls
12&gt;        2 ms  _PrepareForReferenceResolution             1 calls
12&gt;        2 ms  MakeDirsForCl                              1 calls
12&gt;        2 ms  ComputeCLInputPDBName                      1 calls
12&gt;        2 ms  DoLinkOutputFilesMatch                     1 calls
12&gt;        2 ms  MakeDirsForLink                            1 calls
12&gt;        3 ms  ComputeCLGeneratedLinkInputs               1 calls
12&gt;        3 ms  ComputeCLCompileGeneratedXDCFiles          1 calls
12&gt;        3 ms  CheckInstalledVCLibsIPP                    1 calls
12&gt;        3 ms  SetBuildDefaultEnvironmentVariables        1 calls
12&gt;        3 ms  InitializeBuildStatus                      1 calls
12&gt;        4 ms  ComputeLinkImportLibraryOutputsForClean    1 calls
12&gt;        5 ms  RegisterOutput                             1 calls
12&gt;        5 ms  AssignTargetPaths                          1 calls
12&gt;        8 ms  SetCABuildNativeEnvironmentVariables       1 calls
12&gt;       10 ms  ComputeCLOutputs                           1 calls
12&gt;       16 ms  PrepareForBuild                            1 calls
12&gt;       53 ms  WarnCompileDuplicatedFilename              1 calls
12&gt;      154 ms  PostBuildEvent                             1 calls
12&gt;      295 ms  CoreCppClean                               1 calls
12&gt;      301 ms  Manifest                                   1 calls
12&gt;      302 ms  _Manifest                                  1 calls
12&gt;      565 ms  ResourceCompile                            1 calls
12&gt;      651 ms  _MASM                                      2 calls
12&gt;     4252 ms  Link                                       1 calls
12&gt;    320559 ms  ClCompile                                  1 calls
</pre>
<p>Output is per-project.</p>
			<br style="clear: both" />
		</div>
</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1 highlander-comment" id="comment-14036">
		<div id="div-comment-14036">
		<div class="cmtinfo"><em> on <a href="#comment-14036" title="">2014-01-06 at 3:43 am</a></em> <img alt='' src='https://0.gravatar.com/avatar/c962f8b7f16ad1aeec1fd7291eda9da3?s=48&#038;d=identicon&#038;r=G' class='avatar avatar-48' height='48' width='48' /> <cite>Roman M.</cite></div>
						<div class="pd-rating" id="pd_rating_holder_468178_comm_14036"></div><p>@Loïc Joly: I am aware of the tool you&#8217;ve mentioned. Our codebase is Visual Studio C++ &#8211; only. Some time ago I tried it and couldn&#8217;t get it running because of Microsoft&#8217;s implementation of STL. Current &#8220;README.txt&#8221; of &#8220;Include What You Use&#8221;-Project  states:</p>
<p>&#8220;IWYU, like Clang, does not yet handle some of the non-standard constructs in Microsoft&#8217;s STL headers.&#8221;</p>
<p>On the other hand, I found recent message: <a href="http://lists.cs.uiuc.edu/pipermail/cfe-dev/2013-October/032629.html" rel="nofollow">http://lists.cs.uiuc.edu/pipermail/cfe-dev/2013-October/032629.html</a> in CLANG mailing list that states that support for MS-STL has improved, so maybe now it the time to give it another try. I just wish I had something similar from Microsoft.</p>
			<br style="clear: both" />
		</div>
</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1 highlander-comment" id="comment-14035">
		<div id="div-comment-14035">
		<div class="cmtinfo"><em> on <a href="#comment-14035" title="">2014-01-05 at 1:41 pm</a></em> <img alt='' src='https://1.gravatar.com/avatar/160af1e5b18bff3acd0bf988e8bbfe2e?s=48&#038;d=identicon&#038;r=G' class='avatar avatar-48' height='48' width='48' /> <cite>Loïc Joly</cite></div>
						<div class="pd-rating" id="pd_rating_holder_468178_comm_14035"></div><p>@Roman &#8220;- we have absolutely _no_ tool support, so a developer have to _guess_ which header has greatest impact and is worth her time;&#8221;</p>
<p>There is a tool whose puspose is to automate someway header files removal: <a href="http://code.google.com/p/include-what-you-use/" rel="nofollow">http://code.google.com/p/include-what-you-use/</a> I&#8217;ve not used it myself, so I cannot say how good I think it is. It has some quite complex heuristics to select which files should be included, and which fiels should not (it does not try to get to the absolute minimal). This article describes some of them: <a href="http://code.google.com/p/include-what-you-use/wiki/WhyIWYUIsDifficult" rel="nofollow">http://code.google.com/p/include-what-you-use/wiki/WhyIWYUIsDifficult</a>.</p>
			<br style="clear: both" />
		</div>
</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1 highlander-comment" id="comment-14026">
		<div id="div-comment-14026">
		<div class="cmtinfo"><em> on <a href="#comment-14026" title="">2014-01-04 at 5:30 am</a></em> <img alt='' src='https://0.gravatar.com/avatar/c962f8b7f16ad1aeec1fd7291eda9da3?s=48&#038;d=identicon&#038;r=G' class='avatar avatar-48' height='48' width='48' /> <cite>Roman M.</cite></div>
						<div class="pd-rating" id="pd_rating_holder_468178_comm_14026"></div><p>@Jussi: nice script you have there! I am not aware of something similar Visual C++. Unfortunately your blog-post didn&#8217;t reveal whether good compilation throughput is due to PIMPL or just because those CPPs define base classes and naturally have no or small dependencies. the mere fact of such big compile throughput variation in diverse projects suggests that solving compile time issues is hard. Your measurement, while offering interesting insights, lacks information where is make sense to introduce Pimpl &#8211; the closer to class hierarchy root we get, the bigger impact can be expected. One would need some kind of directed header include graph weighted by compilation time of corresponding CPP.</p>
<p>On the side note: in my projects about 60% of build time is spent by the linker, but thats another story ;)</p>
			<br style="clear: both" />
		</div>
</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1 highlander-comment" id="comment-14022">
		<div id="div-comment-14022">
		<div class="cmtinfo"><em> on <a href="#comment-14022" title="">2014-01-03 at 5:47 am</a></em> <img alt='' src='https://0.gravatar.com/avatar/0f4e4820621a23b0fba545c636001db5?s=48&#038;d=identicon&#038;r=G' class='avatar avatar-48' height='48' width='48' /> <cite><a href='http://voices.canonical.com/jussi.pakkanen/' rel='external nofollow' class='url'>Jussi Pakkanen</a></cite></div>
						<div class="pd-rating" id="pd_rating_holder_468178_comm_14022"></div><p>@roman, the difference in compile speeds between pimpl&#8217;d and non-pimpl&#8217;d code bases can be huge. Not 10%. Not even 50%. The difference can be an order of magnitude. I made a measurement of different code bases a while ago:</p>
<p><a href="http://voices.canonical.com/jussi.pakkanen/2013/08/23/comparing-build-speeds-of-different-code-bases/" rel="nofollow">http://voices.canonical.com/jussi.pakkanen/2013/08/23/comparing-build-speeds-of-different-code-bases/</a></p>
<p>This speed increase alone has massive customer value: programmers can get stuff done faster so you can create better products faster, fix bugs faster and so on. Once you have experienced near-instantaneous incremental build times in C++ you never want to go back to spending minutes at a time watching scrolling text in a terminal.</p>
			<br style="clear: both" />
		</div>
</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1 highlander-comment" id="comment-14007">
		<div id="div-comment-14007">
		<div class="cmtinfo"><em> on <a href="#comment-14007" title="">2014-01-02 at 7:50 am</a></em> <img alt='' src='https://0.gravatar.com/avatar/c962f8b7f16ad1aeec1fd7291eda9da3?s=48&#038;d=identicon&#038;r=G' class='avatar avatar-48' height='48' width='48' /> <cite>Roman M.</cite></div>
						<div class="pd-rating" id="pd_rating_holder_468178_comm_14007"></div><p>Hello Herb,<br />
in my experience, using your advice at the current language state in large projects is unfortunately utopical and rarely pays off:</p>
<p>&#8211; dependency rules are often not obvious, so a conservative developer will rather include too much instead of risking a broken build;<br />
&#8211; we have to sacrifice performance for a compile-time issue which has arguably zero customer value;<br />
&#8211; we have absolutely _no_ tool support, so a developer have to _guess_ which header has greatest impact and is worth her time;<br />
&#8211; even if some issues were somehow located and fixed using PIMPL, a regression is just a matter of time;<br />
&#8211; templates make sutuation much worse;</p>
<p>Some time ago I&#8217;ve create an issue on User-Voice (<a href="http://visualstudio.uservoice.com/forums/121579-visual-studio/suggestions/2680137-make-header-include-refactoring-possible" rel="nofollow">http://visualstudio.uservoice.com/forums/121579-visual-studio/suggestions/2680137-make-header-include-refactoring-possible</a>). I understand that creating good solution for compile-time issues is far from trivial, but currently I would probably invest in better hardware instead of wasting my time on PIMPL</p>
			<br style="clear: both" />
		</div>
</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1 highlander-comment" id="comment-14005">
		<div id="div-comment-14005">
		<div class="cmtinfo"><em> on <a href="#comment-14005" title="">2014-01-02 at 4:47 am</a></em> <img alt='' src='https://1.gravatar.com/avatar/11e11da9e2269e401cceab5ca321dd7f?s=48&#038;d=identicon&#038;r=G' class='avatar avatar-48' height='48' width='48' /> <cite><a href='http://levelofindirection.com' rel='external nofollow' class='url'>Phil Nash</a></cite></div>
						<div class="pd-rating" id="pd_rating_holder_468178_comm_14005"></div><p>@Herb. This is not a response to your questions, but is pertinent to the topic.</p>
<p>I&#8217;ve been following this series with interest to see if I can pick up any more tips in my war against build-time sapping dependencies. While it&#8217;s all been good stuff and covered well I&#8217;ve not seen anything new &#8211; yet I still suffer from productivity killing compile times in several projects I&#8217;m working on (to be clear, these are mostly legacy code bases where it&#8217;s too late for the large scale refactoring necessary to take advantage of some of these techniques on enough of the code-base &#8211; or the runtime cost is too high &#8211; e.g. with the pImpl idiom).<br />
We&#8217;ve had some success with pre-compiled headers &#8211; but also constantly have problems with them (VS2008 &#8211; has it finally got any better in more recent incarnations?).</p>
<p>In the first post you alluded to modules &#8211; which I think should be a huge win in this area. But when I asked Bjarne about it earlier this year he seemed to think they weren&#8217;t even on the radar for C++17 at this point. Is that still the case? Can you give any more insight here? Will you really be covering it in an upcoming post?</p>
			<br style="clear: both" />
		</div>
</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1 highlander-comment" id="comment-14004">
		<div id="div-comment-14004">
		<div class="cmtinfo"><em> on <a href="#comment-14004" title="">2014-01-02 at 4:39 am</a></em> <img alt='' src='https://1.gravatar.com/avatar/11e11da9e2269e401cceab5ca321dd7f?s=48&#038;d=identicon&#038;r=G' class='avatar avatar-48' height='48' width='48' /> <cite><a href='http://levelofindirection.com' rel='external nofollow' class='url'>Phil Nash</a></cite></div>
						<div class="pd-rating" id="pd_rating_holder_468178_comm_14004"></div><p>@Matthieu (&amp; @herb) the fixed sized block of storage with placement new (and explicit destructor) is the usual solution. As Herb says adding a bit of extra headroom is usually a good idea.<br />
Another good idea is to put a static assert in the implementation to make sure the compiler tells you if that size ever becomes too small.</p>
<p>However, it may also be worth considering using a pool allocator, or some other more efficient allocator (I&#8217;ve found tbb&#8217;s scalable_allocator to be a very good general purpose allocator) to keep the size dynamic (and thus always correct), but with a much smaller overhead. You can&#8217;t beat the near zero overhead of the obtrusive storage block but a decent allocator may be good enough for a lot of cases where the std allocator isn&#8217;t.</p>
			<br style="clear: both" />
		</div>
</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1 highlander-comment" id="comment-13989">
		<div id="div-comment-13989">
		<div class="cmtinfo"><em> on <a href="#comment-13989" title="">2014-01-01 at 9:45 am</a></em> <img alt='' src='https://0.gravatar.com/avatar/fa57d3850a3a7e25b4cbcfda4d620e4d?s=48&#038;d=identicon&#038;r=G' class='avatar avatar-48' height='48' width='48' /> <cite>PiotrP</cite></div>
						<div class="pd-rating" id="pd_rating_holder_468178_comm_13989"></div><p>1) I think tightest coupling in cpp is friendship(it gives private members access to non related class/methods). Inheritance is second.</p>
<p>2) Relationship with B can be moved to impl, since B has no virtual functions and it&#8217;s private base class of X.<br />
This modification doesn&#8217;t change public interface of X.</p>
<pre class="brush: plain; title: ; notranslate" title="">
//x.h

#include &quot;a.h&quot;  // class A (has virtual functions)
class B;  // class B (has no virtual functions) - forward declared
class C;
class E;

class X : public A{
public:
       X( const C&amp; );
    B  f( int, char* );
    C  f( int, C );
    C&amp; g( B );
    E  h( E );
    ~X();
    virtual std::ostream&amp; print( std::ostream&amp; ) const;

private:
    struct impl;
    std::unique_ptr&lt;impl&gt; pimpl;   // ptr to a forward-declared class
};
</pre>
<pre class="brush: plain; title: ; notranslate" title="">
//x.cpp
#include &quot;b.h&quot;
struct X::impl: public B{
    /* ... */
}
X::X( const C&amp; ) : pimpl{ make_unique&lt;X::impl&gt;(/*...*/) } { }
X::~X() = default;

</pre>
<p>After changes all calls of B methods in X should be redirected to impl.<br />
To make it work B should be public base of X::impl. If B has protected members, such calls should be enclosed by public functions to allow access from X. Another way to do it is to add friendship between X::impl and X (B can remain private base of X::impl).</p>
			<br style="clear: both" />
		</div>
</li><!-- #comment-## -->
		<li class="comment byuser comment-author-herbsutter bypostauthor odd alt thread-odd thread-alt depth-1 highlander-comment" id="comment-13988">
		<div id="div-comment-13988">
		<div class="cmtinfo"><em> on <a href="#comment-13988" title="">2014-01-01 at 7:31 am</a></em> <img alt='' src='https://0.gravatar.com/avatar/c0ba56bfd231f8f04feb057728975181?s=48&#038;d=identicon&#038;r=G' class='avatar avatar-48' height='48' width='48' /> <cite><a href='http://www.herbsutter.com' rel='external nofollow' class='url'>Herb Sutter</a></cite></div>
						<div class="pd-rating" id="pd_rating_holder_468178_comm_13988"></div><p>@Matthieu: Yes, that&#8217;s basically what you&#8217;d need to do to avoid the allocation overhead in Pimpl &#8212; have a block of storage in the class of sufficient size, perhaps with extra space so that you can add some extra members in the future without causing an ABI breakage or recompilation.</p>
<p>Edited to add: BTW, I covered this topic in GotW #28 back in 1997. That one will (eventually) get updated too.</p>
			<br style="clear: both" />
		</div>
</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1 highlander-comment" id="comment-13986">
		<div id="div-comment-13986">
		<div class="cmtinfo"><em> on <a href="#comment-13986" title="">2014-01-01 at 5:55 am</a></em> <img alt='' src='https://1.gravatar.com/avatar/18c4b79a7fd7e606866246ff5991c7eb?s=48&#038;d=identicon&#038;r=G' class='avatar avatar-48' height='48' width='48' /> <cite>mjklaim</cite></div>
						<div class="pd-rating" id="pd_rating_holder_468178_comm_13986"></div><p>1. Inheritance.<br />
2. X::impl could inherit from B, in the cpp file, which would allow us to move  #include &#8220;b.h&#8221;  in the cpp file.<br />
This is because B is not part of the public interface, so it&#8217;s an implementation detail, AND it don&#8217;t have virtual functions, which is a kind of externally available interface.<br />
For the same reasons, we can&#8217;t remove A from the interface so it&#8217;s include needs to stay here.</p>
			<br style="clear: both" />
		</div>
</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1 highlander-comment" id="comment-13985">
		<div id="div-comment-13985">
		<div class="cmtinfo"><em> on <a href="#comment-13985" title="">2014-01-01 at 5:45 am</a></em> <img alt='' src='https://0.gravatar.com/avatar/08cce2dcfc82546224d1eb61e68dec05?s=48&#038;d=identicon&#038;r=G' class='avatar avatar-48' height='48' width='48' /> <cite>Matthieu M.</cite></div>
						<div class="pd-rating" id="pd_rating_holder_468178_comm_13985"></div><p>JG: Friendship is the tightest coupling, followed by inheritance; thus the guideline, prefer composition over inheritance.</p>
<p>Guru: Given the big clue (read the comments) and the previous appetizer, it seems obvious that X need not inherit from B. Since we are already using PIMPL, all uses of B should thus move to the source file and therefore the include of B can be removed. B will still need to be forward declared since it is mentioned in the interface.</p>
<p>Question: I see here the use of unique_ptr, which requires a separate allocation. I have wondered a couple times how to get rid of this separate allocation (it slows down the construction and hurts cache friendliness) and I could only come up with the use of aligned_storage for a raw block of memory (of predetermined size) in X. However the need to suitably size this block implies the issue of ABI breakage if the size need ever change, so this is less stable ABI wise (but still insulates the client from most headers). Any thoughts ?</p>
			<br style="clear: both" />
		</div>
</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1 highlander-comment" id="comment-13983">
		<div id="div-comment-13983">
		<div class="cmtinfo"><em> on <a href="#comment-13983" title="">2013-12-31 at 10:00 pm</a></em> <img alt='' src='https://i2.wp.com/graph.facebook.com/15206932/picture?q=type%3Dlarge%26_md5%3D95a5accae339995d5373069e42199e7d&#038;resize=48%2C48' class='avatar avatar-48' height='48' width='48' /> <cite><a href='https://www.facebook.com/fmatthew5876' rel='external nofollow' class='url'>Matt Fioravante</a></cite></div>
						<div class="pd-rating" id="pd_rating_holder_468178_comm_13983"></div><p>Hi Herb, this is a great topic. I&#8217;ve submitted a proposal to further reduce compile times and increase encapsulation by allowing the programmer to define additional non-virtual private methods outside of class scope. It&#8217;s an artificial limit that just makes class design less flexible and requires unnecessary recompilation. </p>
<p><a href="https://github.com/fmatthew5876/stdcxx-privext" rel="nofollow">https://github.com/fmatthew5876/stdcxx-privext</a></p>
<p>Do you have any opinion about this idea?</p>
			<br style="clear: both" />
		</div>
</li><!-- #comment-## -->
		<li class="comment byuser comment-author-germinolegrand odd alt thread-odd thread-alt depth-1 highlander-comment" id="comment-13981">
		<div id="div-comment-13981">
		<div class="cmtinfo"><em> on <a href="#comment-13981" title="">2013-12-31 at 7:23 pm</a></em> <img alt='' src='https://2.gravatar.com/avatar/28fb981f4140586663137d6225e6862f?s=48&#038;d=identicon&#038;r=G' class='avatar avatar-48' height='48' width='48' /> <cite><a href='http://cpponfire.wordpress.com' rel='external nofollow' class='url'>germinolegrand</a></cite></div>
						<div class="pd-rating" id="pd_rating_holder_468178_comm_13981"></div><p>1) Inheritance is the tightest coupling you can ever find in C++ (inheritance with virtual overriding really is the most complicated dependency to hide).<br />
The sencond-tightest is membership. But you already talked about it in part #7b, we can get rid of it with pimpl idiom if it&#8217;s private.</p>
<p>These are the ones that determine the size of the class, which is what the compiler always need. Interestingly, these also are the ones that can&#8217;t be recursive, thus it makes it a solvable problem (no cyclic inclusion) without any indirection.</p>
<p>2) The private inheritance to class B, that has no virtual functions, can be transformed into a private member. It has no consequence on the size, unless sizeof B is zero (as a member it is required to be at least 1 if i make no mistake). Anyway, if it is private member, it can become a member of the pimpl and simply disappear from class X.</p>
<p>Another way of having class B disappear from class X, but keeping inheriting from class B (perhaps to access some protected things, or to keep its zero size), is to simply make struct impl publicly inherit from class B (so that it can be accessed from class X, but needing some proxy functions in struct impl to access the protected part of class B).</p>
<p>Once any of those two solutions are applied, the #include &#8220;B.h&#8221; can be removed from x.h and added in x.cpp.</p>
<p>It&#8217;s worth mentionning that the order in which class X inherits from class A then from class B permits to preserve construction order while sending class B to the pimpl. If class B really needed to be constructed before (or deleted after) class A, this wouldn&#8217;t be possible. It&#8217;s so easy to mess up the construction/destruction order by playing with dependancies.</p>
<p>The code for x.h now looks like this (a forward-declaration to class B is needed for the f function):</p>
<pre class="brush: plain; title: ; notranslate" title="">
//  x.h: after converting to use a Pimpl to hide implementation details
//
#include &lt;iosfwd&gt;
#include &lt;memory&gt;
#include &quot;a.h&quot;  // class A (has virtual functions)
class B;
class C;
class E;

class X : public A {
public:
       X( const C&amp; );
    B  f( int, char* );
    C  f( int, C );
    C&amp; g( B );
    E  h( E );
    virtual std::ostream&amp; print( std::ostream&amp; ) const;

private:
    struct impl;
    std::unique_ptr&lt;impl&gt; pimpl;   // ptr to a forward-declared class
};

std::ostream&amp; operator&lt;&lt;( std::ostream&amp; os, const X&amp; x ) {
    return x.print(os);
}
</pre>
<p>and the x.cpp like that :</p>
<pre class="brush: plain; title: ; notranslate" title="">
//  Implementation file x.cpp
//
#include &lt;list&gt;
#include &quot;b.h&quot;  // class B (has no virtual functions)
#include &quot;c.h&quot;  // class C
#include &quot;d.h&quot;  // class D
using namespace std;

struct X::impl: public B {
    std::list&lt;C&gt; clist;
    D            d;
};

X::X() : pimpl{ make_unique&lt;X::impl&gt;(/*...*/) } { }
X::~X() =default;
</pre>
<p>The last trick is not needed in the GotW question, but might be interesting. What if class B had virtual functions overrided in class X ? The solution may have an extra cost, with crossed dependancies between class X and struct impl.</p>
<p>First, the inheritance is changed, same as before, instead of class X, struct impl will inherit from class B. The overriding functions will be located in struct impl.</p>
<p>Then, everything depends on what is in the overriding functions. If the scope of struct impl is enough to implement them (for example it only needs to play with the members of the pimpl idiom), all is fine, nothing to do, no extra cost.</p>
<p>On the contrary, if it needs some access to class A or class X (eg. call a function in the (virtual) interface, or access to a member not in struct impl), there will come the necessary dependancy to class X. An extra member of impl will have to be added : a reference to an X (the X constructor will pass *this to the impl constructor). If needed, class X will be added a friend class impl; declaration so that class impl can access private things of class X it needs.</p>
<p>One of the drawbacks (not often a problem) is that a reference to a B can no longer be dynamicly casted into a reference to an A or an X.</p>
<p>I wish you all a happy new year =).</p>
			<br style="clear: both" />
		</div>
</li><!-- #comment-## -->
	</ol>

	<div class="navigation">
		<div class="alignleft"></div>
		<div class="alignright"></div>
	</div>
	<br />

  	<p class="nocomments">Comments are closed.</p>
  <div class="post-content">
<p>
</p>
</div>

			</div>

		
		<p align="center"></p>

	</div><!-- end id:content-main -->
<div id="sidebar">
<ul>
<li class="sidebox"><h2><label for="subscribe-field">Follow by email</label></h2>
				<form action="https://subscribe.wordpress.com" method="post" accept-charset="utf-8" id="subscribe-blog">
																	<p><input type="text" name="email" style="width: 95%; padding: 1px 2px" placeholder="Enter your email address" value="" id="subscribe-field"/></p>
					
					<p>
						<input type="hidden" name="action" value="subscribe"/>
						<input type="hidden" name="blog_id" value="3379246"/>
						<input type="hidden" name="source" value="https://herbsutter.com/2013/12/31/gotw-7c-minimizing-compile-time-dependencies-part-3/"/>
						<input type="hidden" name="sub-type" value="widget"/>
						<input type="hidden" name="redirect_fragment" value="blog_subscription-3" />
						<input type="hidden" id="_wpnonce" name="_wpnonce" value="4590924cc6" />						<input type="submit" value="Subscribe" />
					</p>
				</form>
			
</li><li class="sidebox"><h2><a href='http://twitter.com/herbsutter'>Tweets</a></h2><ul class='tweets'></ul><a href="http://twitter.com/herbsutter"  class='twitter-follow-button' data-show-count='false' data-link-color='#265e15' data-text-color='#333333'>Follow @herbsutter</a></li><li class="sidebox"><h2>Popular</h2><ul>				<li>
										<a href="https://herbsutter.com/2018/11/13/trip-report-fall-iso-c-standards-meeting-san-diego/" class="bump-view" data-bump-view="tp">
						Trip report: Fall ISO C++ standards meeting (San Diego)					</a>
										</li>
								<li>
										<a href="https://herbsutter.com/gotw/" class="bump-view" data-bump-view="tp">
						GotW					</a>
										</li>
								<li>
										<a href="https://herbsutter.com/2018/09/20/lifetime-profile-v1-0-posted/" class="bump-view" data-bump-view="tp">
						Lifetime profile v1.0 posted					</a>
										</li>
				</ul></li><li class="sidebox"><h2>Categories</h2>		<ul>
				<li class="cat-item cat-item-291"><a href="https://herbsutter.com/category/apple/" >Apple</a>
</li>
	<li class="cat-item cat-item-49277"><a href="https://herbsutter.com/category/c-net/" >C# / .NET</a>
</li>
	<li class="cat-item cat-item-2426"><a href="https://herbsutter.com/category/c/" >C++</a>
</li>
	<li class="cat-item cat-item-69816"><a href="https://herbsutter.com/category/cloud/" >Cloud</a>
</li>
	<li class="cat-item cat-item-214618"><a href="https://herbsutter.com/category/concurrency/" >Concurrency</a>
</li>
	<li class="cat-item cat-item-8259773"><a href="https://herbsutter.com/category/effective-concurrency/" >Effective Concurrency</a>
</li>
	<li class="cat-item cat-item-3696745"><a href="https://herbsutter.com/category/friday-thoughts/" >Friday Thoughts</a>
</li>
	<li class="cat-item cat-item-3867746"><a href="https://herbsutter.com/category/c/gotw/" >GotW</a>
</li>
	<li class="cat-item cat-item-79"><a href="https://herbsutter.com/category/hardware/" >Hardware</a>
</li>
	<li class="cat-item cat-item-1017"><a href="https://herbsutter.com/category/java/" >Java</a>
</li>
	<li class="cat-item cat-item-637"><a href="https://herbsutter.com/category/microsoft/" >Microsoft</a>
</li>
	<li class="cat-item cat-item-420845"><a href="https://herbsutter.com/category/opinion-editorial/" >Opinion &amp; Editorial</a>
</li>
	<li class="cat-item cat-item-1633077"><a href="https://herbsutter.com/category/reader-qa/" >Reader Q&amp;A</a>
</li>
	<li class="cat-item cat-item-2301"><a href="https://herbsutter.com/category/software-development/" >Software Development</a>
</li>
	<li class="cat-item cat-item-393523"><a href="https://herbsutter.com/category/talks-events/" >Talks &amp; Events</a>
</li>
	<li class="cat-item cat-item-1"><a href="https://herbsutter.com/category/uncategorized/" >Uncategorized</a>
</li>
	<li class="cat-item cat-item-151"><a href="https://herbsutter.com/category/web/" >Web</a>
</li>
		</ul>
			</li></ul>
</div><!-- end id:sidebar -->
</div><!-- end id:content -->
</div><!-- end id:container -->
<div id="footer">
	<div id="colophon">
		<p><a href="https://wordpress.com/?ref=footer_blog">Blog at WordPress.com.</a></p>
		<p>WPThemes.</p>
		<br class="clear" />
	</div><!-- end #colophon-->
</div><!-- end #footer-->
<!--  -->
<script type='text/javascript' src='//0.gravatar.com/js/gprofiles.js?ver=201847y'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var WPGroHo = {"my_hash":""};
/* ]]> */
</script>
<script type='text/javascript' src='https://s1.wp.com/wp-content/mu-plugins/gravatar-hovercards/wpgroho.js?m=1380573781h'></script>

	<script>
		//initialize and attach hovercards to all gravatars
		jQuery( document ).ready( function( $ ) {

			if (typeof Gravatar === "undefined"){
				return;
			}

			if ( typeof Gravatar.init !== "function" ) {
				return;
			}			

			Gravatar.profile_cb = function( hash, id ) {
				WPGroHo.syncProfileData( hash, id );
			};
			Gravatar.my_hash = WPGroHo.my_hash;
			Gravatar.init( 'body', '#wp-admin-bar-my-account' );
		});
	</script>

		<div style="display:none">
	<div class="grofile-hash-map-5fb79b33a16b20271f377e4847f0ae92">
	</div>
	<div class="grofile-hash-map-c962f8b7f16ad1aeec1fd7291eda9da3">
	</div>
	<div class="grofile-hash-map-160af1e5b18bff3acd0bf988e8bbfe2e">
	</div>
	<div class="grofile-hash-map-0f4e4820621a23b0fba545c636001db5">
	</div>
	<div class="grofile-hash-map-11e11da9e2269e401cceab5ca321dd7f">
	</div>
	<div class="grofile-hash-map-fa57d3850a3a7e25b4cbcfda4d620e4d">
	</div>
	<div class="grofile-hash-map-c0ba56bfd231f8f04feb057728975181">
	</div>
	<div class="grofile-hash-map-18c4b79a7fd7e606866246ff5991c7eb">
	</div>
	<div class="grofile-hash-map-08cce2dcfc82546224d1eb61e68dec05">
	</div>
	<div class="grofile-hash-map-72ff40f6f7ceeb6fa1adb984b1385c6c">
	</div>
	<div class="grofile-hash-map-28fb981f4140586663137d6225e6862f">
	</div>
	</div>
<script type='text/javascript' charset='UTF-8' id='polldaddyRatings'><!--//--><![CDATA[//><!--
PDRTJS_settings_468178_comm_14037={"id":468178,"unique_id":"wp-comment-14037","title":"%40Roman%20M%3ATiming%20can%20be%20enabled%20by%20setting%3ATools-%26gt%3BOptions-%26gt%3BProjects%20and%20Solutions-%26gt%3BVC%2B%2B%20Project%20Settings-%26gt%3BBuild%20Timing%28IIRC%20at%20least%20since%20VS%202010%2C%20but%20might%20be%20even%20earlier%29Output%20loo...","permalink":"https:\/\/herbsutter.com\/2013\/12\/31\/gotw-7c-minimizing-compile-time-dependencies-part-3\/#comment-14037","item_id":"_comm_14037"}; if ( typeof PDRTJS_RATING !== 'undefined' ){if ( typeof PDRTJS_468178_comm_14037 == 'undefined' ){PDRTJS_468178_comm_14037 = new PDRTJS_RATING( PDRTJS_settings_468178_comm_14037 );}}PDRTJS_settings_468178_comm_14036={"id":468178,"unique_id":"wp-comment-14036","title":"%40Loc%20Joly%3A%20I%20am%20aware%20of%20the%20tool%20you%26%23039%3Bve%20mentioned.%20Our%20codebase%20is%20Visual%20Studio%20C%2B%2B%20-%20only.%20Some%20time%20ago%20I%20tried%20it%20and%20couldn%26%23039%3Bt%20get%20it%20running%20because%20of%20Microsoft%26%23039%3Bs%20implementation%20of%20STL.%20Cu...","permalink":"https:\/\/herbsutter.com\/2013\/12\/31\/gotw-7c-minimizing-compile-time-dependencies-part-3\/#comment-14036","item_id":"_comm_14036"}; if ( typeof PDRTJS_RATING !== 'undefined' ){if ( typeof PDRTJS_468178_comm_14036 == 'undefined' ){PDRTJS_468178_comm_14036 = new PDRTJS_RATING( PDRTJS_settings_468178_comm_14036 );}}PDRTJS_settings_468178_comm_14035={"id":468178,"unique_id":"wp-comment-14035","title":"%40Roman%20%26quot%3B-%20we%20have%20absolutely%20_no_%20tool%20support%2C%20so%20a%20developer%20have%20to%20_guess_%20which%20header%20has%20greatest%20impact%20and%20is%20worth%20her%20time%3B%26quot%3BThere%20is%20a%20tool%20whose%20puspose%20is%20to%20automate%20someway%20header%20...","permalink":"https:\/\/herbsutter.com\/2013\/12\/31\/gotw-7c-minimizing-compile-time-dependencies-part-3\/#comment-14035","item_id":"_comm_14035"}; if ( typeof PDRTJS_RATING !== 'undefined' ){if ( typeof PDRTJS_468178_comm_14035 == 'undefined' ){PDRTJS_468178_comm_14035 = new PDRTJS_RATING( PDRTJS_settings_468178_comm_14035 );}}PDRTJS_settings_468178_comm_14026={"id":468178,"unique_id":"wp-comment-14026","title":"%40Jussi%3A%20nice%20script%20you%20have%20there%21%20I%20am%20not%20aware%20of%20something%20similar%20Visual%20C%2B%2B.%20Unfortunately%20your%20blog-post%20didn%26%23039%3Bt%20reveal%20whether%20good%20compilation%20throughput%20is%20due%20to%20PIMPL%20or%20just%20because%20...","permalink":"https:\/\/herbsutter.com\/2013\/12\/31\/gotw-7c-minimizing-compile-time-dependencies-part-3\/#comment-14026","item_id":"_comm_14026"}; if ( typeof PDRTJS_RATING !== 'undefined' ){if ( typeof PDRTJS_468178_comm_14026 == 'undefined' ){PDRTJS_468178_comm_14026 = new PDRTJS_RATING( PDRTJS_settings_468178_comm_14026 );}}PDRTJS_settings_468178_comm_14022={"id":468178,"unique_id":"wp-comment-14022","title":"%40roman%2C%20the%20difference%20in%20compile%20speeds%20between%20pimpl%26%23039%3Bd%20and%20non-pimpl%26%23039%3Bd%20code%20bases%20can%20be%20huge.%20Not%2010%25.%20Not%20even%2050%25.%20The%20difference%20can%20be%20an%20order%20of%20magnitude.%20I%20made%20a%20measurement%20of%20differ...","permalink":"https:\/\/herbsutter.com\/2013\/12\/31\/gotw-7c-minimizing-compile-time-dependencies-part-3\/#comment-14022","item_id":"_comm_14022"}; if ( typeof PDRTJS_RATING !== 'undefined' ){if ( typeof PDRTJS_468178_comm_14022 == 'undefined' ){PDRTJS_468178_comm_14022 = new PDRTJS_RATING( PDRTJS_settings_468178_comm_14022 );}}PDRTJS_settings_468178_comm_14007={"id":468178,"unique_id":"wp-comment-14007","title":"Hello%20Herb%2C%20in%20my%20experience%2C%20using%20your%20advice%20at%20the%20current%20language%20state%20in%20large%20projects%20is%20unfortunately%20utopical%20and%20rarely%20pays%20off%3A-%20dependency%20rules%20are%20often%20not%20obvious%2C%20so%20a%20conser...","permalink":"https:\/\/herbsutter.com\/2013\/12\/31\/gotw-7c-minimizing-compile-time-dependencies-part-3\/#comment-14007","item_id":"_comm_14007"}; if ( typeof PDRTJS_RATING !== 'undefined' ){if ( typeof PDRTJS_468178_comm_14007 == 'undefined' ){PDRTJS_468178_comm_14007 = new PDRTJS_RATING( PDRTJS_settings_468178_comm_14007 );}}PDRTJS_settings_468178_comm_14005={"id":468178,"unique_id":"wp-comment-14005","title":"%40Herb.%20This%20is%20not%20a%20response%20to%20your%20questions%2C%20but%20is%20pertinent%20to%20the%20topic.I%26%23039%3Bve%20been%20following%20this%20series%20with%20interest%20to%20see%20if%20I%20can%20pick%20up%20any%20more%20tips%20in%20my%20war%20against%20build-time%20sap...","permalink":"https:\/\/herbsutter.com\/2013\/12\/31\/gotw-7c-minimizing-compile-time-dependencies-part-3\/#comment-14005","item_id":"_comm_14005"}; if ( typeof PDRTJS_RATING !== 'undefined' ){if ( typeof PDRTJS_468178_comm_14005 == 'undefined' ){PDRTJS_468178_comm_14005 = new PDRTJS_RATING( PDRTJS_settings_468178_comm_14005 );}}PDRTJS_settings_468178_comm_14004={"id":468178,"unique_id":"wp-comment-14004","title":"%40Matthieu%20%28%26amp%3B%20%40herb%29%20the%20fixed%20sized%20block%20of%20storage%20with%20placement%20new%20%28and%20explicit%20destructor%29%20is%20the%20usual%20solution.%20As%20Herb%20says%20adding%20a%20bit%20of%20extra%20headroom%20is%20usually%20a%20good%20idea.Ano...","permalink":"https:\/\/herbsutter.com\/2013\/12\/31\/gotw-7c-minimizing-compile-time-dependencies-part-3\/#comment-14004","item_id":"_comm_14004"}; if ( typeof PDRTJS_RATING !== 'undefined' ){if ( typeof PDRTJS_468178_comm_14004 == 'undefined' ){PDRTJS_468178_comm_14004 = new PDRTJS_RATING( PDRTJS_settings_468178_comm_14004 );}}PDRTJS_settings_468178_comm_13989={"id":468178,"unique_id":"wp-comment-13989","title":"1%29%20I%20think%20tightest%20coupling%20in%20cpp%20is%20friendship%28it%20gives%20private%20members%20access%20to%20non%20related%20class%2Fmethods%29.%20Inheritance%20is%20second.2%29%20Relationship%20with%20B%20can%20be%20moved%20to%20impl%2C%20since%20B%20has%20no%20...","permalink":"https:\/\/herbsutter.com\/2013\/12\/31\/gotw-7c-minimizing-compile-time-dependencies-part-3\/#comment-13989","item_id":"_comm_13989"}; if ( typeof PDRTJS_RATING !== 'undefined' ){if ( typeof PDRTJS_468178_comm_13989 == 'undefined' ){PDRTJS_468178_comm_13989 = new PDRTJS_RATING( PDRTJS_settings_468178_comm_13989 );}}PDRTJS_settings_468178_comm_13988={"id":468178,"unique_id":"wp-comment-13988","title":"%40Matthieu%3A%20Yes%2C%20that%26%23039%3Bs%20basically%20what%20you%26%23039%3Bd%20need%20to%20do%20to%20avoid%20the%20allocation%20overhead%20in%20Pimpl%20--%20have%20a%20block%20of%20storage%20in%20the%20class%20of%20sufficient%20size%2C%20perhaps%20with%20extra%20space%20so%20that%20you%20c...","permalink":"https:\/\/herbsutter.com\/2013\/12\/31\/gotw-7c-minimizing-compile-time-dependencies-part-3\/#comment-13988","item_id":"_comm_13988"}; if ( typeof PDRTJS_RATING !== 'undefined' ){if ( typeof PDRTJS_468178_comm_13988 == 'undefined' ){PDRTJS_468178_comm_13988 = new PDRTJS_RATING( PDRTJS_settings_468178_comm_13988 );}}PDRTJS_settings_468178_comm_13986={"id":468178,"unique_id":"wp-comment-13986","title":"1.%20Inheritance.2.%20X%3A%3Aimpl%20could%20inherit%20from%20B%2C%20in%20the%20cpp%20file%2C%20which%20would%20allow%20us%20to%20move%20%20%23include%20%26quot%3Bb.h%26quot%3B%20%20in%20the%20cpp%20file.This%20is%20because%20B%20is%20not%20part%20of%20the%20public%20interface%2C%20so%20it%26%23039%3Bs%20an%20im...","permalink":"https:\/\/herbsutter.com\/2013\/12\/31\/gotw-7c-minimizing-compile-time-dependencies-part-3\/#comment-13986","item_id":"_comm_13986"}; if ( typeof PDRTJS_RATING !== 'undefined' ){if ( typeof PDRTJS_468178_comm_13986 == 'undefined' ){PDRTJS_468178_comm_13986 = new PDRTJS_RATING( PDRTJS_settings_468178_comm_13986 );}}PDRTJS_settings_468178_comm_13985={"id":468178,"unique_id":"wp-comment-13985","title":"JG%3A%20Friendship%20is%20the%20tightest%20coupling%2C%20followed%20by%20inheritance%3B%20thus%20the%20guideline%2C%20prefer%20composition%20over%20inheritance.Guru%3A%20Given%20the%20big%20clue%20%28read%20the%20comments%29%20and%20the%20previous%20appetizer%2C%20...","permalink":"https:\/\/herbsutter.com\/2013\/12\/31\/gotw-7c-minimizing-compile-time-dependencies-part-3\/#comment-13985","item_id":"_comm_13985"}; if ( typeof PDRTJS_RATING !== 'undefined' ){if ( typeof PDRTJS_468178_comm_13985 == 'undefined' ){PDRTJS_468178_comm_13985 = new PDRTJS_RATING( PDRTJS_settings_468178_comm_13985 );}}PDRTJS_settings_468178_comm_13983={"id":468178,"unique_id":"wp-comment-13983","title":"Hi%20Herb%2C%20this%20is%20a%20great%20topic.%20I%26%23039%3Bve%20submitted%20a%20proposal%20to%20further%20reduce%20compile%20times%20and%20increase%20encapsulation%20by%20allowing%20the%20programmer%20to%20define%20additional%20non-virtual%20private%20methods%20ou...","permalink":"https:\/\/herbsutter.com\/2013\/12\/31\/gotw-7c-minimizing-compile-time-dependencies-part-3\/#comment-13983","item_id":"_comm_13983"}; if ( typeof PDRTJS_RATING !== 'undefined' ){if ( typeof PDRTJS_468178_comm_13983 == 'undefined' ){PDRTJS_468178_comm_13983 = new PDRTJS_RATING( PDRTJS_settings_468178_comm_13983 );}}PDRTJS_settings_468178_comm_13981={"id":468178,"unique_id":"wp-comment-13981","title":"1%29%20Inheritance%20is%20the%20tightest%20coupling%20you%20can%20ever%20find%20in%20C%2B%2B%20%28inheritance%20with%20virtual%20overriding%20really%20is%20the%20most%20complicated%20dependency%20to%20hide%29.The%20sencond-tightest%20is%20membership.%20But%20yo...","permalink":"https:\/\/herbsutter.com\/2013\/12\/31\/gotw-7c-minimizing-compile-time-dependencies-part-3\/#comment-13981","item_id":"_comm_13981"}; if ( typeof PDRTJS_RATING !== 'undefined' ){if ( typeof PDRTJS_468178_comm_13981 == 'undefined' ){PDRTJS_468178_comm_13981 = new PDRTJS_RATING( PDRTJS_settings_468178_comm_13981 );}}
//--><!]]></script><script type='text/javascript' charset='UTF-8' src='https://polldaddy.com/js/rating/rating.js'></script><script type='text/javascript' src='https://platform.twitter.com/widgets.js?ver=20111117'></script>
<script type='text/javascript' src='https://s1.wp.com/_static/??-eJzTLy/QTc7PK0nNK9EvyClNz8wr1i+uzCtJrMjITM/IAeKS1CJMEWP94uSizIISoOIM5/yiVL2sYh19yo1yKiotzgjISczMAxpon2traGJkZGxiZGhskgUAFHlAaw=='></script>
<script type='text/javascript'>
	(function(){
		var corecss = document.createElement('link');
		var themecss = document.createElement('link');
		var corecssurl = "https://s1.wp.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shCore.css?ver=3.0.9b";
		if ( corecss.setAttribute ) {
				corecss.setAttribute( "rel", "stylesheet" );
				corecss.setAttribute( "type", "text/css" );
				corecss.setAttribute( "href", corecssurl );
		} else {
				corecss.rel = "stylesheet";
				corecss.href = corecssurl;
		}
		document.getElementsByTagName("head")[0].insertBefore( corecss, document.getElementById("syntaxhighlighteranchor") );
		var themecssurl = "https://s2.wp.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shThemeDefault.css?m=1363304414h&amp;ver=3.0.9b";
		if ( themecss.setAttribute ) {
				themecss.setAttribute( "rel", "stylesheet" );
				themecss.setAttribute( "type", "text/css" );
				themecss.setAttribute( "href", themecssurl );
		} else {
				themecss.rel = "stylesheet";
				themecss.href = themecssurl;
		}
		//document.getElementById("syntaxhighlighteranchor").appendChild(themecss);
		document.getElementsByTagName("head")[0].insertBefore( themecss, document.getElementById("syntaxhighlighteranchor") );
	})();
	SyntaxHighlighter.config.strings.expandSource = '+ expand source';
	SyntaxHighlighter.config.strings.help = '?';
	SyntaxHighlighter.config.strings.alert = 'SyntaxHighlighter\n\n';
	SyntaxHighlighter.config.strings.noBrush = 'Can\'t find brush for: ';
	SyntaxHighlighter.config.strings.brushNotHtmlScript = 'Brush wasn\'t configured for html-script option: ';
	SyntaxHighlighter.defaults['pad-line-numbers'] = false;
	SyntaxHighlighter.defaults['toolbar'] = false;
	SyntaxHighlighter.all();

	// Infinite scroll support
	if ( typeof( jQuery ) !== 'undefined' ) {
		jQuery( function( $ ) {
			$( document.body ).on( 'post-load', function() {
				SyntaxHighlighter.highlight();
			} );
		} );
	}
</script>
<script type='text/javascript'>
/* <![CDATA[ */
var actionbardata = {"siteID":"3379246","siteName":"Sutter\u2019s Mill","siteURL":"https:\/\/herbsutter.com","icon":"<img alt='' src='https:\/\/secure.gravatar.com\/blavatar\/4554b8d24c7f200dc5e2e1b18db1893f?s=50&d=https%3A%2F%2Fs2.wp.com%2Fi%2Flogo%2Fwpcom-gray-white.png' class='avatar avatar-50' height='50' width='50' \/>","canManageOptions":"","canCustomizeSite":"","isFollowing":"","themeSlug":"pub\/mistylook","signupURL":"https:\/\/wordpress.com\/start\/","loginURL":"https:\/\/herbsutter.wordpress.com\/wp-login.php?redirect_to=https%3A%2F%2Fherbsutter.com%2F2013%2F12%2F31%2Fgotw-7c-minimizing-compile-time-dependencies-part-3%2F","themeURL":"","xhrURL":"https:\/\/herbsutter.com\/wp-admin\/admin-ajax.php","nonce":"8fb9818ae2","isSingular":"1","isFolded":"","isLoggedIn":"","isMobile":"","subscribeNonce":"<input type=\"hidden\" id=\"_wpnonce\" name=\"_wpnonce\" value=\"4590924cc6\" \/>","referer":"https:\/\/herbsutter.com\/2013\/12\/31\/gotw-7c-minimizing-compile-time-dependencies-part-3\/","canFollow":"1","feedID":"171936","statusMessage":"","customizeLink":"https:\/\/herbsutter.wordpress.com\/wp-admin\/customize.php?url=https%3A%2F%2Fherbsutter.wordpress.com%2F2013%2F12%2F31%2Fgotw-7c-minimizing-compile-time-dependencies-part-3%2F","postID":"2387","shortlink":"https:\/\/wp.me\/peb5Y-Cv","canEditPost":"","editLink":"https:\/\/wordpress.com\/post\/herbsutter.com\/2387","statsLink":"https:\/\/wordpress.com\/stats\/post\/2387\/herbsutter.com","i18n":{"view":"View site","follow":"Follow","following":"Following","edit":"Edit","login":"Log in","signup":"Sign up","customize":"Customize","report":"Report this content","themeInfo":"Get theme: MistyLook","shortlink":"Copy shortlink","copied":"Copied","followedText":"New posts from this site will now appear in your <a href=\"https:\/\/wordpress.com\/\">Reader<\/a>","foldBar":"Collapse this bar","unfoldBar":"Expand this bar","editSubs":"Manage subscriptions","viewReader":"View site in Reader","viewReadPost":"View post in Reader","subscribe":"Sign me up","enterEmail":"Enter your email address","followers":"Join 19,532 other followers","alreadyUser":"Already have a WordPress.com account? <a href=\"https:\/\/herbsutter.wordpress.com\/wp-login.php?redirect_to=https%3A%2F%2Fherbsutter.com%2F2013%2F12%2F31%2Fgotw-7c-minimizing-compile-time-dependencies-part-3%2F\">Log in now.<\/a>","stats":"Stats"}};
/* ]]> */
</script>
<script type='text/javascript' src='https://s0.wp.com/_static/??-eJyVjcEOgjAQRH/IuoIYT8Zvqe2GLrQLdlvAv7ceJEYTEg+bTGbe7MA8KjNwQk7QCVicyOC47DvZwUcUshp9bokFPPUocM+Y0Wm2HuM3/CblwUkvjlrnyyWMv87GjraBWN10hKCloEWpYcIYyZb91fvzQ4ra9LJVMokGfpVWVehruFSnujo0x+Zcd0+y+3Rn'></script>
<script type="text/javascript">
// <![CDATA[
(function() {
try{
  if ( window.external &&'msIsSiteMode' in window.external) {
    if (window.external.msIsSiteMode()) {
      var jl = document.createElement('script');
      jl.type='text/javascript';
      jl.async=true;
      jl.src='/wp-content/plugins/ie-sitemode/custom-jumplist.php';
      var s = document.getElementsByTagName('script')[0];
      s.parentNode.insertBefore(jl, s);
    }
  }
}catch(e){}
})();
// ]]>
</script><script src="//stats.wp.com/w.js?56" type="text/javascript" async defer></script>
<script type="text/javascript">
_tkq = window._tkq || [];
_stq = window._stq || [];
_tkq.push(['storeContext', {'blog_id':'3379246','blog_tz':'-8','user_lang':'en','blog_lang':'en','user_id':'0'}]);
_stq.push(['view', {'blog':'3379246','v':'wpcom','tz':'-8','user_id':'0','post':'2387','subd':'herbsutter'}]);
_stq.push(['extra', {'crypt':'UE40eW5QN0p8M2Y/RE1TaVhzUzFMbjdWNHpwZGhTayxPSUFCMGNrd29+Smw0TDhnZmRTK0hlRi9QSGh6bi9GXVhBJWIlZlR5U1JMLU8/MkNtblkvY1d1TjBELytHc0k/MXdHUVQyK2IyUVA5SjU1bj9VX3ExLHYsREFpcnlfNHYtXV1HSUIsLkJrcnp0eS5sLjdwVm1NMWklPS9ULkEwekMwRTFUNm8vbSs1Yz1iMyZ4dnxMYi4uRFF2amVVZT9wK2FsLTFdeHI2LFpMM1FlWy9fVSx8cGVNd3ZQVD09PWJXTlUlZTElRzJRZXFiQ0ZbdVhCNW5YN3JzSltfakVdblVWOEhrUnZUaWp8Qk56MGxWcz91aEFddkhJUGFKfkVqYWVHL2ZVQ25FfnUyK1lGQ2JNUHZCMjBmSkZyNz9IVmppenJZaWdpN2I/Ryt0ciVSZzB4Vy8wUA=='}]);
_stq.push([ 'clickTrackerInit', '3379246', '2387' ]);
	</script>
<noscript><img src="https://pixel.wp.com/b.gif?v=noscript" style="height:0px;width:0px;overflow:hidden" alt="" /></noscript>
<script>
if ( 'object' === typeof wpcom_mobile_user_agent_info ) {

	wpcom_mobile_user_agent_info.init();
	var mobileStatsQueryString = "";
	
	if( false !== wpcom_mobile_user_agent_info.matchedPlatformName )
		mobileStatsQueryString += "&x_" + 'mobile_platforms' + '=' + wpcom_mobile_user_agent_info.matchedPlatformName;
	
	if( false !== wpcom_mobile_user_agent_info.matchedUserAgentName )
		mobileStatsQueryString += "&x_" + 'mobile_devices' + '=' + wpcom_mobile_user_agent_info.matchedUserAgentName;
	
	if( wpcom_mobile_user_agent_info.isIPad() )
		mobileStatsQueryString += "&x_" + 'ipad_views' + '=' + 'views';

	if( "" != mobileStatsQueryString ) {
		new Image().src = document.location.protocol + '//pixel.wp.com/g.gif?v=wpcom-no-pv' + mobileStatsQueryString + '&baba=' + Math.random();
	}
	
}
</script></body>
</html>