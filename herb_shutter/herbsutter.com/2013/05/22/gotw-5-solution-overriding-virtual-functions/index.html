<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
<head profile="http://gmpg.org/xfn/11">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>GotW #5 Solution: Overriding Virtual Functions | Sutter’s Mill</title>
<link rel="pingback" href="https://herbsutter.com/xmlrpc.php" />
<script type="text/javascript">
  WebFontConfig = {"typekit":{"id":"eyo0tqd"}};
  (function() {
    var wf = document.createElement('script');
    wf.src = 'https://s0.wp.com/wp-content/plugins/custom-fonts/js/webfont.js';
    wf.type = 'text/javascript';
    wf.async = 'true';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(wf, s);
	})();
</script><style id="jetpack-custom-fonts-css">.wf-active #header h1{font-size:2.12em;font-family:"ff-dagny-web-pro-1","ff-dagny-web-pro-2",sans-serif;font-style:normal;font-weight:400}.wf-active body{font-size:89.7%;font-family:"ff-basic-gothic-web-pro-1","ff-basic-gothic-web-pro-2",sans-serif}.wf-active #navigation{font-family:"ff-basic-gothic-web-pro-1","ff-basic-gothic-web-pro-2",sans-serif}.wf-active #navigation ul li.search{font-size:1.06em}.wf-active #navigation ul li.search input#searchsubmit{font-size:1.06em}.wf-active #content .post-info, .wf-active #content .postmetadata{font-size:1.06em}.wf-active #sidebar{font-size:1.06em}.wf-active #footer p.right{font-size:1.06em}.wf-active .commentnum{font-size:1.77em}.wf-active .commentlist li .cmtinfo{font-size:1.18em}.wf-active .commentlist li .cmtinfo em{font-size:1.06em}.wf-active #respond label{font-size:11.8px}.wf-active #respond .required{font-size:11.8px}.wf-active #respond .subscribe-label{font-size:14.2px}.wf-active #respond .comment-notes{font-size:13px}.wf-active .wp-caption p.wp-caption-text{font-size:13px}.wf-active #content h1, .wf-active h2, .wf-active h3, .wf-active h4, .wf-active h5, .wf-active h6{font-family:"ff-dagny-web-pro-1","ff-dagny-web-pro-2",sans-serif;font-style:normal;font-weight:400}.wf-active #header h2{font-size:1.18em;font-weight:400;font-family:"ff-dagny-web-pro-1","ff-dagny-web-pro-2",sans-serif;font-style:normal}.wf-active #content h3{font-size:1.65em;font-weight:400;font-style:normal}.wf-active #content h4{font-size:1.3em;font-style:normal;font-weight:400}.wf-active #content h5{font-size:1.18em;font-style:normal;font-weight:400}.wf-active #content .post h2{font-size:1.65em;font-weight:400;font-style:normal}.wf-active li.sidebox h2{font-weight:400;font-size:1.89em;font-style:normal}.wf-active .post h4{font-size:1.18em;font-weight:400;font-family:"ff-dagny-web-pro-1","ff-dagny-web-pro-2",sans-serif;font-style:normal}.wf-active .post h4 em{font-style:normal;font-weight:400}</style>
		<script src='https://r-login.wordpress.com/remote-login.php?action=js&amp;host=herbsutter.com&amp;id=3379246&amp;t=1542965313&amp;back=https%3A%2F%2Fherbsutter.com%2F2013%2F05%2F22%2Fgotw-5-solution-overriding-virtual-functions%2F' type="text/javascript"></script>
		<script type="text/javascript">
		/* <![CDATA[ */
			if ( 'function' === typeof WPRemoteLogin ) {
				document.cookie = "wordpress_test_cookie=test; path=/";
				if ( document.cookie.match( /(;|^)\s*wordpress_test_cookie\=/ ) ) {
					WPRemoteLogin();
				}
			}
		/* ]]> */
		</script>
		<link rel='dns-prefetch' href='//s2.wp.com' />
<link rel='dns-prefetch' href='//s0.wp.com' />
<link rel='dns-prefetch' href='//s1.wp.com' />
<link rel='dns-prefetch' href='//herbsutter.wordpress.com' />
<link rel="alternate" type="application/rss+xml" title="Sutter’s Mill &raquo; Feed" href="https://herbsutter.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Sutter’s Mill &raquo; Comments Feed" href="https://herbsutter.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Sutter’s Mill &raquo; GotW #5 Solution: Overriding Virtual&nbsp;Functions Comments Feed" href="https://herbsutter.com/2013/05/22/gotw-5-solution-overriding-virtual-functions/feed/" />
	<script type="text/javascript">
		/* <![CDATA[ */
		function addLoadEvent(func) {
			var oldonload = window.onload;
			if (typeof window.onload != 'function') {
				window.onload = func;
			} else {
				window.onload = function () {
					oldonload();
					func();
				}
			}
		}
		/* ]]> */
	</script>
			<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s0.wp.com\/wp-content\/mu-plugins\/wpcom-smileys\/twemoji\/2\/72x72\/","ext":".png","svgUrl":"https:\/\/s0.wp.com\/wp-content\/mu-plugins\/wpcom-smileys\/twemoji\/2\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/s1.wp.com\/wp-includes\/js\/wp-emoji-release.min.js?m=1532082729h&ver=4.9.8"}};
			!function(a,b,c){function d(a,b){var c=String.fromCharCode;l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,a),0,0);var d=k.toDataURL();l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,b),0,0);var e=k.toDataURL();return d===e}function e(a){var b;if(!l||!l.fillText)return!1;switch(l.textBaseline="top",l.font="600 32px Arial",a){case"flag":return!(b=d([55356,56826,55356,56819],[55356,56826,8203,55356,56819]))&&(b=d([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]),!b);case"emoji":return b=d([55358,56760,9792,65039],[55358,56760,8203,9792,65039]),!b}return!1}function f(a){var c=b.createElement("script");c.src=a,c.defer=c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var g,h,i,j,k=b.createElement("canvas"),l=k.getContext&&k.getContext("2d");for(j=Array("flag","emoji"),c.supports={everything:!0,everythingExceptFlag:!0},i=0;i<j.length;i++)c.supports[j[i]]=e(j[i]),c.supports.everything=c.supports.everything&&c.supports[j[i]],"flag"!==j[i]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[j[i]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(h=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",h,!1),a.addEventListener("load",h,!1)):(a.attachEvent("onload",h),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),g=c.source||{},g.concatemoji?f(g.concatemoji):g.wpemoji&&g.twemoji&&(f(g.twemoji),f(g.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
	<link rel='stylesheet' id='all-css-0-1' href='https://s2.wp.com/_static/??-eJyNkN1uwjAMhV9onsUG69W0Z0laE0zzp8QR6tvjUlUCwSpuonOS81knxkuGPkWhKBgaZN8cx4qeR6p4JsmmH+HmPvtaP/B1nOORI8uEcqKgYG4WA1eZfErjFtinQnofspE5EWhgQ15nRNnCQv5ZqVmetORmv0vWNFibC9UKegZuAZayT9wKuabWUnEwt0Tb2A9ofbotxBZTJpx/SE8DXi3hn+h9Rx4cSUVJGXKqqt5GaurZeGCNPJoFZoxJlsdVbE11lEB/aYRTfDBw9IbLFlpI9+NUOtTUnZ2hv/C7O+y/uu9uf+jOV8Xg7sY=?cssminify=yes' type='text/css' media='all' />
<link rel='stylesheet' id='print-css-1-1' href='https://s2.wp.com/wp-content/mu-plugins/global-print/global-print.css?m=1465851035h&cssminify=yes' type='text/css' media='print' />
<link rel='stylesheet' id='all-css-2-1' href='https://s0.wp.com/_static/??/wp-content/mu-plugins/actionbar/actionbar.css,/wp-content/themes/h4/global.css?m=1516985148j&cssminify=yes' type='text/css' media='all' />
<script type='text/javascript' src='https://s0.wp.com/_static/??-eJyFztEKwjAMBdAfsquTiXsRv6XWOFKXtDbphn69HeiDMBQCgdzDJXZOBtmP5QJiQ517gfx4rybIxv4ChnDITqEh5A/2kRVYF0vxjCOYIpDdUG+16BpXXIqiBCIVraTfLyFPCPNfFkCT8zeTQfC5tJ7o2Hb9Yde3+24bXjRNW9I='></script>
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://herbsutter.wordpress.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://s1.wp.com/wp-includes/wlwmanifest.xml" /> 
<link rel='prev' title='GotW #5: Overriding Virtual&nbsp;Functions' href='https://herbsutter.com/2013/05/20/gotw-5-overriding-virtual-functions/' />
<link rel='next' title='GotW #6a: Const-Correctness, Part&nbsp;1' href='https://herbsutter.com/2013/05/22/gotw-6a-const-correctness-part-1/' />
<meta name="generator" content="WordPress.com" />
<link rel="canonical" href="https://herbsutter.com/2013/05/22/gotw-5-solution-overriding-virtual-functions/" />
<link rel='shortlink' href='https://wp.me/peb5Y-w0' />
<link rel="alternate" type="application/json+oembed" href="https://public-api.wordpress.com/oembed/?format=json&amp;url=https%3A%2F%2Fherbsutter.com%2F2013%2F05%2F22%2Fgotw-5-solution-overriding-virtual-functions%2F&amp;for=wpcom-auto-discovery" /><link rel="alternate" type="application/xml+oembed" href="https://public-api.wordpress.com/oembed/?format=xml&amp;url=https%3A%2F%2Fherbsutter.com%2F2013%2F05%2F22%2Fgotw-5-solution-overriding-virtual-functions%2F&amp;for=wpcom-auto-discovery" />
<!-- Jetpack Open Graph Tags -->
<meta property="og:type" content="article" />
<meta property="og:title" content="GotW #5 Solution: Overriding Virtual Functions" />
<meta property="og:url" content="https://herbsutter.com/2013/05/22/gotw-5-solution-overriding-virtual-functions/" />
<meta property="og:description" content="Virtual functions are a pretty basic feature, but they occasionally harbor subtleties that trap the unwary. If you can answer questions like this one, then you know virtual functions cold, and you&amp;…" />
<meta property="article:published_time" content="2013-05-22T19:06:19+00:00" />
<meta property="article:modified_time" content="2013-05-23T14:26:31+00:00" />
<meta property="og:site_name" content="Sutter’s Mill" />
<meta property="og:image" content="https://secure.gravatar.com/blavatar/4554b8d24c7f200dc5e2e1b18db1893f?s=200&amp;ts=1542965313" />
<meta property="og:image:width" content="200" />
<meta property="og:image:height" content="200" />
<meta property="og:locale" content="en_US" />
<meta name="twitter:site" content="@wordpressdotcom" />
<meta name="twitter:text:title" content="GotW #5 Solution: Overriding Virtual&nbsp;Functions" />
<meta name="twitter:image" content="https://secure.gravatar.com/blavatar/4554b8d24c7f200dc5e2e1b18db1893f?s=240" />
<meta name="twitter:card" content="summary" />
<meta property="article:publisher" content="https://www.facebook.com/WordPresscom" />

<!-- End Jetpack Open Graph Tags -->
<link rel="shortcut icon" type="image/x-icon" href="https://secure.gravatar.com/blavatar/4554b8d24c7f200dc5e2e1b18db1893f?s=32" sizes="16x16" />
<link rel="icon" type="image/x-icon" href="https://secure.gravatar.com/blavatar/4554b8d24c7f200dc5e2e1b18db1893f?s=32" sizes="16x16" />
<link rel="apple-touch-icon-precomposed" href="https://secure.gravatar.com/blavatar/4554b8d24c7f200dc5e2e1b18db1893f?s=114" />
<link rel='openid.server' href='https://herbsutter.wordpress.com/?openidserver=1' />
<link rel='openid.delegate' href='https://herbsutter.wordpress.com/' />
<link rel="search" type="application/opensearchdescription+xml" href="https://herbsutter.com/osd.xml" title="Sutter’s Mill" />
<link rel="search" type="application/opensearchdescription+xml" href="https://s1.wp.com/opensearch.xml" title="WordPress.com" />
		<style id="wpcom-hotfix-masterbar-style">
			@media screen and (min-width: 783px) {
				#wpadminbar .quicklinks li#wp-admin-bar-my-account.with-avatar > a img {
					margin-top: 5px;
				}
			}
		</style>
		<script type="text/javascript" id="webfont-output">
  
  WebFontConfig = {"typekit":{"id":"cjs1oxc"}};
  (function() {
    var wf = document.createElement('script');
    wf.src = ('https:' == document.location.protocol ? 'https' : 'http') +
      '://ajax.googleapis.com/ajax/libs/webfont/1/webfont.js';
    wf.type = 'text/javascript';
    wf.async = 'true';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(wf, s);
	})();
</script><style type="text/css">
.widget_twitter li {
	word-wrap: break-word;
}
</style>
<meta name="application-name" content="Sutter’s Mill" /><meta name="msapplication-window" content="width=device-width;height=device-height" /><meta name="msapplication-tooltip" content="Herb Sutter on software development" /><meta name="msapplication-task" content="name=Subscribe;action-uri=https://herbsutter.com/feed/;icon-uri=https://secure.gravatar.com/blavatar/4554b8d24c7f200dc5e2e1b18db1893f?s=16" /><meta name="msapplication-task" content="name=Sign up for a free blog;action-uri=http://wordpress.com/signup/;icon-uri=https://s1.wp.com/i/favicon.ico" /><meta name="msapplication-task" content="name=WordPress.com Support;action-uri=http://support.wordpress.com/;icon-uri=https://s1.wp.com/i/favicon.ico" /><meta name="msapplication-task" content="name=WordPress.com Forums;action-uri=http://forums.wordpress.com/;icon-uri=https://s1.wp.com/i/favicon.ico" /><meta name="description" content="Virtual functions are a pretty basic feature, but they occasionally harbor subtleties that trap the unwary. If you can answer questions like this one, then you know virtual functions cold, and you&#039;re less likely to waste a lot of time debugging problems like the ones illustrated below. Problem JG Question 1. What do the override&hellip;" />
<style type="text/css">
			#header h1 a,
		#header h2 {
			color: #265E15 !important;
		}
				#headerimage {
			background: url('https://herbsutter.files.wordpress.com/2011/10/cropped-blog-header.jpg') no-repeat;
			height: 200px;
		}
	</style>
<link rel="amphtml" href="https://herbsutter.com/2013/05/22/gotw-5-solution-overriding-virtual-functions/amp/"><style type="text/css" id="syntaxhighlighteranchor"></style>
		<link rel="stylesheet" id="custom-css-css" type="text/css" href="https://s2.wp.com/?custom-css=1&#038;csblog=eb5Y&#038;cscache=6&#038;csrev=60" />
		</head>
<body id="section-index" class="post-template-default single single-post postid-1984 single-format-standard mp6 customizer-styles-applied highlander-enabled highlander-light">


<div id="navigation" class="clearfix">
		<div class="menu">
		<ul>
			<li ><a href="https://herbsutter.com/" title="Home">Home</a></li>
			<li class="page_item page-item-912"><a href="https://herbsutter.com/welcome-to-the-jungle/">Welcome to the&nbsp;Jungle</a></li>
<li class="page_item page-item-864 page_item_has_children"><a href="https://herbsutter.com/gotw/">GotW</a></li>
<li class="page_item page-item-761"><a href="https://herbsutter.com/elements-of-modern-c-style/">Elements of Modern C++&nbsp;Style</a></li>
<li class="page_item page-item-2 page_item_has_children"><a href="https://herbsutter.com/about/">About</a></li>
									<li class="search"><form method="get" id="searchform" action="https://herbsutter.com"><input type="text" class="textbox" value="" name="s" id="s" /><input type="submit" id="searchsubmit" value="Search" /></form></li>
					</ul>
	</div>
</div><!-- end id:navigation -->

<div id="container">

<div id="header">
<h1><a href="https://herbsutter.com/" title="Sutter’s Mill">Sutter’s Mill</a></h1>
<h2>Herb Sutter on software development</h2>
</div><!-- end id:header -->


	
		<div id="feedarea">
	<dl>
		<dt><strong>Feeds:</strong></dt>

			<dd><a href="https://herbsutter.com/feed/">Posts</a></dd>
	
			<dd><a href="https://herbsutter.com/comments/feed/">Comments</a></dd>
		</dl>
	</div><!-- end id:feedarea -->
	
	<div id="headerimage">
</div><!-- end id:headerimage -->

<div id="content">
<div id="content-main">

		
									<div class="postnav">
				<div class="alignleft">&laquo; <a href="https://herbsutter.com/2013/05/20/gotw-5-overriding-virtual-functions/" rel="prev">GotW #5: Overriding Virtual&nbsp;Functions</a></div>
				<div class="alignright"><a href="https://herbsutter.com/2013/05/22/gotw-6a-const-correctness-part-1/" rel="next">GotW #6a: Const-Correctness, Part&nbsp;1</a> &raquo;</div>
			</div>
			
			<div class="post-1984 post type-post status-publish format-standard hentry category-gotw" id="post-1984">
				<div class="posttitle">
					<h2>GotW #5 Solution: Overriding Virtual&nbsp;Functions</h2>
					<p class="post-info">2013-05-22 by <a href="https://herbsutter.com/author/herbsutter/" title="Posts by Herb Sutter">Herb Sutter</a>  </p>
				</div>

				<div class="entry">
					<p><span style="color:#5a5a5a;"><em>Virtual functions are a pretty basic feature, but they occasionally harbor subtleties that trap the unwary. If you can answer questions like this one, then you know virtual functions cold, and you&#8217;re less likely to waste a lot of time debugging problems like the ones illustrated below.<br />
</em></span></p>
<h1>Problem</h1>
<h2>JG Question</h2>
<p>1. What do the <span style="color:#2e74b5;">override</span> and <span style="color:#2e74b5;">final</span> keywords do? Why are they useful?</p>
<h2>Guru Question</h2>
<p>2. In your travels through the dusty corners of your company&#8217;s code archives, you come across the following program fragment written by an unknown programmer. The programmer seems to have been experimenting to see how some C++ features worked.</p>
<p style="margin-left:14pt;">(a) What could be improved in the code&#8217;s correctness or style?</p>
<p style="margin-left:14pt;">(b) What did the programmer probably expect the program to print, but what is the actual result?</p>
<pre><code>class base {
public:
    virtual void f( int );
    virtual void f( double );
    virtual void g( int i = 10 );
};

void base::f( int ) {
    cout &lt;&lt; "base::f(int)" &lt;&lt; endl;
}

void base::f( double ) {
    cout &lt;&lt; "base::f(double)" &lt;&lt; endl;
}

void base::g( int i ) {
    cout &lt;&lt; i &lt;&lt; endl;
}

class derived: public base {
public:
    void f( complex&lt;double&gt; );
    void g( int i = 20 );
};

void derived::f( complex&lt;double&gt; ) {
    cout &lt;&lt; "derived::f(complex)" &lt;&lt; endl;
}

void derived::g( int i ) {
    cout &lt;&lt; "derived::g() " &lt;&lt; i &lt;&lt; endl;
}

int main() {
    base    b;
    derived d;
    base*   pb = new derived;

    b.f(1.0);
    d.f(1.0);
    pb-&gt;f(1.0);

    b.g();
    d.g();
    pb-&gt;g();

    delete pb;
}
</code></pre>
<h1>Solution</h1>
<h2>1. What do the override and final keywords do? Why are they useful?</h2>
<p>These keywords give explicit control over virtual function overriding. Writing <span style="color:#2e74b5;">override</span> declares the intent to override a base class virtual function. Writing <span style="color:#2e74b5;">final</span> makes a virtual function no longer overrideable in further-derived classes, or a class no longer permitted to have further-derived classes.</p>
<p>They are useful because they let the programmer explicitly declare intent in a way the language can enforce at compile time. If you write <span style="color:#2e74b5;">override</span> but there is no matching base class function, or you write <span style="color:#2e74b5;">final</span> and a further-derived class tries to implicitly or explicitly override the function anyway, you get a compile-time error.</p>
<p>Of the two, by far the more commonly useful is <span style="color:#2e74b5;">override</span>; uses for <span style="color:#2e74b5;">final</span> are rarer.</p>
<h2>2. (a) What could be improved in the code&#8217;s correctness or style?</h2>
<p>First, let&#8217;s consider some style issues, and one real error:</p>
<h3>1. The code uses explicit new, delete, and an owning *.</h3>
<p>Avoid using owning raw pointers and explicit <span style="color:#2e74b5;">new</span> and <span style="color:#2e74b5;">delete</span> except in rare cases like when you&#8217;re writing the internal implementation details of a low-level data structure.</p>
<pre><code>{
    base*   pb = new derived;

    ...

    delete pb;
}
</code></pre>
<p>Instead of <span style="color:#2e74b5;">new</span> and <span style="color:#2e74b5;">base*</span>, use <span style="color:#2e74b5;">make_unique</span> and <span style="color:#2e74b5;">unique_ptr&lt;base&gt;</span>.</p>
<pre><code>{
    auto pb = unique_ptr&lt;base&gt;{ make_unique&lt;derived&gt;() };

    ...

} // automatic delete here
</code></pre>
<blockquote><p><strong>Guideline:</strong> Don&#8217;t use explicit <strong>new</strong>, <strong>delete</strong>, and owning <strong>*</strong> pointers, except in rare cases encapsulated inside the implementation of a low-level data structure.</p></blockquote>
<p>However, that <span style="color:#2e74b5;">delete</span> brings us to another issue unrelated to how we allocate and manage the lifetime of the object, namely:</p>
<h3>2. base&#8217;s destructor should be virtual or protected.</h3>
<pre><code>class base {
public:
    virtual void f( int );
    virtual void f( double );
    virtual void g( int i = 10 );
};
</code></pre>
<p>This looks innocuous, but the writer of <span style="color:#2e74b5;">base</span> forgot to make the destructor either <span style="color:#2e74b5;">virtual</span> or <span style="color:#2e74b5;">protected</span>. As it is, deleting via a pointer-to-base without a virtual destructor is evil, pure and simple, and corruption is the best thing you can hope for because the wrong destructor will get called, <span style="color:#2e74b5;">derived</span> class members won&#8217;t be destroyed, and <span style="color:#2e74b5;">operator delete</span> will be invoked with the wrong object size.</p>
<blockquote><p><strong>Guideline: </strong>Make base class destructors public and virtual, or protected and nonvirtual.</p></blockquote>
<p>Exactly one of the following can be true for a polymorphic type:</p>
<ul>
<li>Either destruction via a pointer to base is allowed, in which case the function has to be <span style="color:#2e74b5;">public</span> and had better be <span style="color:#2e74b5;">virtual</span>;</li>
<li>or else it isn&#8217;t, in which case the function has to be <span style="color:#2e74b5;">protected</span> (<span style="color:#2e74b5;">private</span> is not allowed because the derived destructor must be able to invoke the base destructor) and would naturally also be nonvirtual (when the derived destructor invokes the base destructor, it does so nonvirtually whether declared <span style="color:#2e74b5;">virtual</span> or not).</li>
</ul>
<h3>Interlude</h3>
<p>For the next few points, it&#8217;s important to differentiate three terms:</p>
<ul>
<li>To <strong>overload</strong> a function <span style="color:#2e74b5;">f</span> means to provide another function with the same name in the same scope but with different parameter types. When <span style="color:#2e74b5;">f</span> is actually called, the compiler will try to pick the best match based on the actual parameters that are supplied.</li>
<li>To <strong>override</strong> a virtual function <span style="color:#2e74b5;">f</span> means to provide another function with the same name and the same parameter types in a derived class.</li>
<li>To <strong>hide</strong> a function <span style="color:#2e74b5;">f</span> that exists in an enclosing scope (base class, outer class, or namespace) means to provide another function with the same name in an inner scope (derived class, nested class, or namespace), which will hide the same function name in an enclosing scope.</li>
</ul>
<h3>3. derived::f is neither an override nor an overload.</h3>
<pre><code>    void derived::f( complex&lt;double&gt; )
</code></pre>
<p><span style="color:#2e74b5;">derived</span> does not overload the <span style="color:#2e74b5;">base::f</span> functions, it hides them. This distinction is very important, because it means that <span style="color:#2e74b5;">base::f(int)</span> and <span style="color:#2e74b5;">base::f(double)</span> are not visible in the scope of <span style="color:#2e74b5;">derived</span>.</p>
<p>If the author of <span style="color:#2e74b5;">derived</span> intended to hide the base functions named <span style="color:#2e74b5;">f</span>, then this is all right. Usually, however, the hiding is inadvertent and surprising, and the correct way to bring the names into the scope of derived is to write the using-declaration <span style="color:#2e74b5;">using base::f;</span> inside <span style="color:#2e74b5;">derived</span>.</p>
<blockquote><p><strong>Guideline: </strong>When providing a non-overridden function with the same name as an inherited function, be sure to bring the inherited functions into scope with a <strong>using</strong>-declaration if you don&#8217;t want to hide them.</p></blockquote>
<h3>4. derived::g overrides base::g but doesn&#8217;t say &#8220;override.&#8221;</h3>
<pre><code>    void g( int i = 20 )  /* override */
</code></pre>
<p>This function overrides the base function, so it should say <span style="color:#2e74b5;">override</span> explicitly. This documents the intent, and lets the compiler tell you if you&#8217;re trying to override something that&#8217;s not virtual or you got the signature wrong by mistake.</p>
<blockquote><p><strong>Guideline: </strong>Always write<strong> override</strong> when you intend to override a virtual function.</p></blockquote>
<h3>5. derived::g overrides base::g but changes the default argument.</h3>
<pre><code>    void g( int i = 20 )
</code></pre>
<p>Changing the default argument is decidedly user-unfriendly. Unless you&#8217;re really out to confuse people, don&#8217;t change the default arguments of the inherited functions you override. Yes, this is legal C++, and yes, the result is well-defined; and no, don&#8217;t do it. Further below, we&#8217;ll see just how confusing this can be.</p>
<blockquote><p><strong>Guideline: </strong>Never change the default arguments of overridden inherited functions.</p></blockquote>
<p>We could go one step further:</p>
<blockquote><p><strong>Guideline:</strong> Avoid default arguments on virtual functions in general.</p></blockquote>
<p>Finally, public virtual functions are great when a class is acting as a pure abstract base class (ABC) that only specifies the virtual interface without implementations, like a C# or Java <span style="color:#2e74b5;">interface</span> does.</p>
<blockquote><p><strong>Guideline:</strong> Prefer to have a class contain only public virtual functions, or no public virtual functions (other than the destructor which is special).</p></blockquote>
<blockquote><p>A pure abstract base class should have only public virtual functions. …</p></blockquote>
<p>But when a class is both providing virtual functions and their implementations, consider the Non-Virtual Interface pattern (NVI) that makes the public interface and the virtual interface separate and distinct.</p>
<blockquote><p>… For any other base class, prefer making public member functions non-virtual, and virtual member functions non-public; the former should have any default arguments and can be implemented in terms of the latter.</p></blockquote>
<p>This cleanly separates the public interface from the derivation interface, lets each follow its natural form best suited for its distinct audience, and avoids having one function exist in tension from doing double duty with two responsibilities. Among other benefits, using NVI will often clarify your class&#8217;s design in important ways, including for example that the default arguments which matter to the caller therefore naturally belong on the public interface, not on the virtual interface. Following this pattern means that several classes of potential problems, including this one of virtuals with default arguments, just naturally don&#8217;t arise.</p>
<p>The C++ standard library follows NVI nearly universally, and other modern OO languages and environments have rediscovered this principle for their own library design guidelines, such as in the .NET <a href="http://www.amazon.com/Framework-Design-Guidelines-Conventions-Libraries/dp/0321545613"><em>Framework Design Guidelines</em></a>.</p>
<h2>2. (b) What did the programmer probably expect the program to print, but what is the actual result?</h2>
<p>Now that we have those issues out of the way, let&#8217;s look at the mainline and see whether it does that the programmer intended:</p>
<pre><code>int main() {
    base    b;
    derived d;
    base*   pb = new derived;

    b.f(1.0);
</code></pre>
<p>No problem. This first call invokes <span style="color:#2e74b5;">base::f( double )</span>, as expected.</p>
<pre><code>    d.f(1.0);
</code></pre>
<p>This calls <span style="color:#2e74b5;">derived::f( complex&lt;double&gt; )</span>. Why? Well, remember that <span style="color:#2e74b5;">derived</span> doesn&#8217;t declare <span style="color:#2e74b5;">using base::f;</span> to bring the base functions named <span style="color:#2e74b5;">f</span> into scope, and so clearly <span style="color:#2e74b5;">base::f( int )</span> and <span style="color:#2e74b5;">base::f( double )</span> can&#8217;t be called. They are not present in the same scope as <span style="color:#2e74b5;">derived::f( complex&lt;double&gt; )</span> so as to participate in overloading.</p>
<p>The programmer may have expected this to call <span style="color:#2e74b5;">base::f( double )</span>, but in this case there won&#8217;t even be a compile error because fortunately(?) <span style="color:#2e74b5;">complex&lt;double&gt;</span> provides an implicit conversion from <span style="color:#2e74b5;">double</span>, and so the compiler interprets this call to mean <span style="color:#2e74b5;">derived::f( complex&lt;double&gt;(1.0) )</span>.</p>
<pre><code>    pb-&gt;f(1.0);
</code></pre>
<p>Interestingly, even though the <span style="color:#2e74b5;">base* pb</span> is pointing to a <span style="color:#2e74b5;">derived</span> object, this calls <span style="color:#2e74b5;">base::f( double )</span> because overload resolution is done on the static type (here <span style="color:#2e74b5;">base</span>), not the dynamic type (here <span style="color:#2e74b5;">derived</span>). You have a <span style="color:#2e74b5;">base</span> pointer, you get the <span style="color:#2e74b5;">base</span> interface.</p>
<p>For the same reason, the call <span style="color:#2e74b5;">pb-&gt;f(complex&lt;double&gt;(1.0));</span> would not compile, because there is no satisfactory function in the base interface.</p>
<pre><code>    b.g();
</code></pre>
<p>This prints <span style="color:#2e74b5;">10</span>, because it simply invokes <span style="color:#2e74b5;">base::g( int )</span> whose parameter defaults to the value <span style="color:#2e74b5;">10</span>. No sweat.</p>
<pre><code>    d.g();
</code></pre>
<p>This prints <span style="color:#2e74b5;">derived::g() 20</span>, because it simply invokes <span style="color:#2e74b5;">derived::g( int )</span> whose parameter defaults to the value <span style="color:#2e74b5;">20</span>. Also no sweat.</p>
<pre><code>    pb-&gt;g();
</code></pre>
<p>This prints <span style="color:#2e74b5;">derived::g() 10</span>.</p>
<p>&#8220;Wait a minute!&#8221; you might protest. &#8220;What&#8217;s going on here?&#8221; This result may temporarily lock your mental brakes and bring you to a screeching halt until you realize that what the compiler has done is quite proper. (Although, of course, the programmer of <span style="color:#2e74b5;">derived</span> ought to be taken out into the back parking lot and yelled at.) The thing to remember is that, like overloads, default parameters are taken from the static type (here <span style="color:#2e74b5;">base</span>) of the object, hence the default value of <span style="color:#2e74b5;">10</span> is taken. However, the function happens to be virtual, and so the function actually called is based on the dynamic type (here <span style="color:#2e74b5;">derived</span>) of the object. Again, this can be avoided by avoiding default arguments on virtual functions, such as by following NVI and avoiding public virtual functions entirely.</p>
<pre><code>    delete pb;
}
</code></pre>
<p>Finally, as noted, this shouldn&#8217;t be needed because you should be using <span style="color:#2e74b5;">unique_ptr</span>s which do the cleanup for you, and <span style="color:#2e74b5;">base</span> should have a virtual destructor so that destruction via any pointer to <span style="color:#2e74b5;">base</span> is correct.</p>
<h2>Acknowledgments</h2>
<p>Thanks in particular to the following for their feedback to improve this article: litb1, KrzaQ, mttpd.</p>
									</div>

				<p class="postmetadata">
					Posted in <a href="https://herbsutter.com/category/c/gotw/" rel="category tag">GotW</a> | 											45 Comments									</p>
				
<!-- You can start editing here. -->

<h3 id="comments">45 Responses</h3>

	<ol class="commentlist">
			<li class="pingback even thread-even depth-1 highlander-comment" id="comment-29001">
		<div id="div-comment-29001">
		<div class="cmtinfo"><em> on <a href="#comment-29001" title="">2014-10-03 at 8:25 am</a></em>  <cite><a href='http://my-it-notes.com/2014/10/heterogeneous-vector-in-c-overview-of-common-approaches/' rel='external nofollow' class='url'>Heterogeneous vector in c++ - overview of common approaches | Мои IT-заметки</a></cite></div>
						<div class="pd-rating" id="pd_rating_holder_468178_comm_29001"></div><p>[&#8230;] First, read about differences between overriding and hiding of methods in inheritance hierarchy here or here. It is a great source of confusion, especially during investigation of fresh bug-reports. [&#8230;]</p>
			<br style="clear: both" />
		</div>
</li><!-- #comment-## -->
		<li class="comment byuser comment-author-suppressingfire odd alt thread-odd thread-alt depth-1 highlander-comment" id="comment-20430">
		<div id="div-comment-20430">
		<div class="cmtinfo"><em> on <a href="#comment-20430" title="">2014-05-21 at 1:58 pm</a></em> <img alt='' src='https://0.gravatar.com/avatar/6423f6272e5728b09eb8d98fb42f07e7?s=48&#038;d=identicon&#038;r=G' class='avatar avatar-48' height='48' width='48' /> <cite>suppressingfire</cite></div>
						<div class="pd-rating" id="pd_rating_holder_468178_comm_20430"></div><p>Hmm&#8230; I like using final like this:</p>
<pre class="brush: plain; title: ; notranslate" title="">
class base {
 public:
  virtual ~base() = default;
  virtual void foo() = 0;
 protected:
  base() = default;
}

class derived final : public base {
 public:
  derived() = default;
  ~derived() = default;
  void foo() override { /* do foo */ }
}

and then use it like this:

std::unique_ptr&lt;base&gt; bar = make_unique&lt;derived&gt;();
bar-&gt;foo();
</pre>
<p>Am I evil/misguided/leading my codebase down the primrose path?</p>
			<br style="clear: both" />
		</div>
</li><!-- #comment-## -->
		<li class="pingback even thread-even depth-1 highlander-comment" id="comment-13218">
		<div id="div-comment-13218">
		<div class="cmtinfo"><em> on <a href="#comment-13218" title="">2013-11-13 at 3:24 am</a></em>  <cite><a href='http://programminganswer.com/115640/use-cases-for-final-classes.html' rel='external nofollow' class='url'>Use cases for final classes | Technology &amp; Programming</a></cite></div>
						<div class="pd-rating" id="pd_rating_holder_468178_comm_13218"></div><p>[&#8230;] was reading comments on Herb Sutter&#8217;s Guru of the Week redux about virtual functions, and finally saw him [&#8230;]</p>
			<br style="clear: both" />
		</div>
</li><!-- #comment-## -->
		<li class="pingback odd alt thread-odd thread-alt depth-1 highlander-comment" id="comment-13206">
		<div id="div-comment-13206">
		<div class="cmtinfo"><em> on <a href="#comment-13206" title="">2013-11-12 at 1:20 am</a></em>  <cite><a href='http://programminganswer.com/107511/overloading-base-method-in-derived-class.html' rel='external nofollow' class='url'>Overloading base method in derived class | Technology &amp; Programming</a></cite></div>
						<div class="pd-rating" id="pd_rating_holder_468178_comm_13206"></div><p>[&#8230;] I was playing with C# to see if it matched C++ behavior from this post: <a href="https://herbsutter.com/2013/05/22/gotw-5-solution-overriding-virtual-functions/" rel="nofollow">https://herbsutter.com/2013/05/22/gotw-5-solution-overriding-virtual-functions/</a> when I came across this very strange [&#8230;]</p>
			<br style="clear: both" />
		</div>
</li><!-- #comment-## -->
		<li class="comment byuser comment-author-nosenseetal even thread-even depth-1 highlander-comment" id="comment-10657">
		<div id="div-comment-10657">
		<div class="cmtinfo"><em> on <a href="#comment-10657" title="">2013-05-29 at 11:22 am</a></em> <img alt='' src='https://0.gravatar.com/avatar/6aea6e2f57f2a7b1cd6870375fbdc42f?s=48&#038;d=identicon&#038;r=G' class='avatar avatar-48' height='48' width='48' /> <cite>nosenseetal</cite></div>
						<div class="pd-rating" id="pd_rating_holder_468178_comm_10657"></div><p>or else it isn’t, in which case the function has to be protected (private is not allowed because the derived destructor must be able to invoke the base destructor) and would naturally also be nonvirtual (when the derived destructor invokes the base destructor, it does so nonvirtually whether declared virtual or not).</p>
<p>why it cant be public ? Doesnt placement new/delete require that(lets pretend that some crazy person wants to put polymorphic object in char[compile_time_max(sizeof (Base), sizeof (Der1),sizeof (Der2)&#8230;]<br />
 :P</p>
			<br style="clear: both" />
		</div>
</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1 highlander-comment" id="comment-10591">
		<div id="div-comment-10591">
		<div class="cmtinfo"><em> on <a href="#comment-10591" title="">2013-05-28 at 5:55 pm</a></em> <img alt='' src='https://2.gravatar.com/avatar/26e95045ab2611253f7dcd8b71e2174c?s=48&#038;d=identicon&#038;r=G' class='avatar avatar-48' height='48' width='48' /> <cite>Michael Urman</cite></div>
						<div class="pd-rating" id="pd_rating_holder_468178_comm_10591"></div><p>@rhalbersma as an example of such a scoped guard see GotW 6b, part 6, option 1. </p>
<pre class="brush: plain; title: ; notranslate" title="">
{
    auto lock = std::unique_lock&lt;mutex&gt;{mutables};
    ::: // no further references to lock
    // lock destroyed; mutables released
}
</pre>
			<br style="clear: both" />
		</div>
</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1 highlander-comment" id="comment-10581">
		<div id="div-comment-10581">
		<div class="cmtinfo"><em> on <a href="#comment-10581" title="">2013-05-28 at 4:08 pm</a></em> <img alt='' src='https://0.gravatar.com/avatar/3be7c20c4a0dc941dfc40f99784d8f1d?s=48&#038;d=identicon&#038;r=G' class='avatar avatar-48' height='48' width='48' /> <cite><a href='http://www.longbowgames.com' rel='external nofollow' class='url'>Rick Yorgason</a></cite></div>
						<div class="pd-rating" id="pd_rating_holder_468178_comm_10581"></div><p>The one thing I&#8217;ve found final useful for is for marking when functions in base classes have been renamed or are otherwise obsolete. For instance:</p>
<pre class="brush: plain; title: ; notranslate" title="">
class Foo
{
protected:
  virtual void bar() final {}; // Don't use this anymore. Use baz() instead.
  virtual void baz();
};
</pre>
			<br style="clear: both" />
		</div>
</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1 highlander-comment" id="comment-10575">
		<div id="div-comment-10575">
		<div class="cmtinfo"><em> on <a href="#comment-10575" title="">2013-05-28 at 12:34 pm</a></em> <img alt='' src='https://2.gravatar.com/avatar/b1207a3e0fad1e644004e51ce09334ba?s=48&#038;d=identicon&#038;r=G' class='avatar avatar-48' height='48' width='48' /> <cite>Bhupesh Pant</cite></div>
						<div class="pd-rating" id="pd_rating_holder_468178_comm_10575"></div><p>@Herb,<br />
I am talking with reference to what Rhalbersma said. Well the suggested way by Rhalbersma is something that is also adopted by modern languages and compilers. We just do x=y or as Herb said, by mistake z=y, it will create a variable of type same as y. Then compiler can use some smart, not at all sweating mechanism to figure out whether it is a correct assignment or not&#8230;<br />
We can take example of python, we do similar stuff in python, though its entirely differently implemented at language level but point is the ease we have with that..</p>
<p>@Alok &amp; Sil,</p>
<p>I totally agree with what you are saying  but remember Rome was  not build in a day and so will your dream language. One thing I am sure you could feel the change. Some very smart people is constantly working hard for this change, probably we could see some major changes in C++14 or C++(yet to come) &#8230; :)</p>
			<br style="clear: both" />
		</div>
</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1 highlander-comment" id="comment-10523">
		<div id="div-comment-10523">
		<div class="cmtinfo"><em> on <a href="#comment-10523" title="">2013-05-27 at 5:35 pm</a></em> <img alt='' src='https://1.gravatar.com/avatar/7b4bb19457e88527e39d526111a764f4?s=48&#038;d=identicon&#038;r=G' class='avatar avatar-48' height='48' width='48' /> <cite>GeoffW</cite></div>
						<div class="pd-rating" id="pd_rating_holder_468178_comm_10523"></div><p>@Ricardo Costa: thanks for the link.  It&#8217;s actually quite apt for me.  I do already have a decimal type created (using the decNumber C library) with the intention it could be cut over to built-in types eventually &#8211; so I do now see the possible applicability of &#8220;final&#8221; for library code.</p>
			<br style="clear: both" />
		</div>
</li><!-- #comment-## -->
		<li class="pingback odd alt thread-odd thread-alt depth-1 highlander-comment" id="comment-10501">
		<div id="div-comment-10501">
		<div class="cmtinfo"><em> on <a href="#comment-10501" title="">2013-05-27 at 7:02 am</a></em>  <cite><a href='http://www.blogosfera.co.uk/2013/05/why-initialize-unique_ptr-with-a-make_unique-call/' rel='external nofollow' class='url'>Why initialize unique_ptr with a make_unique call? | BlogoSfera</a></cite></div>
						<div class="pd-rating" id="pd_rating_holder_468178_comm_10501"></div><p>[&#8230;] Taken from: <a href="https://herbsutter.com/2013/05/22/gotw-5-solution-overriding-virtual-functions/" rel="nofollow">https://herbsutter.com/2013/05/22/gotw-5-solution-overriding-virtual-functions/</a> [&#8230;]</p>
			<br style="clear: both" />
		</div>
</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1 highlander-comment" id="comment-10475">
		<div id="div-comment-10475">
		<div class="cmtinfo"><em> on <a href="#comment-10475" title="">2013-05-26 at 12:38 pm</a></em> <img alt='' src='https://i2.wp.com/graph.facebook.com/100004054812229/picture?q=type%3Dlarge&#038;resize=48%2C48' class='avatar avatar-48' height='48' width='48' /> <cite><a href='http://www.facebook.com/profile.php?id=100004054812229' rel='external nofollow' class='url'>Róbert Dávid</a></cite></div>
						<div class="pd-rating" id="pd_rating_holder_468178_comm_10475"></div><p>I hope I don&#8217;t :) I just want to point out (to Herb) that instead of the verbosity of<br />
auto pb = unique_ptr{ make_unique() };<br />
I find it better to have a guideline to use auto if there is no conversion during initialization, and write the type if there is. Or rephrasing:<br />
Use auto whenever you can, write the type only if you must.</p>
<p>(&#8220;meh&#8221; is no english word, try to read it with some disapproval in your voice :) )</p>
			<br style="clear: both" />
		</div>
</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1 highlander-comment" id="comment-10470">
		<div id="div-comment-10470">
		<div class="cmtinfo"><em> on <a href="#comment-10470" title="">2013-05-26 at 10:32 am</a></em> <img alt='' src='https://1.gravatar.com/avatar/a5880b79259a523e1a782864e8373c3e?s=48&#038;d=identicon&#038;r=G' class='avatar avatar-48' height='48' width='48' /> <cite><a href='http://gravatar.com/fpelliccioni' rel='external nofollow' class='url'>Fernando Pelliccioni</a></cite></div>
						<div class="pd-rating" id="pd_rating_holder_468178_comm_10470"></div><p>@Róbert Dávid:</p>
<p>&#8220;Meh&#8221;? Sorry, I am not native English speaker.</p>
<p>I know that. You didn&#8217;t need to explain. :)</p>
<p>I was just trying to simplify the code of Herb.</p>
<pre class="brush: plain; title: ; notranslate" title="">
auto pb = unique_ptr&lt;Base&gt;{ make_unique&lt;Derived&gt;() };
</pre>
			<br style="clear: both" />
		</div>
</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1 highlander-comment" id="comment-10435">
		<div id="div-comment-10435">
		<div class="cmtinfo"><em> on <a href="#comment-10435" title="">2013-05-25 at 7:30 am</a></em> <img alt='' src='https://i2.wp.com/graph.facebook.com/100004054812229/picture?q=type%3Dlarge%26_md5%3D9e5f827892523ff7a319a1687be4b4dd&#038;resize=48%2C48' class='avatar avatar-48' height='48' width='48' /> <cite><a href='http://www.facebook.com/profile.php?id=100004054812229' rel='external nofollow' class='url'>Róbert Dávid</a></cite></div>
						<div class="pd-rating" id="pd_rating_holder_468178_comm_10435"></div><p>@Fernando Pelliccioni:<br />
Meh. Just use the plain old</p>
<pre class="brush: plain; title: ; notranslate" title="">std::unique_ptr&lt;Base&gt; pb = std::make_unique&lt;Derived&gt;();</pre>
<p>If you are using &#8216;auto&#8217; for variables that have the same type as the initializer consistently, it will be obvious that there is a conversion here, and </p>
<pre class="brush: plain; title: ; notranslate" title="">auto pd = std::make_unique&lt;Derived&gt;();</pre>
<p>has no conversion.</p>
			<br style="clear: both" />
		</div>
</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1 highlander-comment" id="comment-10425">
		<div id="div-comment-10425">
		<div class="cmtinfo"><em> on <a href="#comment-10425" title="">2013-05-25 at 2:03 am</a></em> <img alt='' src='https://1.gravatar.com/avatar/466d72deba2523c861323a956cd51a8f?s=48&#038;d=identicon&#038;r=G' class='avatar avatar-48' height='48' width='48' /> <cite><a href='http://gravatar.com/ricardoglc' rel='external nofollow' class='url'>Ricardo Costa</a></cite></div>
						<div class="pd-rating" id="pd_rating_holder_468178_comm_10425"></div><p>@GeoffW You may want to check this article <a href="http://akrzemi1.wordpress.com/2012/09/30/why-make-your-classes-final/" rel="nofollow">http://akrzemi1.wordpress.com/2012/09/30/why-make-your-classes-final/</a> and especially the discussion in the comments section.</p>
<p>@rhalbersma As jhasse pointed out, you wouldn&#8217;t be able to shadow variables:</p>
<pre class="brush: plain; title: ; notranslate" title="">
auto x = 1;
{
    auto x = 2;
}
// x == 1 again
</pre>
			<br style="clear: both" />
		</div>
</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1 highlander-comment" id="comment-10414">
		<div id="div-comment-10414">
		<div class="cmtinfo"><em> on <a href="#comment-10414" title="">2013-05-24 at 11:44 am</a></em> <img alt='' src='https://1.gravatar.com/avatar/a5880b79259a523e1a782864e8373c3e?s=48&#038;d=identicon&#038;r=G' class='avatar avatar-48' height='48' width='48' /> <cite><a href='http://gravatar.com/fpelliccioni' rel='external nofollow' class='url'>Fernando Pelliccioni</a></cite></div>
						<div class="pd-rating" id="pd_rating_holder_468178_comm_10414"></div><p>Hi Herb,</p>
<p>I think</p>
<pre class="brush: plain; title: ; notranslate" title="">
auto pb = std::unique_ptr&lt;Base&gt;{ std::make_unique&lt;Derived&gt;() };
</pre>
<p>is too verbose. Unique is repeated&#8230;</p>
<p>How about this library solution for C++14 or C++17 ?</p>
<pre class="brush: plain; title: ; notranslate" title="">
auto pb = make_unique_poly&lt;base, derived&gt;();
</pre>
<p>Regards,<br />
Fernando.</p>
			<br style="clear: both" />
		</div>
</li><!-- #comment-## -->
		<li class="comment byuser comment-author-rhalbersma odd alt thread-odd thread-alt depth-1 highlander-comment" id="comment-10406">
		<div id="div-comment-10406">
		<div class="cmtinfo"><em> on <a href="#comment-10406" title="">2013-05-24 at 9:59 am</a></em> <img alt='' src='https://1.gravatar.com/avatar/d51a7cc9d8eb6aebd1f1fc6133111b8f?s=48&#038;d=identicon&#038;r=G' class='avatar avatar-48' height='48' width='48' /> <cite>rhalbersma</cite></div>
						<div class="pd-rating" id="pd_rating_holder_468178_comm_10406"></div><p>@Michael Urman: can you give a code example on how this scoped guard variable would occur?</p>
			<br style="clear: both" />
		</div>
</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1 highlander-comment" id="comment-10403">
		<div id="div-comment-10403">
		<div class="cmtinfo"><em> on <a href="#comment-10403" title="">2013-05-24 at 8:44 am</a></em> <img alt='' src='https://2.gravatar.com/avatar/2b9ca3d2134d452ec5e5aa5153bce650?s=48&#038;d=identicon&#038;r=G' class='avatar avatar-48' height='48' width='48' /> <cite>S. Colcord</cite></div>
						<div class="pd-rating" id="pd_rating_holder_468178_comm_10403"></div><p>@Herb:  &#8220;No, you still need a tag&#8221;</p>
<p>I wonder, though, if there might be some specific contexts in which the &#8216;auto&#8217; could be inferred if omitted, because you already know it&#8217;s a declaration.  For example, within a &#8216;for-range&#8217;declaration&#8217;.  This would allow the nicely concise syntax:</p>
<p>for ( i : mycontainer) {}</p>
			<br style="clear: both" />
		</div>
</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1 highlander-comment" id="comment-10400">
		<div id="div-comment-10400">
		<div class="cmtinfo"><em> on <a href="#comment-10400" title="">2013-05-24 at 8:32 am</a></em> <img alt='' src='https://2.gravatar.com/avatar/26e95045ab2611253f7dcd8b71e2174c?s=48&#038;d=identicon&#038;r=G' class='avatar avatar-48' height='48' width='48' /> <cite>Michael Urman</cite></div>
						<div class="pd-rating" id="pd_rating_holder_468178_comm_10400"></div><p>@rhalsbersma how would you differentiate between an unreferenced variable whose implicit declaration was due to a typo and an unreferenced variable whose lack of later reference is due to it being a scoped guard?</p>
			<br style="clear: both" />
		</div>
</li><!-- #comment-## -->
		<li class="comment byuser comment-author-javierestrada even thread-even depth-1 highlander-comment" id="comment-10397">
		<div id="div-comment-10397">
		<div class="cmtinfo"><em> on <a href="#comment-10397" title="">2013-05-24 at 8:01 am</a></em> <img alt='' src='https://2.gravatar.com/avatar/2c9641efd76416efbcc87a838ee54de6?s=48&#038;d=identicon&#038;r=G' class='avatar avatar-48' height='48' width='48' /> <cite><a href='http://javierestrada.wordpress.com' rel='external nofollow' class='url'>javierestrada</a></cite></div>
						<div class="pd-rating" id="pd_rating_holder_468178_comm_10397"></div><p>Herb, </p>
<p>In the guideline:</p>
<p>Guideline: Prefer to have a class contain only public virtual functions, or no public virtual functions (other than the destructor which is special).</p>
<p>It is unclear that protected virtual functions are possible and useful (protected interface) common in streams and a design pattern itself.  Now, &#8220;no public virtual functions&#8221; can cover this usage of virtual functions, but it&#8217;s subtle.</p>
<p>When you say:</p>
<p>&#8220;A pure abstract base class should have only public virtual functions. …&#8221;</p>
<p>Section 10.4 [class.abstract] only goes as far as defining an abstract class (neither pure nor &#8220;impure&#8221;) as a class with at least one pure virtual function. Since you can&#8217;t instantiate them, it follows that they can only be used as base classes.  I think the sentence could be clearer if it were reworded as:</p>
<p>&#8220;An abstract class with only pure virtual functions should have those functions be public.&#8221;</p>
<p>This leaves open cases where you want an abstract class to have a public interface where it can control pre/post conditions and then call a protected virtual function on a derived class (I use this technique extensively in large telephony frameworks in C++ and C#):</p>
<pre class="brush: plain; title: ; notranslate" title="">
class Call
{
  public:
    Drop()  { 
      // check preconditions, acquire locks, etc.,
      OnDrop();
     // check postconditions, release locks, etc.
    }

  protected:
    virtual void OnDrop() = 0;
...
};

class MyCall : public Call
{
...
protected:
  override void OnDrop() { ...}
};
</pre>
<p>Regards,</p>
<p>&#8211;Javier Estrada</p>
			<br style="clear: both" />
		</div>
</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1 highlander-comment" id="comment-10390">
		<div id="div-comment-10390">
		<div class="cmtinfo"><em> on <a href="#comment-10390" title="">2013-05-24 at 12:25 am</a></em> <img alt='' src='https://2.gravatar.com/avatar/233fb0b34cfba271d1787738e26d1bcc?s=48&#038;d=identicon&#038;r=G' class='avatar avatar-48' height='48' width='48' /> <cite>Sil</cite></div>
						<div class="pd-rating" id="pd_rating_holder_468178_comm_10390"></div><p>@Alok I tend to agree with you that c++ can be extremely hard to understand and to program correctly and as expected without a very sizeable time investment. I also wonder how and if it could be made even simpler and safer than the progresses in 11.</p>
<p>On the other hand isn&#8217;t it because it is used to design and architect a solution? i.e. if not in the C++ language itself there is still hard thinking to do and to implement for non trivial solutions, notably for modules or libraries, and this hard thinking has to be translated somehow, in guidelines or coding patterns or APIs for example, that will also have to be understood, implemented, checked and that will probably have pitfalls and tricky parts.</p>
<p>Is auto pb = unique_ptr{ make_unique() }; a trivial statement? No but should it be used very often in a real life scenario? Probably not.</p>
			<br style="clear: both" />
		</div>
</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1 highlander-comment" id="comment-10389">
		<div id="div-comment-10389">
		<div class="cmtinfo"><em> on <a href="#comment-10389" title="">2013-05-23 at 9:38 pm</a></em> <img alt='' src='https://2.gravatar.com/avatar/b4bb5fb2b99483ee43e9db30f096929b?s=48&#038;d=identicon&#038;r=G' class='avatar avatar-48' height='48' width='48' /> <cite>Alok</cite></div>
						<div class="pd-rating" id="pd_rating_holder_468178_comm_10389"></div><p>C++ really needs fixing.</p>
<p>While it makes sense to use things from the standard library when it provides one, the amount of thought process that needs to go into C++ programming (whether writing C++ standard library or own code) only shows the weaknesses of the language that blocks the programmer from going into higher level reasoning fast enough.  I do not believe that the programmer (of own code or the library) has to think this hard (were the language design optimal) to express some simple concepts like this.</p>
<p>Just look at this:  &#8220;auto pb = unique_ptr{ make_unique() };&#8221;, and oh, this is after use of the auto keyword.  There are things in C++ that need to be a part of the language itself which are a part of the library instead, and vice versa.</p>
<p>I am waiting for the day when some other language like Go or Julia takes over.</p>
			<br style="clear: both" />
		</div>
</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1 highlander-comment" id="comment-10381">
		<div id="div-comment-10381">
		<div class="cmtinfo"><em> on <a href="#comment-10381" title="">2013-05-23 at 2:57 pm</a></em> <img alt='' src='https://2.gravatar.com/avatar/8a82af8108d3c651d08a4ecb4386828c?s=48&#038;d=identicon&#038;r=G' class='avatar avatar-48' height='48' width='48' /> <cite>jhasse</cite></div>
						<div class="pd-rating" id="pd_rating_holder_468178_comm_10381"></div><p>@rhalbersma<br />
auto would make a difference since you wouldnt write it before assignments.</p>
<p>Also what about shadowing a variable?</p>
			<br style="clear: both" />
		</div>
</li><!-- #comment-## -->
		<li class="comment byuser comment-author-rhalbersma even thread-even depth-1 highlander-comment" id="comment-10375">
		<div id="div-comment-10375">
		<div class="cmtinfo"><em> on <a href="#comment-10375" title="">2013-05-23 at 1:01 pm</a></em> <img alt='' src='https://1.gravatar.com/avatar/d51a7cc9d8eb6aebd1f1fc6133111b8f?s=48&#038;d=identicon&#038;r=G' class='avatar avatar-48' height='48' width='48' /> <cite>rhalbersma</cite></div>
						<div class="pd-rating" id="pd_rating_holder_468178_comm_10375"></div><p>@Herb: I&#8217;m not really convinced by the off-by-one keyboard error. If you never reuse that variable z again, the compiler would warn (and give an error with warnings-as-errors) about an unused variable, and if you would use z again, then it might indeed silently compile and do the wrong thing, but auto wouldn&#8217;t make a difference. Can you give an example of any real compiler ambiguity?</p>
			<br style="clear: both" />
		</div>
</li><!-- #comment-## -->
		<li class="comment byuser comment-author-herbsutter bypostauthor odd alt thread-odd thread-alt depth-1 highlander-comment" id="comment-10374">
		<div id="div-comment-10374">
		<div class="cmtinfo"><em> on <a href="#comment-10374" title="">2013-05-23 at 12:43 pm</a></em> <img alt='' src='https://0.gravatar.com/avatar/c0ba56bfd231f8f04feb057728975181?s=48&#038;d=identicon&#038;r=G' class='avatar avatar-48' height='48' width='48' /> <cite><a href='http://www.herbsutter.com' rel='external nofollow' class='url'>Herb Sutter</a></cite></div>
						<div class="pd-rating" id="pd_rating_holder_468178_comm_10374"></div><p>@rhalbersma: No, you still need a tag, just as Pascal uses &#8220;var&#8221; and other languages use other tags. Otherwise, it&#8217;s ambiguous or worse. For example, if &#8220;x = y;&#8221; could be a variable declaration, what if you mistyped x with an off-by-one keyboard error and typed &#8220;z = y;&#8221; instead? Then anytime you misspelled a variable on the left of an assignment the compiler would happily introduce a new variable and silently compile. Seems like a large trap. Variable declarations do need to be tagged, and four characters is very minimalistic&#8230; and unlike Pascal you can declare them anywhere in a scope.</p>
			<br style="clear: both" />
		</div>
</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1 highlander-comment" id="comment-10373">
		<div id="div-comment-10373">
		<div class="cmtinfo"><em> on <a href="#comment-10373" title="">2013-05-23 at 12:29 pm</a></em> <img alt='' src='https://1.gravatar.com/avatar/d51a7cc9d8eb6aebd1f1fc6133111b8f?s=48&#038;d=identicon&#038;r=G' class='avatar avatar-48' height='48' width='48' /> <cite><a href='http://gravatar.com/rhalbersma' rel='external nofollow' class='url'>rhalbersma</a></cite></div>
						<div class="pd-rating" id="pd_rating_holder_468178_comm_10373"></div><p>@Herb If **every** initialization is written in the form </p>
<pre class="brush: plain; title: ; notranslate" title="">auto x = Type { expr }; </pre>
<p>, isn&#8217;t that the same as saying that the auto keyword itself could be left out altogether? What parsing ambiguities could arise if it were? The compiler would only have to check if the lhs of any = token had been seen in the same scope before. Or are there some name lookup issues that would interfere with this?</p>
			<br style="clear: both" />
		</div>
</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1 highlander-comment" id="comment-10367">
		<div id="div-comment-10367">
		<div class="cmtinfo"><em> on <a href="#comment-10367" title="">2013-05-23 at 9:03 am</a></em> <img alt='' src='https://2.gravatar.com/avatar/8bf8caef5631b5e61962cd2dd6bf87ae?s=48&#038;d=identicon&#038;r=G' class='avatar avatar-48' height='48' width='48' /> <cite>Arne Mertz</cite></div>
						<div class="pd-rating" id="pd_rating_holder_468178_comm_10367"></div><p>Yuck! That looks messed up, seems I&#8217;m too used to SO. Are there in-line code tags for comments like in the blog post itself?</p>
			<br style="clear: both" />
		</div>
</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1 highlander-comment" id="comment-10366">
		<div id="div-comment-10366">
		<div class="cmtinfo"><em> on <a href="#comment-10366" title="">2013-05-23 at 8:48 am</a></em> <img alt='' src='https://2.gravatar.com/avatar/8bf8caef5631b5e61962cd2dd6bf87ae?s=48&#038;d=identicon&#038;r=G' class='avatar avatar-48' height='48' width='48' /> <cite>Arne Mertz</cite></div>
						<div class="pd-rating" id="pd_rating_holder_468178_comm_10366"></div><p>On the </p>
<pre class="brush: plain; title: ; notranslate" title="">pb-&gt;f(1.0);</pre>
<p> you stress that overload resolution is done on the static type. I think the more surprising part for at least some people will be that having declared </p>
<pre class="brush: plain; title: ; notranslate" title="">f</pre>
<p> virtual has no effect on the result because as you stated earlier </p>
<pre class="brush: plain; title: ; notranslate" title="">f</pre>
<p> is not overridden but only hidden in </p>
<pre class="brush: plain; title: ; notranslate" title="">derived</pre>
<p>, so the virtual function dispatch will still call </p>
<pre class="brush: plain; title: ; notranslate" title="">base::f(double)</pre>
<p>.</p>
			<br style="clear: both" />
		</div>
</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1 highlander-comment" id="comment-10361">
		<div id="div-comment-10361">
		<div class="cmtinfo"><em> on <a href="#comment-10361" title="">2013-05-23 at 6:49 am</a></em> <img alt='' src='https://2.gravatar.com/avatar/e8f3bb6f744a08c55658906d5413938b?s=48&#038;d=identicon&#038;r=G' class='avatar avatar-48' height='48' width='48' /> <cite>Caleb Huitt</cite></div>
						<div class="pd-rating" id="pd_rating_holder_468178_comm_10361"></div><p>@Simon, @Arthur, and @Herb: You are all correct that I missed the slight change in semantics.</p>
<p>For the learning purposes, then, I like Herb&#8217;s modified line, because it is more explicit about what is happening as well as a) reinforcing that auto should be used for things like this, and b) points out that a conversion is happening.  I admit my eyes glazed over the first template specification, assuming a compatible result with make_unique.</p>
<p>If I was actually reviewing a similar line in code, I&#8217;d expect auto to be used (or possibly to be assigned to a class member variable, which opens up different typing considerations).</p>
			<br style="clear: both" />
		</div>
</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1 highlander-comment" id="comment-10359">
		<div id="div-comment-10359">
		<div class="cmtinfo"><em> on <a href="#comment-10359" title="">2013-05-23 at 6:25 am</a></em> <img alt='' src='https://2.gravatar.com/avatar/8bcbc5519492da9cafc3a8162c830427?s=48&#038;d=identicon&#038;r=G' class='avatar avatar-48' height='48' width='48' /> <cite>Mike</cite></div>
						<div class="pd-rating" id="pd_rating_holder_468178_comm_10359"></div><pre class="brush: plain; title: ; notranslate" title="">Guideline: Avoid default arguments on virtual functions in general.</pre>
<p>This needs to be more than just a guideline.  It needs to be a _rule_.  </p>
<p>It&#8217;s just never a good idea.  This is why function overloading exists.</p>
			<br style="clear: both" />
		</div>
</li><!-- #comment-## -->
		<li class="comment byuser comment-author-herbsutter bypostauthor odd alt thread-odd thread-alt depth-1 highlander-comment" id="comment-10358">
		<div id="div-comment-10358">
		<div class="cmtinfo"><em> on <a href="#comment-10358" title="">2013-05-23 at 6:25 am</a></em> <img alt='' src='https://0.gravatar.com/avatar/c0ba56bfd231f8f04feb057728975181?s=48&#038;d=identicon&#038;r=G' class='avatar avatar-48' height='48' width='48' /> <cite><a href='http://www.herbsutter.com' rel='external nofollow' class='url'>Herb Sutter</a></cite></div>
						<div class="pd-rating" id="pd_rating_holder_468178_comm_10358"></div><p>@GeoffW: Re “uses of final are rarer” – well, they sort of are. I don’t know of many, and during standardization Bjarne repeatedly asked for examples of problems it solved and patterns where it should be used, and I don’t recall any major ones that stood out. The only one I know of offhand is that if you’re defining a library module (which isn’t a Standard concept yet) then making leaf classes final can give the compiler more information to devirtualize calls because of knowing code outside the library won’t further derive, but I’m not sure how important that is these days in the presence of whole program optimization including aggressive devirtualization.</p>
<p>@Johan: Okay, you guys are convincing me that maybe I&#8217;m worrying too much about acceptance of &#8216;auto everywhere.&#8217; The reason I worried is because it&#8217;s a lightning rod issue that takes an amazing amount of energy in most C++11 overview sessions. Even on this blog when I announced I was restarting GotW and XC++, NEARLY EVERY comment on Reddit was about auto, which was mentioned only once in passing deep in the middle of the post. That&#8217;s all they could talk about. So I was leaning toward easing people into it, with a view of &#8220;you really need to get used to using auto frequently or at least consider it&#8221; while trying to avoid a brusque &#8220;this is the new way, get over it&#8221;&#8230; but okay, I&#8217;ve gone ahead with this change. Thanks for the feedback.</p>
			<br style="clear: both" />
		</div>
</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1 highlander-comment" id="comment-10352">
		<div id="div-comment-10352">
		<div class="cmtinfo"><em> on <a href="#comment-10352" title="">2013-05-23 at 3:27 am</a></em> <img alt='' src='https://0.gravatar.com/avatar/f1c1ee952adf2ec921c01b425011d96a?s=48&#038;d=identicon&#038;r=G' class='avatar avatar-48' height='48' width='48' /> <cite>Johan Oudinet</cite></div>
						<div class="pd-rating" id="pd_rating_holder_468178_comm_10352"></div><p>I vote for </p>
<pre class="brush: plain; title: ; notranslate" title="">auto pb = unique_ptr&lt;base&gt;{ make_unique&lt;derived&gt;() };</pre>
<p>I also like the improvement in both being conformed to the style of using auto as much as possible and seeing, in a more obvious way, the &#8220;conversion&#8221; from derived to base.<br />
Besides, since you are rewritting all GotW with the C++14 style, you shouldn&#8217;t be afraid by being unusual to most people&#8217;s eyes (i.e., people familiar with pre-C++14 style). On the contrary, not using auto to declare a variable seems unusual to me now.</p>
			<br style="clear: both" />
		</div>
</li><!-- #comment-## -->
		<li class="pingback odd alt thread-odd thread-alt depth-1 highlander-comment" id="comment-10350">
		<div id="div-comment-10350">
		<div class="cmtinfo"><em> on <a href="#comment-10350" title="">2013-05-23 at 2:02 am</a></em>  <cite><a href='http://www.blogosfera.co.uk/2013/05/overloading-base-method-in-derived-class/' rel='external nofollow' class='url'>Overloading base method in derived class | BlogoSfera</a></cite></div>
						<div class="pd-rating" id="pd_rating_holder_468178_comm_10350"></div><p>[&#8230;] I was playing with C# to see if it matched C++ behavior from this post: <a href="https://herbsutter.com/2013/05/22/gotw-5-solution-overriding-virtual-functions/" rel="nofollow">https://herbsutter.com/2013/05/22/gotw-5-solution-overriding-virtual-functions/</a> when I came across this very strange [&#8230;]</p>
			<br style="clear: both" />
		</div>
</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1 highlander-comment" id="comment-10340">
		<div id="div-comment-10340">
		<div class="cmtinfo"><em> on <a href="#comment-10340" title="">2013-05-22 at 5:39 pm</a></em> <img alt='' src='https://1.gravatar.com/avatar/7b4bb19457e88527e39d526111a764f4?s=48&#038;d=identicon&#038;r=G' class='avatar avatar-48' height='48' width='48' /> <cite>GeoffW</cite></div>
						<div class="pd-rating" id="pd_rating_holder_468178_comm_10340"></div><p>I don&#8217;t mean to be picky (well, maybe I do), but is &#8220;uses for final are rarer&#8221; the most that can be said for &#8220;final&#8221;?  On seeing the original JG question I had sort of hoped for more (the question did ask: &#8220;Why are they useful?&#8221;).  Maybe something about the sort of design situations that it was intended to aid &#8211; it must have been introduced into the standard for a reason.</p>
			<br style="clear: both" />
		</div>
</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1 highlander-comment" id="comment-10339">
		<div id="div-comment-10339">
		<div class="cmtinfo"><em> on <a href="#comment-10339" title="">2013-05-22 at 4:19 pm</a></em> <img alt='' src='https://2.gravatar.com/avatar/80ef658c3b540a9c26fed414c89a9b06?s=48&#038;d=identicon&#038;r=G' class='avatar avatar-48' height='48' width='48' /> <cite><a href='http://www.facebook.com/lachlan.easton' rel='external nofollow' class='url'>Lachlan Brad Easton</a></cite></div>
						<div class="pd-rating" id="pd_rating_holder_468178_comm_10339"></div><p>Yeah it was mentioned in an earlier post that C++14 would be targeted.</p>
			<br style="clear: both" />
		</div>
</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1 highlander-comment" id="comment-10338">
		<div id="div-comment-10338">
		<div class="cmtinfo"><em> on <a href="#comment-10338" title="">2013-05-22 at 4:01 pm</a></em> <img alt='' src='https://2.gravatar.com/avatar/21e08c9dc5723cb8cd946ea149610656?s=48&#038;d=identicon&#038;r=G' class='avatar avatar-48' height='48' width='48' /> <cite><a href='http://gravatar.com/thematto' rel='external nofollow' class='url'>TheMatto</a></cite></div>
						<div class="pd-rating" id="pd_rating_holder_468178_comm_10338"></div><p>make_unique: are we using C++1y here?</p>
			<br style="clear: both" />
		</div>
</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1 highlander-comment" id="comment-10336">
		<div id="div-comment-10336">
		<div class="cmtinfo"><em> on <a href="#comment-10336" title="">2013-05-22 at 3:58 pm</a></em> <img alt='' src='https://2.gravatar.com/avatar/21e08c9dc5723cb8cd946ea149610656?s=48&#038;d=identicon&#038;r=G' class='avatar avatar-48' height='48' width='48' /> <cite><a href='http://gravatar.com/thematto' rel='external nofollow' class='url'>TheMatto</a></cite></div>
						<div class="pd-rating" id="pd_rating_holder_468178_comm_10336"></div><p>Clarification: Where did make_unique come from? C++1y?</p>
			<br style="clear: both" />
		</div>
</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1 highlander-comment" id="comment-10335">
		<div id="div-comment-10335">
		<div class="cmtinfo"><em> on <a href="#comment-10335" title="">2013-05-22 at 3:49 pm</a></em> <img alt='' src='https://0.gravatar.com/avatar/cbf30a22f4780d66a41cbf13f4dbd170?s=48&#038;d=identicon&#038;r=G' class='avatar avatar-48' height='48' width='48' /> <cite><a href='http://www.broune.com' rel='external nofollow' class='url'>Bjarke Hammersholt Roune</a></cite></div>
						<div class="pd-rating" id="pd_rating_holder_468178_comm_10335"></div><p>When you are using NVI for a base class A with a function foo(), and a sub class B wants to call foo() on itself, does B call the public or private version of foo()? It seems to me that the answer to that depends on what A is doing in the public foo() and the needs of B &#8211; if B needs A to do what it does in the public interface, then B should call the public interface and otherwise B should call the private interface. If that is true, then NVI creates a new source of bugs where sub class writers now have the option of calling the wrong interface. Is NVI normally done in some way that side-steps this issue?</p>
			<br style="clear: both" />
		</div>
</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1 highlander-comment" id="comment-10332">
		<div id="div-comment-10332">
		<div class="cmtinfo"><em> on <a href="#comment-10332" title="">2013-05-22 at 3:33 pm</a></em> <img alt='' src='https://0.gravatar.com/avatar/c0ba56bfd231f8f04feb057728975181?s=48&#038;d=identicon&#038;r=G' class='avatar avatar-48' height='48' width='48' /> <cite><a href='http://www.herbsutter.com' rel='external nofollow' class='url'>Herb Sutter</a></cite></div>
						<div class="pd-rating" id="pd_rating_holder_468178_comm_10332"></div><p>Yep, at least three times I had to stop myself from &#8220;fixing&#8221; that line to say </p>
<pre class="brush: plain; title: ; notranslate" title="">auto pb = make_unique&lt;derived&gt;();</pre>
<p> which would actually have resolved a few problems (or at least changed them) but wouldn&#8217;t have preserved the semantics of the question. To preserve the semantics, I stuck with </p>
<pre class="brush: plain; title: ; notranslate" title=""> unique_ptr&lt;base&gt; pb = make_unique&lt;derived&gt;(); </pre>
<p>However, I was actually _this_ close to applying the style I currently prefer of &#8220;auto var = Type{ expr };&#8221; for conversions, which in this case would be only very slightly more wordy</p>
<pre class="brush: plain; title: ; notranslate" title=""> auto pb = unique_ptr&lt;base&gt;{ make_unique&lt;derived&gt;() }; </pre>
<p>I held back mainly because that style is still unusual to most people&#8217;s eyes and seeing the unique_ptr and the make_unique strung that close together might take some getting used to for readers&#8230; but now that I look at it, it does have the advantage of being very nice and explicit about what&#8217;s going on! Hmm. The more I look at it, the more I&#8217;m liking it&#8230;</p>
			<br style="clear: both" />
		</div>
</li><!-- #comment-## -->
		<li class="comment byuser comment-author-herbsutter bypostauthor even thread-even depth-1 highlander-comment" id="comment-10330">
		<div id="div-comment-10330">
		<div class="cmtinfo"><em> on <a href="#comment-10330" title="">2013-05-22 at 3:12 pm</a></em> <img alt='' src='https://0.gravatar.com/avatar/c0ba56bfd231f8f04feb057728975181?s=48&#038;d=identicon&#038;r=G' class='avatar avatar-48' height='48' width='48' /> <cite><a href='http://www.herbsutter.com' rel='external nofollow' class='url'>Herb Sutter</a></cite></div>
						<div class="pd-rating" id="pd_rating_holder_468178_comm_10330"></div><p>@KrzaQ: Yup, : should be :: &#8212; fixed, thanks.</p>
<p>@mttpd: Yup, fixed. The original GotW had &#8220;void main()&#8221; and made a pedantic point about its conformance, and I decided it was a distraction and removed it by changing it to &#8220;int main()&#8221; in the question, but forgot to also update the solution.</p>
			<br style="clear: both" />
		</div>
</li><!-- #comment-## -->
		<li class="comment byuser comment-author-mttpd odd alt thread-odd thread-alt depth-1 highlander-comment" id="comment-10328">
		<div id="div-comment-10328">
		<div class="cmtinfo"><em> on <a href="#comment-10328" title="">2013-05-22 at 1:08 pm</a></em> <img alt='' src='https://1.gravatar.com/avatar/1cc4a77a8256c3049728728c6c45625b?s=48&#038;d=identicon&#038;r=G' class='avatar avatar-48' height='48' width='48' /> <cite>mttpd</cite></div>
						<div class="pd-rating" id="pd_rating_holder_468178_comm_10328"></div><pre class="brush: plain; title: ; notranslate" title="">void main()</pre>
<p> &#8212; ouch! I don&#8217;t think this was really intended here! ;-)</p>
			<br style="clear: both" />
		</div>
</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1 highlander-comment" id="comment-10325">
		<div id="div-comment-10325">
		<div class="cmtinfo"><em> on <a href="#comment-10325" title="">2013-05-22 at 12:24 pm</a></em> <img alt='' src='https://1.gravatar.com/avatar/722e6b9bdc6a4d7851f30227b38f2183?s=48&#038;d=identicon&#038;r=G' class='avatar avatar-48' height='48' width='48' /> <cite><a href='http://cpphappyfunhouse.com/' rel='external nofollow' class='url'>Arthur Langereis</a></cite></div>
						<div class="pd-rating" id="pd_rating_holder_468178_comm_10325"></div><p>@Caleb, he&#8217;s explicit here as make_unique would return a unique_ptr to derived, not to base, which is what he wants here and which is the equivalent of the original code.</p>
			<br style="clear: both" />
		</div>
</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1 highlander-comment" id="comment-10323">
		<div id="div-comment-10323">
		<div class="cmtinfo"><em> on <a href="#comment-10323" title="">2013-05-22 at 12:04 pm</a></em> <img alt='' src='https://1.gravatar.com/avatar/af6718825cf4fcccae47716e7fd3c66f?s=48&#038;d=identicon&#038;r=G' class='avatar avatar-48' height='48' width='48' /> <cite><a href='http://dev.krzaq.cc' rel='external nofollow' class='url'>KrzaQ</a></cite></div>
						<div class="pd-rating" id="pd_rating_holder_468178_comm_10323"></div><p>I&#8217;m pretty sure that </p>
<pre class="brush: plain; title: ; notranslate" title="">base:f;</pre>
<p> should be </p>
<pre class="brush: plain; title: ; notranslate" title="">base::f;</pre>
<p> in &#8220;Well, remember that derived doesn’t declare using base:f; to bring the base functions named f into scope&#8221;. I&#8217;m sorry if this isn&#8217;t the way to report typos.</p>
<p>While I&#8217;m at it, let me thank you for restarting  GotW, I find your challenges stimulating.</p>
			<br style="clear: both" />
		</div>
</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1 highlander-comment" id="comment-10319">
		<div id="div-comment-10319">
		<div class="cmtinfo"><em> on <a href="#comment-10319" title="">2013-05-22 at 11:39 am</a></em> <img alt='' src='https://1.gravatar.com/avatar/7b923046328b3d1cf825653f0feff419?s=48&#038;d=identicon&#038;r=G' class='avatar avatar-48' height='48' width='48' /> <cite>Simon L</cite></div>
						<div class="pd-rating" id="pd_rating_holder_468178_comm_10319"></div><p>Apologies, that was meant to read that on the second line pb&#8217;s type will be</p>
<pre class="brush: plain; title: ; notranslate" title="">unique_ptr&lt;derived&gt;</pre>
			<br style="clear: both" />
		</div>
</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1 highlander-comment" id="comment-10318">
		<div id="div-comment-10318">
		<div class="cmtinfo"><em> on <a href="#comment-10318" title="">2013-05-22 at 11:38 am</a></em> <img alt='' src='https://1.gravatar.com/avatar/7b923046328b3d1cf825653f0feff419?s=48&#038;d=identicon&#038;r=G' class='avatar avatar-48' height='48' width='48' /> <cite>Simon L</cite></div>
						<div class="pd-rating" id="pd_rating_holder_468178_comm_10318"></div><p>Caleb, in your two lines the type of pb will be different. in the second line it will be a unique_ptr. If that&#8217;s what you want, fine, but it&#8217;s not the same as the first line, which includes an implicit conversion.</p>
			<br style="clear: both" />
		</div>
</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1 highlander-comment" id="comment-10317">
		<div id="div-comment-10317">
		<div class="cmtinfo"><em> on <a href="#comment-10317" title="">2013-05-22 at 11:27 am</a></em> <img alt='' src='https://2.gravatar.com/avatar/e8f3bb6f744a08c55658906d5413938b?s=48&#038;d=identicon&#038;r=G' class='avatar avatar-48' height='48' width='48' /> <cite>Caleb Huitt</cite></div>
						<div class="pd-rating" id="pd_rating_holder_468178_comm_10317"></div><p>Surely given your previous comments (and my own lazy inclinations), this line:</p>
<pre class="brush: plain; title: ; notranslate" title=""> unique_ptr&lt;base&gt; pb = make_unique&lt;derived&gt;();</pre>
<p>could become:</p>
<pre class="brush: plain; title: ; notranslate" title=""> auto pb = make_unique&lt;derived&gt;();</pre>
			<br style="clear: both" />
		</div>
</li><!-- #comment-## -->
	</ol>

	<div class="navigation">
		<div class="alignleft"></div>
		<div class="alignright"></div>
	</div>
	<br />

  	<p class="nocomments">Comments are closed.</p>
  <div class="post-content">
<p>
</p>
</div>

			</div>

		
		<p align="center"></p>

	</div><!-- end id:content-main -->
<div id="sidebar">
<ul>
<li class="sidebox"><h2><label for="subscribe-field">Follow by email</label></h2>
				<form action="https://subscribe.wordpress.com" method="post" accept-charset="utf-8" id="subscribe-blog">
																	<p><input type="text" name="email" style="width: 95%; padding: 1px 2px" placeholder="Enter your email address" value="" id="subscribe-field"/></p>
					
					<p>
						<input type="hidden" name="action" value="subscribe"/>
						<input type="hidden" name="blog_id" value="3379246"/>
						<input type="hidden" name="source" value="https://herbsutter.com/2013/05/22/gotw-5-solution-overriding-virtual-functions/"/>
						<input type="hidden" name="sub-type" value="widget"/>
						<input type="hidden" name="redirect_fragment" value="blog_subscription-3" />
						<input type="hidden" id="_wpnonce" name="_wpnonce" value="4590924cc6" />						<input type="submit" value="Subscribe" />
					</p>
				</form>
			
</li><li class="sidebox"><h2><a href='http://twitter.com/herbsutter'>Tweets</a></h2><ul class='tweets'></ul><a href="http://twitter.com/herbsutter"  class='twitter-follow-button' data-show-count='false' data-link-color='#265e15' data-text-color='#333333'>Follow @herbsutter</a></li><li class="sidebox"><h2>Popular</h2><ul>				<li>
										<a href="https://herbsutter.com/2018/11/13/trip-report-fall-iso-c-standards-meeting-san-diego/" class="bump-view" data-bump-view="tp">
						Trip report: Fall ISO C++ standards meeting (San Diego)					</a>
										</li>
								<li>
										<a href="https://herbsutter.com/gotw/" class="bump-view" data-bump-view="tp">
						GotW					</a>
										</li>
								<li>
										<a href="https://herbsutter.com/2018/09/20/lifetime-profile-v1-0-posted/" class="bump-view" data-bump-view="tp">
						Lifetime profile v1.0 posted					</a>
										</li>
				</ul></li><li class="sidebox"><h2>Categories</h2>		<ul>
				<li class="cat-item cat-item-291"><a href="https://herbsutter.com/category/apple/" >Apple</a>
</li>
	<li class="cat-item cat-item-49277"><a href="https://herbsutter.com/category/c-net/" >C# / .NET</a>
</li>
	<li class="cat-item cat-item-2426"><a href="https://herbsutter.com/category/c/" >C++</a>
</li>
	<li class="cat-item cat-item-69816"><a href="https://herbsutter.com/category/cloud/" >Cloud</a>
</li>
	<li class="cat-item cat-item-214618"><a href="https://herbsutter.com/category/concurrency/" >Concurrency</a>
</li>
	<li class="cat-item cat-item-8259773"><a href="https://herbsutter.com/category/effective-concurrency/" >Effective Concurrency</a>
</li>
	<li class="cat-item cat-item-3696745"><a href="https://herbsutter.com/category/friday-thoughts/" >Friday Thoughts</a>
</li>
	<li class="cat-item cat-item-3867746"><a href="https://herbsutter.com/category/c/gotw/" >GotW</a>
</li>
	<li class="cat-item cat-item-79"><a href="https://herbsutter.com/category/hardware/" >Hardware</a>
</li>
	<li class="cat-item cat-item-1017"><a href="https://herbsutter.com/category/java/" >Java</a>
</li>
	<li class="cat-item cat-item-637"><a href="https://herbsutter.com/category/microsoft/" >Microsoft</a>
</li>
	<li class="cat-item cat-item-420845"><a href="https://herbsutter.com/category/opinion-editorial/" >Opinion &amp; Editorial</a>
</li>
	<li class="cat-item cat-item-1633077"><a href="https://herbsutter.com/category/reader-qa/" >Reader Q&amp;A</a>
</li>
	<li class="cat-item cat-item-2301"><a href="https://herbsutter.com/category/software-development/" >Software Development</a>
</li>
	<li class="cat-item cat-item-393523"><a href="https://herbsutter.com/category/talks-events/" >Talks &amp; Events</a>
</li>
	<li class="cat-item cat-item-1"><a href="https://herbsutter.com/category/uncategorized/" >Uncategorized</a>
</li>
	<li class="cat-item cat-item-151"><a href="https://herbsutter.com/category/web/" >Web</a>
</li>
		</ul>
			</li></ul>
</div><!-- end id:sidebar -->
</div><!-- end id:content -->
</div><!-- end id:container -->
<div id="footer">
	<div id="colophon">
		<p><a href="https://wordpress.com/?ref=footer_blog">Blog at WordPress.com.</a></p>
		<p>WPThemes.</p>
		<br class="clear" />
	</div><!-- end #colophon-->
</div><!-- end #footer-->
<!--  -->
<script type='text/javascript' src='//0.gravatar.com/js/gprofiles.js?ver=201847y'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var WPGroHo = {"my_hash":""};
/* ]]> */
</script>
<script type='text/javascript' src='https://s1.wp.com/wp-content/mu-plugins/gravatar-hovercards/wpgroho.js?m=1380573781h'></script>

	<script>
		//initialize and attach hovercards to all gravatars
		jQuery( document ).ready( function( $ ) {

			if (typeof Gravatar === "undefined"){
				return;
			}

			if ( typeof Gravatar.init !== "function" ) {
				return;
			}			

			Gravatar.profile_cb = function( hash, id ) {
				WPGroHo.syncProfileData( hash, id );
			};
			Gravatar.my_hash = WPGroHo.my_hash;
			Gravatar.init( 'body', '#wp-admin-bar-my-account' );
		});
	</script>

		<div style="display:none">
	<div class="grofile-hash-map-6423f6272e5728b09eb8d98fb42f07e7">
	</div>
	<div class="grofile-hash-map-6aea6e2f57f2a7b1cd6870375fbdc42f">
	</div>
	<div class="grofile-hash-map-26e95045ab2611253f7dcd8b71e2174c">
	</div>
	<div class="grofile-hash-map-3be7c20c4a0dc941dfc40f99784d8f1d">
	</div>
	<div class="grofile-hash-map-b1207a3e0fad1e644004e51ce09334ba">
	</div>
	<div class="grofile-hash-map-7b4bb19457e88527e39d526111a764f4">
	</div>
	<div class="grofile-hash-map-322cf2e150d5cd84275b131184731c0a">
	</div>
	<div class="grofile-hash-map-a5880b79259a523e1a782864e8373c3e">
	</div>
	<div class="grofile-hash-map-466d72deba2523c861323a956cd51a8f">
	</div>
	<div class="grofile-hash-map-d51a7cc9d8eb6aebd1f1fc6133111b8f">
	</div>
	<div class="grofile-hash-map-2b9ca3d2134d452ec5e5aa5153bce650">
	</div>
	<div class="grofile-hash-map-2c9641efd76416efbcc87a838ee54de6">
	</div>
	<div class="grofile-hash-map-233fb0b34cfba271d1787738e26d1bcc">
	</div>
	<div class="grofile-hash-map-b4bb5fb2b99483ee43e9db30f096929b">
	</div>
	<div class="grofile-hash-map-8a82af8108d3c651d08a4ecb4386828c">
	</div>
	<div class="grofile-hash-map-c0ba56bfd231f8f04feb057728975181">
	</div>
	<div class="grofile-hash-map-d51a7cc9d8eb6aebd1f1fc6133111b8f">
	</div>
	<div class="grofile-hash-map-8bf8caef5631b5e61962cd2dd6bf87ae">
	</div>
	<div class="grofile-hash-map-e8f3bb6f744a08c55658906d5413938b">
	</div>
	<div class="grofile-hash-map-8bcbc5519492da9cafc3a8162c830427">
	</div>
	<div class="grofile-hash-map-f1c1ee952adf2ec921c01b425011d96a">
	</div>
	<div class="grofile-hash-map-80ef658c3b540a9c26fed414c89a9b06">
	</div>
	<div class="grofile-hash-map-21e08c9dc5723cb8cd946ea149610656">
	</div>
	<div class="grofile-hash-map-cbf30a22f4780d66a41cbf13f4dbd170">
	</div>
	<div class="grofile-hash-map-c0ba56bfd231f8f04feb057728975181">
	</div>
	<div class="grofile-hash-map-1cc4a77a8256c3049728728c6c45625b">
	</div>
	<div class="grofile-hash-map-722e6b9bdc6a4d7851f30227b38f2183">
	</div>
	<div class="grofile-hash-map-af6718825cf4fcccae47716e7fd3c66f">
	</div>
	<div class="grofile-hash-map-7b923046328b3d1cf825653f0feff419">
	</div>
	</div>
<script type='text/javascript' charset='UTF-8' id='polldaddyRatings'><!--//--><![CDATA[//><!--
PDRTJS_settings_468178_comm_29001={"id":468178,"unique_id":"wp-comment-29001","title":"%26%23091%3B%26%238230%3B%26%23093%3B%20First%2C%20read%20about%20differences%20between%20overriding%20and%20hiding%20of%20methods%20in%20inheritance%20hierarchy%20here%20or%20here.%20It%20is%20a%20great%20source%20of%20confusion%2C%20especially%20during%20investigation%20of%20fresh...","permalink":"https:\/\/herbsutter.com\/2013\/05\/22\/gotw-5-solution-overriding-virtual-functions\/#comment-29001","item_id":"_comm_29001"}; if ( typeof PDRTJS_RATING !== 'undefined' ){if ( typeof PDRTJS_468178_comm_29001 == 'undefined' ){PDRTJS_468178_comm_29001 = new PDRTJS_RATING( PDRTJS_settings_468178_comm_29001 );}}PDRTJS_settings_468178_comm_20430={"id":468178,"unique_id":"wp-comment-20430","title":"Hmm...%20I%20like%20using%20final%20like%20this%3A%26%23091%3Bcode%26%23093%3Bclass%20base%20%7B%20public%3A%20%20virtual%20~base%28%29%20%3D%20default%3B%20%20virtual%20void%20foo%28%29%20%3D%200%3B%20protected%3A%20%20base%28%29%20%3D%20default%3B%7Dclass%20derived%20final%20%3A%20public%20base%20%7B%20public%3A%20%20deri...","permalink":"https:\/\/herbsutter.com\/2013\/05\/22\/gotw-5-solution-overriding-virtual-functions\/#comment-20430","item_id":"_comm_20430"}; if ( typeof PDRTJS_RATING !== 'undefined' ){if ( typeof PDRTJS_468178_comm_20430 == 'undefined' ){PDRTJS_468178_comm_20430 = new PDRTJS_RATING( PDRTJS_settings_468178_comm_20430 );}}PDRTJS_settings_468178_comm_13218={"id":468178,"unique_id":"wp-comment-13218","title":"%26%23091%3B%26%238230%3B%26%23093%3B%20was%20reading%20comments%20on%20Herb%20Sutter%26%238217%3Bs%20Guru%20of%20the%20Week%20redux%20about%20virtual%20functions%2C%20and%20finally%20saw%20him%20%26%23091%3B%26%238230%3B%26%23093%3B...","permalink":"https:\/\/herbsutter.com\/2013\/05\/22\/gotw-5-solution-overriding-virtual-functions\/#comment-13218","item_id":"_comm_13218"}; if ( typeof PDRTJS_RATING !== 'undefined' ){if ( typeof PDRTJS_468178_comm_13218 == 'undefined' ){PDRTJS_468178_comm_13218 = new PDRTJS_RATING( PDRTJS_settings_468178_comm_13218 );}}PDRTJS_settings_468178_comm_13206={"id":468178,"unique_id":"wp-comment-13206","title":"%26%23091%3B%26%238230%3B%26%23093%3B%20I%20was%20playing%20with%20C%23%20to%20see%20if%20it%20matched%20C%2B%2B%20behavior%20from%20this%20post%3A%20http%3A%2F%2Fherbsutter.com%2F2013%2F05%2F22%2Fgotw-5-solution-overriding-virtual-functions%2F%20when%20I%20came%20across%20this%20very%20stran...","permalink":"https:\/\/herbsutter.com\/2013\/05\/22\/gotw-5-solution-overriding-virtual-functions\/#comment-13206","item_id":"_comm_13206"}; if ( typeof PDRTJS_RATING !== 'undefined' ){if ( typeof PDRTJS_468178_comm_13206 == 'undefined' ){PDRTJS_468178_comm_13206 = new PDRTJS_RATING( PDRTJS_settings_468178_comm_13206 );}}PDRTJS_settings_468178_comm_10657={"id":468178,"unique_id":"wp-comment-10657","title":"or%20else%20it%20isnt%2C%20in%20which%20case%20the%20function%20has%20to%20be%20protected%20%28private%20is%20not%20allowed%20because%20the%20derived%20destructor%20must%20be%20able%20to%20invoke%20the%20base%20destructor%29%20and%20would%20naturally%20also%20be%20nonv...","permalink":"https:\/\/herbsutter.com\/2013\/05\/22\/gotw-5-solution-overriding-virtual-functions\/#comment-10657","item_id":"_comm_10657"}; if ( typeof PDRTJS_RATING !== 'undefined' ){if ( typeof PDRTJS_468178_comm_10657 == 'undefined' ){PDRTJS_468178_comm_10657 = new PDRTJS_RATING( PDRTJS_settings_468178_comm_10657 );}}PDRTJS_settings_468178_comm_10591={"id":468178,"unique_id":"wp-comment-10591","title":"%40rhalbersma%20as%20an%20example%20of%20such%20a%20scoped%20guard%20see%20GotW%206b%2C%20part%206%2C%20option%201.%20%26%23091%3Bcode%26%23093%3B%7B%20%20%20%20auto%20lock%20%3D%20std%3A%3Aunique_lock%26lt%3Bmutex%26gt%3B%7Bmutables%7D%3B%20%20%20%20%3A%3A%3A%20%2F%2F%20no%20further%20references%20to%20lock%20%20%20%20%2F%2F%20lock%20...","permalink":"https:\/\/herbsutter.com\/2013\/05\/22\/gotw-5-solution-overriding-virtual-functions\/#comment-10591","item_id":"_comm_10591"}; if ( typeof PDRTJS_RATING !== 'undefined' ){if ( typeof PDRTJS_468178_comm_10591 == 'undefined' ){PDRTJS_468178_comm_10591 = new PDRTJS_RATING( PDRTJS_settings_468178_comm_10591 );}}PDRTJS_settings_468178_comm_10581={"id":468178,"unique_id":"wp-comment-10581","title":"The%20one%20thing%20I%26%23039%3Bve%20found%20final%20useful%20for%20is%20for%20marking%20when%20functions%20in%20base%20classes%20have%20been%20renamed%20or%20are%20otherwise%20obsolete.%20For%20instance%3A%26%23091%3Bcode%26%23093%3Bclass%20Foo%7Bprotected%3A%20%20virtual%20void%20bar%28%29%20fi...","permalink":"https:\/\/herbsutter.com\/2013\/05\/22\/gotw-5-solution-overriding-virtual-functions\/#comment-10581","item_id":"_comm_10581"}; if ( typeof PDRTJS_RATING !== 'undefined' ){if ( typeof PDRTJS_468178_comm_10581 == 'undefined' ){PDRTJS_468178_comm_10581 = new PDRTJS_RATING( PDRTJS_settings_468178_comm_10581 );}}PDRTJS_settings_468178_comm_10575={"id":468178,"unique_id":"wp-comment-10575","title":"%40Herb%2CI%20am%20talking%20with%20reference%20to%20what%20Rhalbersma%20said.%20Well%20the%20suggested%20way%20by%20Rhalbersma%20is%20something%20that%20is%20also%20adopted%20by%20modern%20languages%20and%20compilers.%20We%20just%20do%20x%3Dy%20or%20as%20Herb%20said...","permalink":"https:\/\/herbsutter.com\/2013\/05\/22\/gotw-5-solution-overriding-virtual-functions\/#comment-10575","item_id":"_comm_10575"}; if ( typeof PDRTJS_RATING !== 'undefined' ){if ( typeof PDRTJS_468178_comm_10575 == 'undefined' ){PDRTJS_468178_comm_10575 = new PDRTJS_RATING( PDRTJS_settings_468178_comm_10575 );}}PDRTJS_settings_468178_comm_10523={"id":468178,"unique_id":"wp-comment-10523","title":"%40Ricardo%20Costa%3A%20thanks%20for%20the%20link.%20%20It%26%23039%3Bs%20actually%20quite%20apt%20for%20me.%20%20I%20do%20already%20have%20a%20decimal%20type%20created%20%28using%20the%20decNumber%20C%20library%29%20with%20the%20intention%20it%20could%20be%20cut%20over%20to%20built-in...","permalink":"https:\/\/herbsutter.com\/2013\/05\/22\/gotw-5-solution-overriding-virtual-functions\/#comment-10523","item_id":"_comm_10523"}; if ( typeof PDRTJS_RATING !== 'undefined' ){if ( typeof PDRTJS_468178_comm_10523 == 'undefined' ){PDRTJS_468178_comm_10523 = new PDRTJS_RATING( PDRTJS_settings_468178_comm_10523 );}}PDRTJS_settings_468178_comm_10501={"id":468178,"unique_id":"wp-comment-10501","title":"%26%23091%3B%26%238230%3B%26%23093%3B%20Taken%20from%3A%20http%3A%2F%2Fherbsutter.com%2F2013%2F05%2F22%2Fgotw-5-solution-overriding-virtual-functions%2F%20%26%23091%3B%26%238230%3B%26%23093%3B...","permalink":"https:\/\/herbsutter.com\/2013\/05\/22\/gotw-5-solution-overriding-virtual-functions\/#comment-10501","item_id":"_comm_10501"}; if ( typeof PDRTJS_RATING !== 'undefined' ){if ( typeof PDRTJS_468178_comm_10501 == 'undefined' ){PDRTJS_468178_comm_10501 = new PDRTJS_RATING( PDRTJS_settings_468178_comm_10501 );}}PDRTJS_settings_468178_comm_10475={"id":468178,"unique_id":"wp-comment-10475","title":"I%20hope%20I%20don%26%23039%3Bt%20%3A%29%20I%20just%20want%20to%20point%20out%20%28to%20Herb%29%20that%20instead%20of%20the%20verbosity%20ofauto%20pb%20%3D%20unique_ptr%7B%20make_unique%28%29%20%7D%3BI%20find%20it%20better%20to%20have%20a%20guideline%20to%20use%20auto%20if%20there%20is%20no%20conversi...","permalink":"https:\/\/herbsutter.com\/2013\/05\/22\/gotw-5-solution-overriding-virtual-functions\/#comment-10475","item_id":"_comm_10475"}; if ( typeof PDRTJS_RATING !== 'undefined' ){if ( typeof PDRTJS_468178_comm_10475 == 'undefined' ){PDRTJS_468178_comm_10475 = new PDRTJS_RATING( PDRTJS_settings_468178_comm_10475 );}}PDRTJS_settings_468178_comm_10470={"id":468178,"unique_id":"wp-comment-10470","title":"%40Rbert%20Dvid%3A%26quot%3BMeh%26quot%3B%3F%20Sorry%2C%20I%20am%20not%20native%20English%20speaker.I%20know%20that.%20You%20didn%26%23039%3Bt%20need%20to%20explain.%20%3A%29I%20was%20just%20trying%20to%20simplify%20the%20code%20of%20Herb.%26%23091%3Bcode%26%23093%3Bauto%20pb%20%3D%20unique_ptr%26lt%3BBase%26gt%3B%7B%20make_un...","permalink":"https:\/\/herbsutter.com\/2013\/05\/22\/gotw-5-solution-overriding-virtual-functions\/#comment-10470","item_id":"_comm_10470"}; if ( typeof PDRTJS_RATING !== 'undefined' ){if ( typeof PDRTJS_468178_comm_10470 == 'undefined' ){PDRTJS_468178_comm_10470 = new PDRTJS_RATING( PDRTJS_settings_468178_comm_10470 );}}PDRTJS_settings_468178_comm_10435={"id":468178,"unique_id":"wp-comment-10435","title":"%40Fernando%20Pelliccioni%3AMeh.%20Just%20use%20the%20plain%20old%26%23091%3Bcode%26%23093%3Bstd%3A%3Aunique_ptr%26lt%3BBase%26gt%3B%20pb%20%3D%20std%3A%3Amake_unique%26lt%3BDerived%26gt%3B%28%29%3B%26%23091%3B%2Fcode%26%23093%3BIf%20you%20are%20using%20%26%23039%3Bauto%26%23039%3B%20for%20variables%20that%20have%20the%20same%20type%20as%20t...","permalink":"https:\/\/herbsutter.com\/2013\/05\/22\/gotw-5-solution-overriding-virtual-functions\/#comment-10435","item_id":"_comm_10435"}; if ( typeof PDRTJS_RATING !== 'undefined' ){if ( typeof PDRTJS_468178_comm_10435 == 'undefined' ){PDRTJS_468178_comm_10435 = new PDRTJS_RATING( PDRTJS_settings_468178_comm_10435 );}}PDRTJS_settings_468178_comm_10425={"id":468178,"unique_id":"wp-comment-10425","title":"%40GeoffW%20You%20may%20want%20to%20check%20this%20article%20http%3A%2F%2Fakrzemi1.wordpress.com%2F2012%2F09%2F30%2Fwhy-make-your-classes-final%2F%20and%20especially%20the%20discussion%20in%20the%20comments%20section.%40rhalbersma%20As%20jhasse%20pointe...","permalink":"https:\/\/herbsutter.com\/2013\/05\/22\/gotw-5-solution-overriding-virtual-functions\/#comment-10425","item_id":"_comm_10425"}; if ( typeof PDRTJS_RATING !== 'undefined' ){if ( typeof PDRTJS_468178_comm_10425 == 'undefined' ){PDRTJS_468178_comm_10425 = new PDRTJS_RATING( PDRTJS_settings_468178_comm_10425 );}}PDRTJS_settings_468178_comm_10414={"id":468178,"unique_id":"wp-comment-10414","title":"Hi%20Herb%2CI%20think%26%23091%3Bcode%26%23093%3Bauto%20pb%20%3D%20std%3A%3Aunique_ptr%26lt%3BBase%26gt%3B%7B%20std%3A%3Amake_unique%26lt%3BDerived%26gt%3B%28%29%20%7D%3B%26%23091%3B%2Fcode%26%23093%3Bis%20too%20verbose.%20Unique%20is%20repeated...How%20about%20this%20library%20solution%20for%20C%2B%2B14%20or%20C%2B%2B17%20%3F%26%23091%3Bco...","permalink":"https:\/\/herbsutter.com\/2013\/05\/22\/gotw-5-solution-overriding-virtual-functions\/#comment-10414","item_id":"_comm_10414"}; if ( typeof PDRTJS_RATING !== 'undefined' ){if ( typeof PDRTJS_468178_comm_10414 == 'undefined' ){PDRTJS_468178_comm_10414 = new PDRTJS_RATING( PDRTJS_settings_468178_comm_10414 );}}PDRTJS_settings_468178_comm_10406={"id":468178,"unique_id":"wp-comment-10406","title":"%40Michael%20Urman%3A%20can%20you%20give%20a%20code%20example%20on%20how%20this%20scoped%20guard%20variable%20would%20occur%3F...","permalink":"https:\/\/herbsutter.com\/2013\/05\/22\/gotw-5-solution-overriding-virtual-functions\/#comment-10406","item_id":"_comm_10406"}; if ( typeof PDRTJS_RATING !== 'undefined' ){if ( typeof PDRTJS_468178_comm_10406 == 'undefined' ){PDRTJS_468178_comm_10406 = new PDRTJS_RATING( PDRTJS_settings_468178_comm_10406 );}}PDRTJS_settings_468178_comm_10403={"id":468178,"unique_id":"wp-comment-10403","title":"%40Herb%3A%20%20%26quot%3BNo%2C%20you%20still%20need%20a%20tag%26quot%3BI%20wonder%2C%20though%2C%20if%20there%20might%20be%20some%20specific%20contexts%20in%20which%20the%20%26%23039%3Bauto%26%23039%3B%20could%20be%20inferred%20if%20omitted%2C%20because%20you%20already%20know%20it%26%23039%3Bs%20a%20declaration.%20%20For%20ex...","permalink":"https:\/\/herbsutter.com\/2013\/05\/22\/gotw-5-solution-overriding-virtual-functions\/#comment-10403","item_id":"_comm_10403"}; if ( typeof PDRTJS_RATING !== 'undefined' ){if ( typeof PDRTJS_468178_comm_10403 == 'undefined' ){PDRTJS_468178_comm_10403 = new PDRTJS_RATING( PDRTJS_settings_468178_comm_10403 );}}PDRTJS_settings_468178_comm_10400={"id":468178,"unique_id":"wp-comment-10400","title":"%40rhalsbersma%20how%20would%20you%20differentiate%20between%20an%20unreferenced%20variable%20whose%20implicit%20declaration%20was%20due%20to%20a%20typo%20and%20an%20unreferenced%20variable%20whose%20lack%20of%20later%20reference%20is%20due%20to%20it%20bein...","permalink":"https:\/\/herbsutter.com\/2013\/05\/22\/gotw-5-solution-overriding-virtual-functions\/#comment-10400","item_id":"_comm_10400"}; if ( typeof PDRTJS_RATING !== 'undefined' ){if ( typeof PDRTJS_468178_comm_10400 == 'undefined' ){PDRTJS_468178_comm_10400 = new PDRTJS_RATING( PDRTJS_settings_468178_comm_10400 );}}PDRTJS_settings_468178_comm_10397={"id":468178,"unique_id":"wp-comment-10397","title":"Herb%2C%20In%20the%20guideline%3AGuideline%3A%20Prefer%20to%20have%20a%20class%20contain%20only%20public%20virtual%20functions%2C%20or%20no%20public%20virtual%20functions%20%28other%20than%20the%20destructor%20which%20is%20special%29.It%20is%20unclear%20that%20prot...","permalink":"https:\/\/herbsutter.com\/2013\/05\/22\/gotw-5-solution-overriding-virtual-functions\/#comment-10397","item_id":"_comm_10397"}; if ( typeof PDRTJS_RATING !== 'undefined' ){if ( typeof PDRTJS_468178_comm_10397 == 'undefined' ){PDRTJS_468178_comm_10397 = new PDRTJS_RATING( PDRTJS_settings_468178_comm_10397 );}}PDRTJS_settings_468178_comm_10390={"id":468178,"unique_id":"wp-comment-10390","title":"%40Alok%20I%20tend%20to%20agree%20with%20you%20that%20c%2B%2B%20can%20be%20extremely%20hard%20to%20understand%20and%20to%20program%20correctly%20and%20as%20expected%20without%20a%20very%20sizeable%20time%20investment.%20I%20also%20wonder%20how%20and%20if%20it%20could%20be%20...","permalink":"https:\/\/herbsutter.com\/2013\/05\/22\/gotw-5-solution-overriding-virtual-functions\/#comment-10390","item_id":"_comm_10390"}; if ( typeof PDRTJS_RATING !== 'undefined' ){if ( typeof PDRTJS_468178_comm_10390 == 'undefined' ){PDRTJS_468178_comm_10390 = new PDRTJS_RATING( PDRTJS_settings_468178_comm_10390 );}}PDRTJS_settings_468178_comm_10389={"id":468178,"unique_id":"wp-comment-10389","title":"C%2B%2B%20really%20needs%20fixing.While%20it%20makes%20sense%20to%20use%20things%20from%20the%20standard%20library%20when%20it%20provides%20one%2C%20the%20amount%20of%20thought%20process%20that%20needs%20to%20go%20into%20C%2B%2B%20programming%20%28whether%20writing%20C%2B%2B...","permalink":"https:\/\/herbsutter.com\/2013\/05\/22\/gotw-5-solution-overriding-virtual-functions\/#comment-10389","item_id":"_comm_10389"}; if ( typeof PDRTJS_RATING !== 'undefined' ){if ( typeof PDRTJS_468178_comm_10389 == 'undefined' ){PDRTJS_468178_comm_10389 = new PDRTJS_RATING( PDRTJS_settings_468178_comm_10389 );}}PDRTJS_settings_468178_comm_10381={"id":468178,"unique_id":"wp-comment-10381","title":"%40rhalbersmaauto%20would%20make%20a%20difference%20since%20you%20wouldnt%20write%20it%20before%20assignments.Also%20what%20about%20shadowing%20a%20variable%3F...","permalink":"https:\/\/herbsutter.com\/2013\/05\/22\/gotw-5-solution-overriding-virtual-functions\/#comment-10381","item_id":"_comm_10381"}; if ( typeof PDRTJS_RATING !== 'undefined' ){if ( typeof PDRTJS_468178_comm_10381 == 'undefined' ){PDRTJS_468178_comm_10381 = new PDRTJS_RATING( PDRTJS_settings_468178_comm_10381 );}}PDRTJS_settings_468178_comm_10375={"id":468178,"unique_id":"wp-comment-10375","title":"%40Herb%3A%20I%26%23039%3Bm%20not%20really%20convinced%20by%20the%20off-by-one%20keyboard%20error.%20If%20you%20never%20reuse%20that%20variable%20z%20again%2C%20the%20compiler%20would%20warn%20%28and%20give%20an%20error%20with%20warnings-as-errors%29%20about%20an%20unused%20var...","permalink":"https:\/\/herbsutter.com\/2013\/05\/22\/gotw-5-solution-overriding-virtual-functions\/#comment-10375","item_id":"_comm_10375"}; if ( typeof PDRTJS_RATING !== 'undefined' ){if ( typeof PDRTJS_468178_comm_10375 == 'undefined' ){PDRTJS_468178_comm_10375 = new PDRTJS_RATING( PDRTJS_settings_468178_comm_10375 );}}PDRTJS_settings_468178_comm_10374={"id":468178,"unique_id":"wp-comment-10374","title":"%40rhalbersma%3A%20No%2C%20you%20still%20need%20a%20tag%2C%20just%20as%20Pascal%20uses%20%26quot%3Bvar%26quot%3B%20and%20other%20languages%20use%20other%20tags.%20Otherwise%2C%20it%26%23039%3Bs%20ambiguous%20or%20worse.%20For%20example%2C%20if%20%26quot%3Bx%20%3D%20y%3B%26quot%3B%20could%20be%20a%20variable%20declaration%2C%20...","permalink":"https:\/\/herbsutter.com\/2013\/05\/22\/gotw-5-solution-overriding-virtual-functions\/#comment-10374","item_id":"_comm_10374"}; if ( typeof PDRTJS_RATING !== 'undefined' ){if ( typeof PDRTJS_468178_comm_10374 == 'undefined' ){PDRTJS_468178_comm_10374 = new PDRTJS_RATING( PDRTJS_settings_468178_comm_10374 );}}PDRTJS_settings_468178_comm_10373={"id":468178,"unique_id":"wp-comment-10373","title":"%40Herb%20If%20%2A%2Aevery%2A%2A%20initialization%20is%20written%20in%20the%20form%20%26%23091%3Bcode%26%23093%3Bauto%20x%20%3D%20Type%20%7B%20expr%20%7D%3B%20%26%23091%3B%2Fcode%26%23093%3B%2C%20isn%26%23039%3Bt%20that%20the%20same%20as%20saying%20that%20the%20auto%20keyword%20itself%20could%20be%20left%20out%20altogether%3F%20What%20parsi...","permalink":"https:\/\/herbsutter.com\/2013\/05\/22\/gotw-5-solution-overriding-virtual-functions\/#comment-10373","item_id":"_comm_10373"}; if ( typeof PDRTJS_RATING !== 'undefined' ){if ( typeof PDRTJS_468178_comm_10373 == 'undefined' ){PDRTJS_468178_comm_10373 = new PDRTJS_RATING( PDRTJS_settings_468178_comm_10373 );}}PDRTJS_settings_468178_comm_10367={"id":468178,"unique_id":"wp-comment-10367","title":"Yuck%21%20That%20looks%20messed%20up%2C%20seems%20I%26%23039%3Bm%20too%20used%20to%20SO.%20Are%20there%20in-line%20code%20tags%20for%20comments%20like%20in%20the%20blog%20post%20itself%3F...","permalink":"https:\/\/herbsutter.com\/2013\/05\/22\/gotw-5-solution-overriding-virtual-functions\/#comment-10367","item_id":"_comm_10367"}; if ( typeof PDRTJS_RATING !== 'undefined' ){if ( typeof PDRTJS_468178_comm_10367 == 'undefined' ){PDRTJS_468178_comm_10367 = new PDRTJS_RATING( PDRTJS_settings_468178_comm_10367 );}}PDRTJS_settings_468178_comm_10366={"id":468178,"unique_id":"wp-comment-10366","title":"On%20the%20%26%23091%3Bcode%26%23093%3Bpb-%26gt%3Bf%281.0%29%3B%26%23091%3B%2Fcode%26%23093%3B%20you%20stress%20that%20overload%20resolution%20is%20done%20on%20the%20static%20type.%20I%20think%20the%20more%20surprising%20part%20for%20at%20least%20some%20people%20will%20be%20that%20having%20declared%20%26%23091%3Bcode%26%23093%3Bf%26%23091%3B%2F...","permalink":"https:\/\/herbsutter.com\/2013\/05\/22\/gotw-5-solution-overriding-virtual-functions\/#comment-10366","item_id":"_comm_10366"}; if ( typeof PDRTJS_RATING !== 'undefined' ){if ( typeof PDRTJS_468178_comm_10366 == 'undefined' ){PDRTJS_468178_comm_10366 = new PDRTJS_RATING( PDRTJS_settings_468178_comm_10366 );}}PDRTJS_settings_468178_comm_10361={"id":468178,"unique_id":"wp-comment-10361","title":"%40Simon%2C%20%40Arthur%2C%20and%20%40Herb%3A%20You%20are%20all%20correct%20that%20I%20missed%20the%20slight%20change%20in%20semantics.For%20the%20learning%20purposes%2C%20then%2C%20I%20like%20Herb%26%23039%3Bs%20modified%20line%2C%20because%20it%20is%20more%20explicit%20about%20what%20i...","permalink":"https:\/\/herbsutter.com\/2013\/05\/22\/gotw-5-solution-overriding-virtual-functions\/#comment-10361","item_id":"_comm_10361"}; if ( typeof PDRTJS_RATING !== 'undefined' ){if ( typeof PDRTJS_468178_comm_10361 == 'undefined' ){PDRTJS_468178_comm_10361 = new PDRTJS_RATING( PDRTJS_settings_468178_comm_10361 );}}PDRTJS_settings_468178_comm_10359={"id":468178,"unique_id":"wp-comment-10359","title":"%26%23091%3Bcode%26%23093%3BGuideline%3A%20Avoid%20default%20arguments%20on%20virtual%20functions%20in%20general.%26%23091%3B%2Fcode%26%23093%3BThis%20needs%20to%20be%20more%20than%20just%20a%20guideline.%20%20It%20needs%20to%20be%20a%20_rule_.%20%20It%26%23039%3Bs%20just%20never%20a%20good%20idea.%20%20This%20is%20why%20f...","permalink":"https:\/\/herbsutter.com\/2013\/05\/22\/gotw-5-solution-overriding-virtual-functions\/#comment-10359","item_id":"_comm_10359"}; if ( typeof PDRTJS_RATING !== 'undefined' ){if ( typeof PDRTJS_468178_comm_10359 == 'undefined' ){PDRTJS_468178_comm_10359 = new PDRTJS_RATING( PDRTJS_settings_468178_comm_10359 );}}PDRTJS_settings_468178_comm_10358={"id":468178,"unique_id":"wp-comment-10358","title":"%40GeoffW%3A%20Re%20uses%20of%20final%20are%20rarer%20%20well%2C%20they%20sort%20of%20are.%20I%20dont%20know%20of%20many%2C%20and%20during%20standardization%20Bjarne%20repeatedly%20asked%20for%20examples%20of%20problems%20it%20solved%20and%20patterns%20where%20it%20shoul...","permalink":"https:\/\/herbsutter.com\/2013\/05\/22\/gotw-5-solution-overriding-virtual-functions\/#comment-10358","item_id":"_comm_10358"}; if ( typeof PDRTJS_RATING !== 'undefined' ){if ( typeof PDRTJS_468178_comm_10358 == 'undefined' ){PDRTJS_468178_comm_10358 = new PDRTJS_RATING( PDRTJS_settings_468178_comm_10358 );}}PDRTJS_settings_468178_comm_10352={"id":468178,"unique_id":"wp-comment-10352","title":"I%20vote%20for%20%26%23091%3Bcode%26%23093%3Bauto%20pb%20%3D%20unique_ptr%26lt%3Bbase%26gt%3B%7B%20make_unique%26lt%3Bderived%26gt%3B%28%29%20%7D%3B%26%23091%3B%2Fcode%26%23093%3BI%20also%20like%20the%20improvement%20in%20both%20being%20conformed%20to%20the%20style%20of%20using%20auto%20as%20much%20as%20possible%20and%20see...","permalink":"https:\/\/herbsutter.com\/2013\/05\/22\/gotw-5-solution-overriding-virtual-functions\/#comment-10352","item_id":"_comm_10352"}; if ( typeof PDRTJS_RATING !== 'undefined' ){if ( typeof PDRTJS_468178_comm_10352 == 'undefined' ){PDRTJS_468178_comm_10352 = new PDRTJS_RATING( PDRTJS_settings_468178_comm_10352 );}}PDRTJS_settings_468178_comm_10350={"id":468178,"unique_id":"wp-comment-10350","title":"%26%23091%3B%26%238230%3B%26%23093%3B%20I%20was%20playing%20with%20C%23%20to%20see%20if%20it%20matched%20C%2B%2B%20behavior%20from%20this%20post%3A%20http%3A%2F%2Fherbsutter.com%2F2013%2F05%2F22%2Fgotw-5-solution-overriding-virtual-functions%2F%20when%20I%20came%20across%20this%20very%20stran...","permalink":"https:\/\/herbsutter.com\/2013\/05\/22\/gotw-5-solution-overriding-virtual-functions\/#comment-10350","item_id":"_comm_10350"}; if ( typeof PDRTJS_RATING !== 'undefined' ){if ( typeof PDRTJS_468178_comm_10350 == 'undefined' ){PDRTJS_468178_comm_10350 = new PDRTJS_RATING( PDRTJS_settings_468178_comm_10350 );}}PDRTJS_settings_468178_comm_10340={"id":468178,"unique_id":"wp-comment-10340","title":"I%20don%26%23039%3Bt%20mean%20to%20be%20picky%20%28well%2C%20maybe%20I%20do%29%2C%20but%20is%20%26quot%3Buses%20for%20final%20are%20rarer%26quot%3B%20the%20most%20that%20can%20be%20said%20for%20%26quot%3Bfinal%26quot%3B%3F%20%20On%20seeing%20the%20original%20JG%20question%20I%20had%20sort%20of%20hoped%20for%20more%20%28the%20questio...","permalink":"https:\/\/herbsutter.com\/2013\/05\/22\/gotw-5-solution-overriding-virtual-functions\/#comment-10340","item_id":"_comm_10340"}; if ( typeof PDRTJS_RATING !== 'undefined' ){if ( typeof PDRTJS_468178_comm_10340 == 'undefined' ){PDRTJS_468178_comm_10340 = new PDRTJS_RATING( PDRTJS_settings_468178_comm_10340 );}}PDRTJS_settings_468178_comm_10339={"id":468178,"unique_id":"wp-comment-10339","title":"Yeah%20it%20was%20mentioned%20in%20an%20earlier%20post%20that%20C%2B%2B14%20would%20be%20targeted....","permalink":"https:\/\/herbsutter.com\/2013\/05\/22\/gotw-5-solution-overriding-virtual-functions\/#comment-10339","item_id":"_comm_10339"}; if ( typeof PDRTJS_RATING !== 'undefined' ){if ( typeof PDRTJS_468178_comm_10339 == 'undefined' ){PDRTJS_468178_comm_10339 = new PDRTJS_RATING( PDRTJS_settings_468178_comm_10339 );}}PDRTJS_settings_468178_comm_10338={"id":468178,"unique_id":"wp-comment-10338","title":"make_unique%3A%20are%20we%20using%20C%2B%2B1y%20here%3F...","permalink":"https:\/\/herbsutter.com\/2013\/05\/22\/gotw-5-solution-overriding-virtual-functions\/#comment-10338","item_id":"_comm_10338"}; if ( typeof PDRTJS_RATING !== 'undefined' ){if ( typeof PDRTJS_468178_comm_10338 == 'undefined' ){PDRTJS_468178_comm_10338 = new PDRTJS_RATING( PDRTJS_settings_468178_comm_10338 );}}PDRTJS_settings_468178_comm_10336={"id":468178,"unique_id":"wp-comment-10336","title":"Clarification%3A%20Where%20did%20make_unique%20come%20from%3F%20C%2B%2B1y%3F...","permalink":"https:\/\/herbsutter.com\/2013\/05\/22\/gotw-5-solution-overriding-virtual-functions\/#comment-10336","item_id":"_comm_10336"}; if ( typeof PDRTJS_RATING !== 'undefined' ){if ( typeof PDRTJS_468178_comm_10336 == 'undefined' ){PDRTJS_468178_comm_10336 = new PDRTJS_RATING( PDRTJS_settings_468178_comm_10336 );}}PDRTJS_settings_468178_comm_10335={"id":468178,"unique_id":"wp-comment-10335","title":"When%20you%20are%20using%20NVI%20for%20a%20base%20class%20A%20with%20a%20function%20foo%28%29%2C%20and%20a%20sub%20class%20B%20wants%20to%20call%20foo%28%29%20on%20itself%2C%20does%20B%20call%20the%20public%20or%20private%20version%20of%20foo%28%29%3F%20It%20seems%20to%20me%20that%20the%20answe...","permalink":"https:\/\/herbsutter.com\/2013\/05\/22\/gotw-5-solution-overriding-virtual-functions\/#comment-10335","item_id":"_comm_10335"}; if ( typeof PDRTJS_RATING !== 'undefined' ){if ( typeof PDRTJS_468178_comm_10335 == 'undefined' ){PDRTJS_468178_comm_10335 = new PDRTJS_RATING( PDRTJS_settings_468178_comm_10335 );}}PDRTJS_settings_468178_comm_10332={"id":468178,"unique_id":"wp-comment-10332","title":"Yep%2C%20at%20least%20three%20times%20I%20had%20to%20stop%20myself%20from%20%26quot%3Bfixing%26quot%3B%20that%20line%20to%20say%20%26%23091%3Bcode%26%23093%3Bauto%20pb%20%3D%20make_unique%26lt%3Bderived%26gt%3B%28%29%3B%26%23091%3B%2Fcode%26%23093%3B%20which%20would%20actually%20have%20resolved%20a%20few%20problems%20%28or%20at%20least%20c...","permalink":"https:\/\/herbsutter.com\/2013\/05\/22\/gotw-5-solution-overriding-virtual-functions\/#comment-10332","item_id":"_comm_10332"}; if ( typeof PDRTJS_RATING !== 'undefined' ){if ( typeof PDRTJS_468178_comm_10332 == 'undefined' ){PDRTJS_468178_comm_10332 = new PDRTJS_RATING( PDRTJS_settings_468178_comm_10332 );}}PDRTJS_settings_468178_comm_10330={"id":468178,"unique_id":"wp-comment-10330","title":"%40KrzaQ%3A%20Yup%2C%20%3A%20should%20be%20%3A%3A%20--%20fixed%2C%20thanks.%40mttpd%3A%20Yup%2C%20fixed.%20The%20original%20GotW%20had%20%26quot%3Bvoid%20main%28%29%26quot%3B%20and%20made%20a%20pedantic%20point%20about%20its%20conformance%2C%20and%20I%20decided%20it%20was%20a%20distraction%20and%20remove...","permalink":"https:\/\/herbsutter.com\/2013\/05\/22\/gotw-5-solution-overriding-virtual-functions\/#comment-10330","item_id":"_comm_10330"}; if ( typeof PDRTJS_RATING !== 'undefined' ){if ( typeof PDRTJS_468178_comm_10330 == 'undefined' ){PDRTJS_468178_comm_10330 = new PDRTJS_RATING( PDRTJS_settings_468178_comm_10330 );}}PDRTJS_settings_468178_comm_10328={"id":468178,"unique_id":"wp-comment-10328","title":"%26%23091%3Bcode%26%23093%3Bvoid%20main%28%29%26%23091%3B%2Fcode%26%23093%3B%20--%20ouch%21%20I%20don%26%23039%3Bt%20think%20this%20was%20really%20intended%20here%21%20%3B-%29...","permalink":"https:\/\/herbsutter.com\/2013\/05\/22\/gotw-5-solution-overriding-virtual-functions\/#comment-10328","item_id":"_comm_10328"}; if ( typeof PDRTJS_RATING !== 'undefined' ){if ( typeof PDRTJS_468178_comm_10328 == 'undefined' ){PDRTJS_468178_comm_10328 = new PDRTJS_RATING( PDRTJS_settings_468178_comm_10328 );}}PDRTJS_settings_468178_comm_10325={"id":468178,"unique_id":"wp-comment-10325","title":"%40Caleb%2C%20he%26%23039%3Bs%20explicit%20here%20as%20make_unique%20would%20return%20a%20unique_ptr%20to%20derived%2C%20not%20to%20base%2C%20which%20is%20what%20he%20wants%20here%20and%20which%20is%20the%20equivalent%20of%20the%20original%20code....","permalink":"https:\/\/herbsutter.com\/2013\/05\/22\/gotw-5-solution-overriding-virtual-functions\/#comment-10325","item_id":"_comm_10325"}; if ( typeof PDRTJS_RATING !== 'undefined' ){if ( typeof PDRTJS_468178_comm_10325 == 'undefined' ){PDRTJS_468178_comm_10325 = new PDRTJS_RATING( PDRTJS_settings_468178_comm_10325 );}}PDRTJS_settings_468178_comm_10323={"id":468178,"unique_id":"wp-comment-10323","title":"I%26%23039%3Bm%20pretty%20sure%20that%20%26%23091%3Bcode%26%23093%3Bbase%3Af%3B%26%23091%3B%2Fcode%26%23093%3B%20should%20be%20%26%23091%3Bcode%26%23093%3Bbase%3A%3Af%3B%26%23091%3B%2Fcode%26%23093%3B%20in%20%26quot%3BWell%2C%20remember%20that%20derived%20doesnt%20declare%20using%20base%3Af%3B%20to%20bring%20the%20base%20functions%20named%20f%20into%20scope%26quot%3B.%20I%26%23039%3Bm%20sorry%20i...","permalink":"https:\/\/herbsutter.com\/2013\/05\/22\/gotw-5-solution-overriding-virtual-functions\/#comment-10323","item_id":"_comm_10323"}; if ( typeof PDRTJS_RATING !== 'undefined' ){if ( typeof PDRTJS_468178_comm_10323 == 'undefined' ){PDRTJS_468178_comm_10323 = new PDRTJS_RATING( PDRTJS_settings_468178_comm_10323 );}}PDRTJS_settings_468178_comm_10319={"id":468178,"unique_id":"wp-comment-10319","title":"Apologies%2C%20that%20was%20meant%20to%20read%20that%20on%20the%20second%20line%20pb%26%23039%3Bs%20type%20will%20be%26%23091%3Bcode%26%23093%3Bunique_ptr%26lt%3Bderived%26gt%3B%26%23091%3B%2Fcode%26%23093%3B...","permalink":"https:\/\/herbsutter.com\/2013\/05\/22\/gotw-5-solution-overriding-virtual-functions\/#comment-10319","item_id":"_comm_10319"}; if ( typeof PDRTJS_RATING !== 'undefined' ){if ( typeof PDRTJS_468178_comm_10319 == 'undefined' ){PDRTJS_468178_comm_10319 = new PDRTJS_RATING( PDRTJS_settings_468178_comm_10319 );}}PDRTJS_settings_468178_comm_10318={"id":468178,"unique_id":"wp-comment-10318","title":"Caleb%2C%20in%20your%20two%20lines%20the%20type%20of%20pb%20will%20be%20different.%20in%20the%20second%20line%20it%20will%20be%20a%20unique_ptr.%20If%20that%26%23039%3Bs%20what%20you%20want%2C%20fine%2C%20but%20it%26%23039%3Bs%20not%20the%20same%20as%20the%20first%20line%2C%20which%20includes%20an%20im...","permalink":"https:\/\/herbsutter.com\/2013\/05\/22\/gotw-5-solution-overriding-virtual-functions\/#comment-10318","item_id":"_comm_10318"}; if ( typeof PDRTJS_RATING !== 'undefined' ){if ( typeof PDRTJS_468178_comm_10318 == 'undefined' ){PDRTJS_468178_comm_10318 = new PDRTJS_RATING( PDRTJS_settings_468178_comm_10318 );}}PDRTJS_settings_468178_comm_10317={"id":468178,"unique_id":"wp-comment-10317","title":"Surely%20given%20your%20previous%20comments%20%28and%20my%20own%20lazy%20inclinations%29%2C%20this%20line%3A%26%23091%3Bcode%26%23093%3B%20unique_ptr%26lt%3Bbase%26gt%3B%20pb%20%3D%20make_unique%26lt%3Bderived%26gt%3B%28%29%3B%26%23091%3B%2Fcode%26%23093%3Bcould%20become%3A%26%23091%3Bcode%26%23093%3B%20auto%20pb%20%3D%20make_unique%26lt%3Bd...","permalink":"https:\/\/herbsutter.com\/2013\/05\/22\/gotw-5-solution-overriding-virtual-functions\/#comment-10317","item_id":"_comm_10317"}; if ( typeof PDRTJS_RATING !== 'undefined' ){if ( typeof PDRTJS_468178_comm_10317 == 'undefined' ){PDRTJS_468178_comm_10317 = new PDRTJS_RATING( PDRTJS_settings_468178_comm_10317 );}}
//--><!]]></script><script type='text/javascript' charset='UTF-8' src='https://polldaddy.com/js/rating/rating.js'></script><script type='text/javascript' src='https://platform.twitter.com/widgets.js?ver=20111117'></script>
<script type='text/javascript' src='https://s1.wp.com/_static/??-eJzTLy/QTc7PK0nNK9EvyClNz8wr1i+uzCtJrMjITM/IAeKS1CJMEWP94uSizIISoOIM5/yiVL2sYh19yo1yKiotzgjISczMAxpon2traGJkZGxiZGhskgUAFHlAaw=='></script>
<script type='text/javascript'>
	(function(){
		var corecss = document.createElement('link');
		var themecss = document.createElement('link');
		var corecssurl = "https://s1.wp.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shCore.css?ver=3.0.9b";
		if ( corecss.setAttribute ) {
				corecss.setAttribute( "rel", "stylesheet" );
				corecss.setAttribute( "type", "text/css" );
				corecss.setAttribute( "href", corecssurl );
		} else {
				corecss.rel = "stylesheet";
				corecss.href = corecssurl;
		}
		document.getElementsByTagName("head")[0].insertBefore( corecss, document.getElementById("syntaxhighlighteranchor") );
		var themecssurl = "https://s2.wp.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shThemeDefault.css?m=1363304414h&amp;ver=3.0.9b";
		if ( themecss.setAttribute ) {
				themecss.setAttribute( "rel", "stylesheet" );
				themecss.setAttribute( "type", "text/css" );
				themecss.setAttribute( "href", themecssurl );
		} else {
				themecss.rel = "stylesheet";
				themecss.href = themecssurl;
		}
		//document.getElementById("syntaxhighlighteranchor").appendChild(themecss);
		document.getElementsByTagName("head")[0].insertBefore( themecss, document.getElementById("syntaxhighlighteranchor") );
	})();
	SyntaxHighlighter.config.strings.expandSource = '+ expand source';
	SyntaxHighlighter.config.strings.help = '?';
	SyntaxHighlighter.config.strings.alert = 'SyntaxHighlighter\n\n';
	SyntaxHighlighter.config.strings.noBrush = 'Can\'t find brush for: ';
	SyntaxHighlighter.config.strings.brushNotHtmlScript = 'Brush wasn\'t configured for html-script option: ';
	SyntaxHighlighter.defaults['pad-line-numbers'] = false;
	SyntaxHighlighter.defaults['toolbar'] = false;
	SyntaxHighlighter.all();

	// Infinite scroll support
	if ( typeof( jQuery ) !== 'undefined' ) {
		jQuery( function( $ ) {
			$( document.body ).on( 'post-load', function() {
				SyntaxHighlighter.highlight();
			} );
		} );
	}
</script>
<script type='text/javascript'>
/* <![CDATA[ */
var actionbardata = {"siteID":"3379246","siteName":"Sutter\u2019s Mill","siteURL":"https:\/\/herbsutter.com","icon":"<img alt='' src='https:\/\/secure.gravatar.com\/blavatar\/4554b8d24c7f200dc5e2e1b18db1893f?s=50&d=https%3A%2F%2Fs2.wp.com%2Fi%2Flogo%2Fwpcom-gray-white.png' class='avatar avatar-50' height='50' width='50' \/>","canManageOptions":"","canCustomizeSite":"","isFollowing":"","themeSlug":"pub\/mistylook","signupURL":"https:\/\/wordpress.com\/start\/","loginURL":"https:\/\/herbsutter.wordpress.com\/wp-login.php?redirect_to=https%3A%2F%2Fherbsutter.com%2F2013%2F05%2F22%2Fgotw-5-solution-overriding-virtual-functions%2F","themeURL":"","xhrURL":"https:\/\/herbsutter.com\/wp-admin\/admin-ajax.php","nonce":"8fb9818ae2","isSingular":"1","isFolded":"","isLoggedIn":"","isMobile":"","subscribeNonce":"<input type=\"hidden\" id=\"_wpnonce\" name=\"_wpnonce\" value=\"4590924cc6\" \/>","referer":"https:\/\/herbsutter.com\/2013\/05\/22\/gotw-5-solution-overriding-virtual-functions\/","canFollow":"1","feedID":"171936","statusMessage":"","customizeLink":"https:\/\/herbsutter.wordpress.com\/wp-admin\/customize.php?url=https%3A%2F%2Fherbsutter.wordpress.com%2F2013%2F05%2F22%2Fgotw-5-solution-overriding-virtual-functions%2F","postID":"1984","shortlink":"https:\/\/wp.me\/peb5Y-w0","canEditPost":"","editLink":"https:\/\/wordpress.com\/post\/herbsutter.com\/1984","statsLink":"https:\/\/wordpress.com\/stats\/post\/1984\/herbsutter.com","i18n":{"view":"View site","follow":"Follow","following":"Following","edit":"Edit","login":"Log in","signup":"Sign up","customize":"Customize","report":"Report this content","themeInfo":"Get theme: MistyLook","shortlink":"Copy shortlink","copied":"Copied","followedText":"New posts from this site will now appear in your <a href=\"https:\/\/wordpress.com\/\">Reader<\/a>","foldBar":"Collapse this bar","unfoldBar":"Expand this bar","editSubs":"Manage subscriptions","viewReader":"View site in Reader","viewReadPost":"View post in Reader","subscribe":"Sign me up","enterEmail":"Enter your email address","followers":"Join 19,532 other followers","alreadyUser":"Already have a WordPress.com account? <a href=\"https:\/\/herbsutter.wordpress.com\/wp-login.php?redirect_to=https%3A%2F%2Fherbsutter.com%2F2013%2F05%2F22%2Fgotw-5-solution-overriding-virtual-functions%2F\">Log in now.<\/a>","stats":"Stats"}};
/* ]]> */
</script>
<script type='text/javascript' src='https://s0.wp.com/_static/??-eJyVjcEOgjAQRH/IuoIYT8Zvqe2GLrQLdlvAv7ceJEYTEg+bTGbe7MA8KjNwQk7QCVicyOC47DvZwUcUshp9bokFPPUocM+Y0Wm2HuM3/CblwUkvjlrnyyWMv87GjraBWN10hKCloEWpYcIYyZb91fvzQ4ra9LJVMokGfpVWVehruFSnujo0x+Zcd0+y+3Rn'></script>
<script type="text/javascript">
// <![CDATA[
(function() {
try{
  if ( window.external &&'msIsSiteMode' in window.external) {
    if (window.external.msIsSiteMode()) {
      var jl = document.createElement('script');
      jl.type='text/javascript';
      jl.async=true;
      jl.src='/wp-content/plugins/ie-sitemode/custom-jumplist.php';
      var s = document.getElementsByTagName('script')[0];
      s.parentNode.insertBefore(jl, s);
    }
  }
}catch(e){}
})();
// ]]>
</script><script src="//stats.wp.com/w.js?56" type="text/javascript" async defer></script>
<script type="text/javascript">
_tkq = window._tkq || [];
_stq = window._stq || [];
_tkq.push(['storeContext', {'blog_id':'3379246','blog_tz':'-8','user_lang':'en','blog_lang':'en','user_id':'0'}]);
_stq.push(['view', {'blog':'3379246','v':'wpcom','tz':'-8','user_id':'0','post':'1984','subd':'herbsutter'}]);
_stq.push(['extra', {'crypt':'UE40eW5QN0p8M2Y/RE1TaVhzUzFMbjdWNHpwZGhTayxPSUFCMGNrd29+Smw0TDhnZmRTK0hlRi9QSGh6bi9GXVhBJWIlZlR5U1JMLU8/MkNtblkvY1d1TjBELytHc0k/MXdHUVQyK2IyUVA5SjU1bj9VX3ExLHYsREFpcnlfNHYtXV1HSUIsLkJrcnp0eS5sLk92UXNRelNyMk1TVz1+MUlmblhEPSs5UURXWWZSNFgzc0syWDVwb3ZTdTV6Y04uaU9JQkMvOCx3JTk0ZlR1OE16R2Y/dUZ2QUQ1N0F+MGRIX2QyT3loWHhTZ3xDS2o9cFI3SEZVVHdpdDZYSmE5dD9acmEzZFRTb0Y/TVVVTHFpXV9KQTZvaU9xak91W08udWpLdixfTmp0cm4saWdPVXF2T0RdMHg2UGU0OU51N0Y5MWZhdkpRVlV8UkRGNlVGRSZifjZ6fA=='}]);
_stq.push([ 'clickTrackerInit', '3379246', '1984' ]);
	</script>
<noscript><img src="https://pixel.wp.com/b.gif?v=noscript" style="height:0px;width:0px;overflow:hidden" alt="" /></noscript>
<script>
if ( 'object' === typeof wpcom_mobile_user_agent_info ) {

	wpcom_mobile_user_agent_info.init();
	var mobileStatsQueryString = "";
	
	if( false !== wpcom_mobile_user_agent_info.matchedPlatformName )
		mobileStatsQueryString += "&x_" + 'mobile_platforms' + '=' + wpcom_mobile_user_agent_info.matchedPlatformName;
	
	if( false !== wpcom_mobile_user_agent_info.matchedUserAgentName )
		mobileStatsQueryString += "&x_" + 'mobile_devices' + '=' + wpcom_mobile_user_agent_info.matchedUserAgentName;
	
	if( wpcom_mobile_user_agent_info.isIPad() )
		mobileStatsQueryString += "&x_" + 'ipad_views' + '=' + 'views';

	if( "" != mobileStatsQueryString ) {
		new Image().src = document.location.protocol + '//pixel.wp.com/g.gif?v=wpcom-no-pv' + mobileStatsQueryString + '&baba=' + Math.random();
	}
	
}
</script></body>
</html>