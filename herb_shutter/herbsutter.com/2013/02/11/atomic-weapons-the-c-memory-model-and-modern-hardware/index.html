<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
<head profile="http://gmpg.org/xfn/11">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>atomic Weapons: The C++ Memory Model and Modern Hardware | Sutter’s Mill</title>
<link rel="pingback" href="https://herbsutter.com/xmlrpc.php" />
<script type="text/javascript">
  WebFontConfig = {"typekit":{"id":"eyo0tqd"}};
  (function() {
    var wf = document.createElement('script');
    wf.src = 'https://s0.wp.com/wp-content/plugins/custom-fonts/js/webfont.js';
    wf.type = 'text/javascript';
    wf.async = 'true';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(wf, s);
	})();
</script><style id="jetpack-custom-fonts-css">.wf-active #header h1{font-size:2.12em;font-family:"ff-dagny-web-pro-1","ff-dagny-web-pro-2",sans-serif;font-style:normal;font-weight:400}.wf-active body{font-size:89.7%;font-family:"ff-basic-gothic-web-pro-1","ff-basic-gothic-web-pro-2",sans-serif}.wf-active #navigation{font-family:"ff-basic-gothic-web-pro-1","ff-basic-gothic-web-pro-2",sans-serif}.wf-active #navigation ul li.search{font-size:1.06em}.wf-active #navigation ul li.search input#searchsubmit{font-size:1.06em}.wf-active #content .post-info, .wf-active #content .postmetadata{font-size:1.06em}.wf-active #sidebar{font-size:1.06em}.wf-active #footer p.right{font-size:1.06em}.wf-active .commentnum{font-size:1.77em}.wf-active .commentlist li .cmtinfo{font-size:1.18em}.wf-active .commentlist li .cmtinfo em{font-size:1.06em}.wf-active #respond label{font-size:11.8px}.wf-active #respond .required{font-size:11.8px}.wf-active #respond .subscribe-label{font-size:14.2px}.wf-active #respond .comment-notes{font-size:13px}.wf-active .wp-caption p.wp-caption-text{font-size:13px}.wf-active #content h1, .wf-active h2, .wf-active h3, .wf-active h4, .wf-active h5, .wf-active h6{font-family:"ff-dagny-web-pro-1","ff-dagny-web-pro-2",sans-serif;font-style:normal;font-weight:400}.wf-active #header h2{font-size:1.18em;font-weight:400;font-family:"ff-dagny-web-pro-1","ff-dagny-web-pro-2",sans-serif;font-style:normal}.wf-active #content h3{font-size:1.65em;font-weight:400;font-style:normal}.wf-active #content h4{font-size:1.3em;font-style:normal;font-weight:400}.wf-active #content h5{font-size:1.18em;font-style:normal;font-weight:400}.wf-active #content .post h2{font-size:1.65em;font-weight:400;font-style:normal}.wf-active li.sidebox h2{font-weight:400;font-size:1.89em;font-style:normal}.wf-active .post h4{font-size:1.18em;font-weight:400;font-family:"ff-dagny-web-pro-1","ff-dagny-web-pro-2",sans-serif;font-style:normal}.wf-active .post h4 em{font-style:normal;font-weight:400}</style>
		<script src='https://r-login.wordpress.com/remote-login.php?action=js&amp;host=herbsutter.com&amp;id=3379246&amp;t=1542965476&amp;back=https%3A%2F%2Fherbsutter.com%2F2013%2F02%2F11%2Fatomic-weapons-the-c-memory-model-and-modern-hardware%2F' type="text/javascript"></script>
		<script type="text/javascript">
		/* <![CDATA[ */
			if ( 'function' === typeof WPRemoteLogin ) {
				document.cookie = "wordpress_test_cookie=test; path=/";
				if ( document.cookie.match( /(;|^)\s*wordpress_test_cookie\=/ ) ) {
					WPRemoteLogin();
				}
			}
		/* ]]> */
		</script>
		<link rel='dns-prefetch' href='//s2.wp.com' />
<link rel='dns-prefetch' href='//s0.wp.com' />
<link rel='dns-prefetch' href='//s1.wp.com' />
<link rel='dns-prefetch' href='//herbsutter.wordpress.com' />
<link rel="alternate" type="application/rss+xml" title="Sutter’s Mill &raquo; Feed" href="https://herbsutter.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Sutter’s Mill &raquo; Comments Feed" href="https://herbsutter.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Sutter’s Mill &raquo; atomic Weapons: The C++ Memory Model and Modern&nbsp;Hardware Comments Feed" href="https://herbsutter.com/2013/02/11/atomic-weapons-the-c-memory-model-and-modern-hardware/feed/" />
	<script type="text/javascript">
		/* <![CDATA[ */
		function addLoadEvent(func) {
			var oldonload = window.onload;
			if (typeof window.onload != 'function') {
				window.onload = func;
			} else {
				window.onload = function () {
					oldonload();
					func();
				}
			}
		}
		/* ]]> */
	</script>
			<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s0.wp.com\/wp-content\/mu-plugins\/wpcom-smileys\/twemoji\/2\/72x72\/","ext":".png","svgUrl":"https:\/\/s0.wp.com\/wp-content\/mu-plugins\/wpcom-smileys\/twemoji\/2\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/s1.wp.com\/wp-includes\/js\/wp-emoji-release.min.js?m=1532082729h&ver=4.9.8"}};
			!function(a,b,c){function d(a,b){var c=String.fromCharCode;l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,a),0,0);var d=k.toDataURL();l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,b),0,0);var e=k.toDataURL();return d===e}function e(a){var b;if(!l||!l.fillText)return!1;switch(l.textBaseline="top",l.font="600 32px Arial",a){case"flag":return!(b=d([55356,56826,55356,56819],[55356,56826,8203,55356,56819]))&&(b=d([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]),!b);case"emoji":return b=d([55358,56760,9792,65039],[55358,56760,8203,9792,65039]),!b}return!1}function f(a){var c=b.createElement("script");c.src=a,c.defer=c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var g,h,i,j,k=b.createElement("canvas"),l=k.getContext&&k.getContext("2d");for(j=Array("flag","emoji"),c.supports={everything:!0,everythingExceptFlag:!0},i=0;i<j.length;i++)c.supports[j[i]]=e(j[i]),c.supports.everything=c.supports.everything&&c.supports[j[i]],"flag"!==j[i]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[j[i]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(h=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",h,!1),a.addEventListener("load",h,!1)):(a.attachEvent("onload",h),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),g=c.source||{},g.concatemoji?f(g.concatemoji):g.wpemoji&&g.twemoji&&(f(g.twemoji),f(g.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
	<link rel='stylesheet' id='all-css-0-1' href='https://s2.wp.com/_static/??-eJyNkN1uwjAMhV9onsUG69W0Z0laE0zzp8QR6tvjUlUCwSpuonOS81knxkuGPkWhKBgaZN8cx4qeR6p4JsmmH+HmPvtaP/B1nOORI8uEcqKgYG4WA1eZfErjFtinQnofspE5EWhgQ15nRNnCQv5ZqVmetORmv0vWNFibC9UKegZuAZayT9wKuabWUnEwt0Tb2A9ofbotxBZTJpx/SE8DXi3hn+h9Rx4cSUVJGXKqqt5GaurZeGCNPJoFZoxJlsdVbE11lEB/aYRTfDBw9IbLFlpI9+NUOtTUnZ2hv/C7O+y/uu9uf+jOV8Xg7sY=?cssminify=yes' type='text/css' media='all' />
<link rel='stylesheet' id='print-css-1-1' href='https://s2.wp.com/wp-content/mu-plugins/global-print/global-print.css?m=1465851035h&cssminify=yes' type='text/css' media='print' />
<link rel='stylesheet' id='all-css-2-1' href='https://s0.wp.com/_static/??/wp-content/mu-plugins/actionbar/actionbar.css,/wp-content/themes/h4/global.css?m=1516985148j&cssminify=yes' type='text/css' media='all' />
<script type='text/javascript' src='https://s0.wp.com/_static/??-eJyFztEKwjAMBdAfsquTiXsRv6XWOFKXtDbphn69HeiDMBQCgdzDJXZOBtmP5QJiQ517gfx4rybIxv4ChnDITqEh5A/2kRVYF0vxjCOYIpDdUG+16BpXXIqiBCIVraTfLyFPCPNfFkCT8zeTQfC5tJ7o2Hb9Yde3+24bXjRNW9I='></script>
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://herbsutter.wordpress.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://s1.wp.com/wp-includes/wlwmanifest.xml" /> 
<link rel='prev' title='Videos: Panel, and C++&nbsp;Concurrency' href='https://herbsutter.com/2013/01/15/videos-panel-and-c-concurrency/' />
<link rel='next' title='Words of wisdom: Bjarne&nbsp;Stroustrup' href='https://herbsutter.com/2013/03/14/words-of-wisdom-bjarne-stroustrup/' />
<meta name="generator" content="WordPress.com" />
<link rel="canonical" href="https://herbsutter.com/2013/02/11/atomic-weapons-the-c-memory-model-and-modern-hardware/" />
<link rel='shortlink' href='https://wp.me/peb5Y-sM' />
<link rel="alternate" type="application/json+oembed" href="https://public-api.wordpress.com/oembed/?format=json&amp;url=https%3A%2F%2Fherbsutter.com%2F2013%2F02%2F11%2Fatomic-weapons-the-c-memory-model-and-modern-hardware%2F&amp;for=wpcom-auto-discovery" /><link rel="alternate" type="application/xml+oembed" href="https://public-api.wordpress.com/oembed/?format=xml&amp;url=https%3A%2F%2Fherbsutter.com%2F2013%2F02%2F11%2Fatomic-weapons-the-c-memory-model-and-modern-hardware%2F&amp;for=wpcom-auto-discovery" />
<!-- Jetpack Open Graph Tags -->
<meta property="og:type" content="article" />
<meta property="og:title" content="atomic Weapons: The C++ Memory Model and Modern Hardware" />
<meta property="og:url" content="https://herbsutter.com/2013/02/11/atomic-weapons-the-c-memory-model-and-modern-hardware/" />
<meta property="og:description" content="[ETA: Updated OneDrive slides link] Most of the talks I gave at C++ and Beyond 2012 last summer are already online at Channel 9. Here are two more. This is a two-part talk that covers the C++ memor…" />
<meta property="article:published_time" content="2013-02-11T18:31:42+00:00" />
<meta property="article:modified_time" content="2016-10-06T21:36:52+00:00" />
<meta property="og:site_name" content="Sutter’s Mill" />
<meta property="og:image" content="https://herbsutter.files.wordpress.com/2013/02/021113_1851_atomicweapo1.png" />
<meta property="og:locale" content="en_US" />
<meta name="twitter:site" content="@wordpressdotcom" />
<meta name="twitter:text:title" content="atomic Weapons: The C++ Memory Model and Modern&nbsp;Hardware" />
<meta name="twitter:card" content="summary" />
<meta property="article:publisher" content="https://www.facebook.com/WordPresscom" />

<!-- End Jetpack Open Graph Tags -->
<link rel="shortcut icon" type="image/x-icon" href="https://secure.gravatar.com/blavatar/4554b8d24c7f200dc5e2e1b18db1893f?s=32" sizes="16x16" />
<link rel="icon" type="image/x-icon" href="https://secure.gravatar.com/blavatar/4554b8d24c7f200dc5e2e1b18db1893f?s=32" sizes="16x16" />
<link rel="apple-touch-icon-precomposed" href="https://secure.gravatar.com/blavatar/4554b8d24c7f200dc5e2e1b18db1893f?s=114" />
<link rel='openid.server' href='https://herbsutter.wordpress.com/?openidserver=1' />
<link rel='openid.delegate' href='https://herbsutter.wordpress.com/' />
<link rel="search" type="application/opensearchdescription+xml" href="https://herbsutter.com/osd.xml" title="Sutter’s Mill" />
<link rel="search" type="application/opensearchdescription+xml" href="https://s1.wp.com/opensearch.xml" title="WordPress.com" />
		<style id="wpcom-hotfix-masterbar-style">
			@media screen and (min-width: 783px) {
				#wpadminbar .quicklinks li#wp-admin-bar-my-account.with-avatar > a img {
					margin-top: 5px;
				}
			}
		</style>
		<script type="text/javascript" id="webfont-output">
  
  WebFontConfig = {"typekit":{"id":"cjs1oxc"}};
  (function() {
    var wf = document.createElement('script');
    wf.src = ('https:' == document.location.protocol ? 'https' : 'http') +
      '://ajax.googleapis.com/ajax/libs/webfont/1/webfont.js';
    wf.type = 'text/javascript';
    wf.async = 'true';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(wf, s);
	})();
</script><style type="text/css">
.widget_twitter li {
	word-wrap: break-word;
}
</style>
<meta name="application-name" content="Sutter’s Mill" /><meta name="msapplication-window" content="width=device-width;height=device-height" /><meta name="msapplication-tooltip" content="Herb Sutter on software development" /><meta name="msapplication-task" content="name=Subscribe;action-uri=https://herbsutter.com/feed/;icon-uri=https://secure.gravatar.com/blavatar/4554b8d24c7f200dc5e2e1b18db1893f?s=16" /><meta name="msapplication-task" content="name=Sign up for a free blog;action-uri=http://wordpress.com/signup/;icon-uri=https://s1.wp.com/i/favicon.ico" /><meta name="msapplication-task" content="name=WordPress.com Support;action-uri=http://support.wordpress.com/;icon-uri=https://s1.wp.com/i/favicon.ico" /><meta name="msapplication-task" content="name=WordPress.com Forums;action-uri=http://forums.wordpress.com/;icon-uri=https://s1.wp.com/i/favicon.ico" /><meta name="description" content="[ETA: Updated OneDrive slides link] Most of the talks I gave at C++ and Beyond 2012 last summer are already online at Channel 9. Here are two more. This is a two-part talk that covers the C++ memory model, how locks and atomics and fences interact and map to hardware, and more. Even though we&#039;re&hellip;" />
<style type="text/css">
			#header h1 a,
		#header h2 {
			color: #265E15 !important;
		}
				#headerimage {
			background: url('https://herbsutter.files.wordpress.com/2011/10/cropped-blog-header.jpg') no-repeat;
			height: 200px;
		}
	</style>
<link rel="amphtml" href="https://herbsutter.com/2013/02/11/atomic-weapons-the-c-memory-model-and-modern-hardware/amp/"><style type="text/css" id="syntaxhighlighteranchor"></style>
		<link rel="stylesheet" id="custom-css-css" type="text/css" href="https://s2.wp.com/?custom-css=1&#038;csblog=eb5Y&#038;cscache=6&#038;csrev=60" />
		</head>
<body id="section-index" class="post-template-default single single-post postid-1784 single-format-standard mp6 customizer-styles-applied highlander-enabled highlander-light">


<div id="navigation" class="clearfix">
		<div class="menu">
		<ul>
			<li ><a href="https://herbsutter.com/" title="Home">Home</a></li>
			<li class="page_item page-item-912"><a href="https://herbsutter.com/welcome-to-the-jungle/">Welcome to the&nbsp;Jungle</a></li>
<li class="page_item page-item-864 page_item_has_children"><a href="https://herbsutter.com/gotw/">GotW</a></li>
<li class="page_item page-item-761"><a href="https://herbsutter.com/elements-of-modern-c-style/">Elements of Modern C++&nbsp;Style</a></li>
<li class="page_item page-item-2 page_item_has_children"><a href="https://herbsutter.com/about/">About</a></li>
									<li class="search"><form method="get" id="searchform" action="https://herbsutter.com"><input type="text" class="textbox" value="" name="s" id="s" /><input type="submit" id="searchsubmit" value="Search" /></form></li>
					</ul>
	</div>
</div><!-- end id:navigation -->

<div id="container">

<div id="header">
<h1><a href="https://herbsutter.com/" title="Sutter’s Mill">Sutter’s Mill</a></h1>
<h2>Herb Sutter on software development</h2>
</div><!-- end id:header -->


	
		<div id="feedarea">
	<dl>
		<dt><strong>Feeds:</strong></dt>

			<dd><a href="https://herbsutter.com/feed/">Posts</a></dd>
	
			<dd><a href="https://herbsutter.com/comments/feed/">Comments</a></dd>
		</dl>
	</div><!-- end id:feedarea -->
	
	<div id="headerimage">
</div><!-- end id:headerimage -->

<div id="content">
<div id="content-main">

		
									<div class="postnav">
				<div class="alignleft">&laquo; <a href="https://herbsutter.com/2013/01/15/videos-panel-and-c-concurrency/" rel="prev">Videos: Panel, and C++&nbsp;Concurrency</a></div>
				<div class="alignright"><a href="https://herbsutter.com/2013/03/14/words-of-wisdom-bjarne-stroustrup/" rel="next">Words of wisdom: Bjarne&nbsp;Stroustrup</a> &raquo;</div>
			</div>
			
			<div class="post-1784 post type-post status-publish format-standard hentry category-c category-concurrency category-talks-events" id="post-1784">
				<div class="posttitle">
					<h2>atomic Weapons: The C++ Memory Model and Modern&nbsp;Hardware</h2>
					<p class="post-info">2013-02-11 by <a href="https://herbsutter.com/author/herbsutter/" title="Posts by Herb Sutter">Herb Sutter</a>  </p>
				</div>

				<div class="entry">
					<p>[ETA: Updated OneDrive <a href="https://1drv.ms/b/s!Aq0V7yDPsIZOgcI0y2P8R-VifbnTtw">slides link</a>]</p>
<p><img src="https://herbsutter.files.wordpress.com/2013/02/021113_1851_atomicweapo1.png?w=500" alt="" align="right" />Most of the talks I gave at <a href="http://cppandbeyond.com"><em>C++ and Beyond 2012</em></a> last summer are already online at Channel 9. Here are two more.</p>
<p>This is a two-part talk that covers the C++ memory model, how locks and atomics and fences interact and map to hardware, and more. Even though we&#8217;re talking about C++, much of this is also applicable to Java and .NET which have similar memory models, but not all the features of C++ (such as relaxed atomics).</p>
<p>Note: This is about the basic structure and tools, not how to write lock-free algorithms using atomics. That next-level topic may be on deck for this year&#8217;s <a href="http://cppandbeyond.com/2013/02/11/cb-2013-dates-finalized-december-9-12-2013/"><em>C++ and Beyond</em> in December</a>, we&#8217;ll see…</p>
<h2>atomic&lt;&gt; Weapons: The C++ Memory Model and Modern Hardware</h2>
<ul style="margin-left:72pt;">
<li><a href="http://channel9.msdn.com/Shows/Going+Deep/Cpp-and-Beyond-2012-Herb-Sutter-atomic-Weapons-1-of-2"><span style="background-color:yellow;"><strong>Part 1:</strong></span> Optimizations, races, and the memory model; acquire and release ordering; mutexes vs. atomics vs. fences</a></li>
<li><a href="http://channel9.msdn.com/Shows/Going+Deep/Cpp-and-Beyond-2012-Herb-Sutter-atomic-Weapons-2-of-2"><span style="background-color:yellow;"><strong>Part 2:</strong></span> Restrictions on compilers and hardware (incl. common bugs); code generation and performance on x86/x64, IA64, POWER, ARM, and more; relaxed atomics; volatile</a></li>
</ul>
<p>This session in one word: <em><strong>Deep.</strong><br />
</em></p>
<p style="margin-left:36pt;">It&#8217;s a session that includes topics I&#8217;ve publicly said for years is Stuff You Shouldn&#8217;t Need To Know and I Just Won&#8217;t Teach, but it&#8217;s becoming achingly clear that people do need to know about it. Achingly, heartbreakingly clear, because some hardware incents you to pull out the big guns to achieve top performance, and C++ programmers just are so addicted to full performance that they&#8217;ll reach for the big red levers with the flashing warning lights. Since we can&#8217;t keep people from pulling the big red levers, we&#8217;d better document the A to Z of what the levers actually do, so that people don&#8217;t <a href="http://en.wikipedia.org/wiki/Scram"><em>SCRAM</em></a> unless they really, really, really meant to.<em><br />
</em></p>
<p style="margin-left:36pt;"><strong>Topics Covered:</strong></p>
<ul style="margin-left:72pt;">
<li><strong>The facts: </strong>The C++11 memory model and what it requires you to do to make sure your code is correct and stays correct. We&#8217;ll include clear answers to several FAQs: &#8220;how do the compiler and hardware cooperate to remember how to respect these rules?&#8221;, &#8220;what is a race condition?&#8221;, and the ageless one-hand-clapping question &#8220;how is a race condition like a debugger?&#8221;</li>
<li><strong>The tools:</strong> The deep interrelationships and fundamental tradeoffs among mutexes, atomics, and fences/barriers. I&#8217;ll try to convince you why standalone memory barriers are bad, and why barriers should always be associated with a specific load or store.</li>
<li><strong>The unspeakables: </strong>I&#8217;ll grudgingly and reluctantly talk about the Thing I Said I&#8217;d Never Teach That Programmers Should Never Need To Now: relaxed atomics. Don&#8217;t use them! If you can avoid it. But here&#8217;s what you need to know, even though it would be nice if you didn&#8217;t need to know it.</li>
<li><strong>The rapidly-changing hardware reality: </strong>How locks and atomics map to hardware instructions on ARM and x86/x64, and throw in POWER and Itanium for good measure – and I&#8217;ll cover how and why the answers are actually different last year and this year, and how they will likely be different again a few years from now. We&#8217;ll cover how the latest CPU and GPU hardware memory models are rapidly evolving, and how this directly affects C++ programmers.</li>
</ul>
									</div>

				<p class="postmetadata">
					Posted in <a href="https://herbsutter.com/category/c/" rel="category tag">C++</a>, <a href="https://herbsutter.com/category/concurrency/" rel="category tag">Concurrency</a>, <a href="https://herbsutter.com/category/talks-events/" rel="category tag">Talks &amp; Events</a> | 											16 Comments									</p>
				
<!-- You can start editing here. -->

<h3 id="comments">16 Responses</h3>

	<ol class="commentlist">
			<li class="comment even thread-even depth-1 highlander-comment" id="comment-23916">
		<div id="div-comment-23916">
		<div class="cmtinfo"><em> on <a href="#comment-23916" title="">2014-08-01 at 7:20 am</a></em> <img alt='' src='https://2.gravatar.com/avatar/2b7eb78419a0ffdbe2905051ff0cbbbd?s=48&#038;d=identicon&#038;r=G' class='avatar avatar-48' height='48' width='48' /> <cite>Pedro Dominguez</cite></div>
						<div class="pd-rating" id="pd_rating_holder_468178_comm_23916"></div><p>Hi Herb,<br />
First of all, thank you for the great talk and for making it available online.<br />
A section of the slides that you couldn&#8217;t cover in the talk was that on the Double-Checked locking pattern (pages 53-56). More specifically, I have a question on page 54, where you propose to use:<br />
if (!create.exchange_explicit(true, memory_order_relaxed)) {&#8230;}<br />
In my opionion, this should be fine based on the standard&#8217;s 29.3/12 (&#8220;Atomic RMW operations shall always read the last value (in the modification order) written before the write associated with the RMW operation&#8221;).<br />
But you wrote on the second slide, as the answer to the initial question: &#8220;No; e.g. could do some widget creation even if CAS fails &#8211; and worse&#8221;.<br />
This doesn&#8217;t look accurate to me, as you are using a plain exchange() and not a compare_exchange_weak(); note the standard allows only the latter to fail.<br />
Am I misinterpreting your proposed implementation?<br />
PS I&#8217;m assuming this code should be able to run in either a weak or strong hardware memory model</p>
			<br style="clear: both" />
		</div>
</li><!-- #comment-## -->
		<li class="comment byuser comment-author-herbsutter bypostauthor odd alt thread-odd thread-alt depth-1 highlander-comment" id="comment-22258">
		<div id="div-comment-22258">
		<div class="cmtinfo"><em> on <a href="#comment-22258" title="">2014-07-03 at 1:14 pm</a></em> <img alt='' src='https://0.gravatar.com/avatar/c0ba56bfd231f8f04feb057728975181?s=48&#038;d=identicon&#038;r=G' class='avatar avatar-48' height='48' width='48' /> <cite><a href='http://www.herbsutter.com' rel='external nofollow' class='url'>Herb Sutter</a></cite></div>
						<div class="pd-rating" id="pd_rating_holder_468178_comm_22258"></div><p>@Jim: See my atomic weapons talk at <a href="http://channel9.msdn.com/Shows/Going+Deep/Cpp-and-Beyond-2012-Herb-Sutter-atomic-Weapons-1-of-2" rel="nofollow">http://channel9.msdn.com/Shows/Going+Deep/Cpp-and-Beyond-2012-Herb-Sutter-atomic-Weapons-1-of-2</a>, where on the slides page 41 mentions the code generation on ARM v8. Note that the C/C++ code looks the same, it just generates more direct code and in some cases allows more processor instruction reordering (examples of reordering appear throughout the presentation).</p>
			<br style="clear: both" />
		</div>
</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1 highlander-comment" id="comment-22253">
		<div id="div-comment-22253">
		<div class="cmtinfo"><em> on <a href="#comment-22253" title="">2014-07-03 at 11:21 am</a></em> <img alt='' src='https://2.gravatar.com/avatar/e5e00a50da728b9af7c929bdf9ef48d4?s=48&#038;d=identicon&#038;r=G' class='avatar avatar-48' height='48' width='48' /> <cite><a href='http://www.industry-academia.org' rel='external nofollow' class='url'>Jim Ballingall</a></cite></div>
						<div class="pd-rating" id="pd_rating_holder_468178_comm_22253"></div><p>Hi Herb, do you have any C/C++ code examples that illustrate how the new lrda and strl in ARMv8 are advantageous over x86? I am looking for a few practical illustrations /exercises for students who might run code on an ARMv8 simulator or board vs their x86 laptop. Thank you, Jim</p>
			<br style="clear: both" />
		</div>
</li><!-- #comment-## -->
		<li class="pingback odd alt thread-odd thread-alt depth-1 highlander-comment" id="comment-18975">
		<div id="div-comment-18975">
		<div class="cmtinfo"><em> on <a href="#comment-18975" title="">2014-04-24 at 2:32 pm</a></em>  <cite><a href='http://tatourian.com/2014/04/24/c-memory-model-and-low-level-atomic-operations/' rel='external nofollow' class='url'>C++ Memory Model and Low-level Atomic Operations | Alan Tatourian</a></cite></div>
						<div class="pd-rating" id="pd_rating_holder_468178_comm_18975"></div><p>[&#8230;] atomic Weapons: The C++ Memory Model and Modern Hardware; Herb Sutter [&#8230;]</p>
			<br style="clear: both" />
		</div>
</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1 highlander-comment" id="comment-13021">
		<div id="div-comment-13021">
		<div class="cmtinfo"><em> on <a href="#comment-13021" title="">2013-10-26 at 9:33 am</a></em> <img alt='' src='https://2.gravatar.com/avatar/e33a452ed13636d8f046d2f8a764cdff?s=48&#038;d=identicon&#038;r=G' class='avatar avatar-48' height='48' width='48' /> <cite>KerrekSB</cite></div>
						<div class="pd-rating" id="pd_rating_holder_468178_comm_13021"></div><p>Could I ask for some clarification? In the &#8220;relaxed&#8221; section of the talk, you have a &#8220;stop&#8221; variable and a relaxed load from it to check whether a thread should end, paired with an SC store &#8220;stop = true;&#8221; in the main thread. Is it actually guaranteed that the store operation propagates and becomes visible eventually? Would such a guarantee depend on the existence of an acquire-release-pair? (I appreciate that actual synchronization isn&#8217;t required in the example and that we don&#8217;t need a release sequence, but I don&#8217;t see how eventual propagation is guaranteed.)</p>
<p>Thanks!</p>
			<br style="clear: both" />
		</div>
</li><!-- #comment-## -->
		<li class="pingback odd alt thread-odd thread-alt depth-1 highlander-comment" id="comment-12072">
		<div id="div-comment-12072">
		<div class="cmtinfo"><em> on <a href="#comment-12072" title="">2013-07-30 at 12:49 am</a></em>  <cite><a href='http://twistedoakstudios.com/blog/Post5096_my-bug-my-bad-4-reading-concurrently' rel='external nofollow' class='url'>Twisted Oak Studios | Unity3D Consulting | Technical Magic</a></cite></div>
						<div class="pd-rating" id="pd_rating_holder_468178_comm_12072"></div><p>[&#8230;] months ago, I watched a talk by Herb Stutter called Atomic Weapons: The C++ Memory Model and Modern Hardware (Part 1, Part 2). One of the lessons from the talk is: if you want sequential consistency, then [&#8230;]</p>
			<br style="clear: both" />
		</div>
</li><!-- #comment-## -->
		<li class="pingback even thread-even depth-1 highlander-comment" id="comment-8637">
		<div id="div-comment-8637">
		<div class="cmtinfo"><em> on <a href="#comment-8637" title="">2013-03-01 at 8:49 am</a></em>  <cite><a href='http://martinecker.com/martincodes/cool-link-stash-february-2013/' rel='external nofollow' class='url'>Martin Codes &#8211; Cool Link Stash, February 2013</a></cite></div>
						<div class="pd-rating" id="pd_rating_holder_468178_comm_8637"></div><p>[&#8230;] one of Herb Sutter&#039;s talks at C++ and Beyond 2012 got released on Channel 9. atomic Weapons: The C++ Memory Model and Modern Hardware is a two-part talk on the new C++11 memory model. This is a must-watch if you&#039;re doing any work on [&#8230;]</p>
			<br style="clear: both" />
		</div>
</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1 highlander-comment" id="comment-8634">
		<div id="div-comment-8634">
		<div class="cmtinfo"><em> on <a href="#comment-8634" title="">2013-02-28 at 11:00 am</a></em> <img alt='' src='https://2.gravatar.com/avatar/26230e55188637785a569c6ec8ca0f3f?s=48&#038;d=identicon&#038;r=G' class='avatar avatar-48' height='48' width='48' /> <cite><a href='http://xwis.net/' rel='external nofollow' class='url'>Olaf van der Spek</a></cite></div>
						<div class="pd-rating" id="pd_rating_holder_468178_comm_8634"></div><p>What if in the example where you&#8217;re talking about benign races, reading x could generate a hardware error (page fault or so) due to being in an unmapped page. Wouldn&#8217;t reading x speculatively (by the compiler) wrongly cause the page fault?</p>
			<br style="clear: both" />
		</div>
</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1 highlander-comment" id="comment-8612">
		<div id="div-comment-8612">
		<div class="cmtinfo"><em> on <a href="#comment-8612" title="">2013-02-25 at 1:06 am</a></em> <img alt='' src='https://i2.wp.com/a0.twimg.com/profile_images/1853417749/387208_10150448403929613_584869612_8494317_103958470_n_normal.jpg?resize=48%2C48' class='avatar avatar-48' height='48' width='48' /> <cite><a href='http://twitter.com/johannesgu' rel='external nofollow' class='url'>Johannes Gustafsson (@johannesgu)</a></cite></div>
						<div class="pd-rating" id="pd_rating_holder_468178_comm_8612"></div><p>Very interesting talk! You mention that .net is not fully SC. Do you know if that is still true or did they fix it in .net 4.5? You also mention this in your &#8220;volatile vs volatile&#8221; paper and that they would fix it in VS2010 but I take it that didn&#8217;t happen?</p>
			<br style="clear: both" />
		</div>
</li><!-- #comment-## -->
		<li class="comment byuser comment-author-herbsutter bypostauthor odd alt thread-odd thread-alt depth-1 highlander-comment" id="comment-8610">
		<div id="div-comment-8610">
		<div class="cmtinfo"><em> on <a href="#comment-8610" title="">2013-02-24 at 11:37 am</a></em> <img alt='' src='https://0.gravatar.com/avatar/c0ba56bfd231f8f04feb057728975181?s=48&#038;d=identicon&#038;r=G' class='avatar avatar-48' height='48' width='48' /> <cite><a href='http://www.herbsutter.com' rel='external nofollow' class='url'>Herb Sutter</a></cite></div>
						<div class="pd-rating" id="pd_rating_holder_468178_comm_8610"></div><p>@peeterjoot: Yes, the instruction sequences shown are for directly mapping each atomic operation in the source in isolation conservatively, so that it&#8217;s correct no matter what else is going on nearby. That&#8217;s a correct baseline code generation strategy, and often sufficient. If your optimizer can see more of what&#8217;s going on in the surrounding context, however, it can further refine the code generation. The example you give is one such case. See also the POWER code gen slide on page 37 of the handouts, where it notes &#8220;you can almost get away with an lwsync here&#8221; (you can indeed get away with it if you little more about other nearby atomic loads and stores in the same thread).</p>
			<br style="clear: both" />
		</div>
</li><!-- #comment-## -->
		<li class="comment byuser comment-author-peeterjoot even thread-even depth-1 highlander-comment" id="comment-8597">
		<div id="div-comment-8597">
		<div class="cmtinfo"><em> on <a href="#comment-8597" title="">2013-02-21 at 3:03 pm</a></em> <img alt='' src='https://1.gravatar.com/avatar/4c61aa34cee48011c78556f07cba11a9?s=48&#038;d=identicon&#038;r=G' class='avatar avatar-48' height='48' width='48' /> <cite><a href='http://peeterjoot.wordpress.com/' rel='external nofollow' class='url'>peeterjoot</a></cite></div>
						<div class="pd-rating" id="pd_rating_holder_468178_comm_8597"></div><p>First off.  Excellent presentation(s)!  I&#8217;d loved to have had this available ten years ago when I was first blundering through these concepts.  I&#8217;ve done similar ones for our internal developers, but liked what you did much better!</p>
<p>In the second presentation, you aren&#8217;t using lwsync for PowerPc, instead are using the heavyweight sync, which is what we&#8217;ve used in our code (for example mutex implementation) since it was available.  Is this because you want the MM to default to not allowing a rel/acq to be reordered?</p>
			<br style="clear: both" />
		</div>
</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1 highlander-comment" id="comment-8572">
		<div id="div-comment-8572">
		<div class="cmtinfo"><em> on <a href="#comment-8572" title="">2013-02-18 at 9:32 pm</a></em> <img alt='' src='https://1.gravatar.com/avatar/a265f369ee0b813c9deece92c893407c?s=48&#038;d=identicon&#038;r=G' class='avatar avatar-48' height='48' width='48' /> <cite>Michael K</cite></div>
						<div class="pd-rating" id="pd_rating_holder_468178_comm_8572"></div><p>Herb, congratulations on pretty good attempt to push arcane knowledge into mainstream. It has been around for at least 17 years (I am referring to wonderful but hard to read paper &#8216;Memory Consistency<br />
Models for Shared-Memory Multiprocessors&#8217; which could be found in many places, e.g. <a href="http://www.hpl.hp.com/techreports/Compaq-DEC/WRL-95-9.pdf" rel="nofollow">http://www.hpl.hp.com/techreports/Compaq-DEC/WRL-95-9.pdf</a>)<br />
Soon &#8216;masters of arcane&#8217; will have to invent something even more twisted (to maintain their status). :-)</p>
			<br style="clear: both" />
		</div>
</li><!-- #comment-## -->
		<li class="comment byuser comment-author-herbsutter bypostauthor even thread-even depth-1 highlander-comment" id="comment-8557">
		<div id="div-comment-8557">
		<div class="cmtinfo"><em> on <a href="#comment-8557" title="">2013-02-17 at 11:49 am</a></em> <img alt='' src='https://0.gravatar.com/avatar/c0ba56bfd231f8f04feb057728975181?s=48&#038;d=identicon&#038;r=G' class='avatar avatar-48' height='48' width='48' /> <cite><a href='http://www.herbsutter.com' rel='external nofollow' class='url'>Herb Sutter</a></cite></div>
						<div class="pd-rating" id="pd_rating_holder_468178_comm_8557"></div><p>@Michael: The slides are now linked from the video page. Here&#8217;s the link for convenience: <a href="https://1drv.ms/b/s!Aq0V7yDPsIZOgcI0y2P8R-VifbnTtw" rel="nofollow">https://1drv.ms/b/s!Aq0V7yDPsIZOgcI0y2P8R-VifbnTtw</a></p>
<p>@Andrea: See the part where I mentioned two kinds of acquire-release: &#8220;plain acq/rel&#8221; and &#8220;sequentially consistent acq/rel.&#8221; The only difference is that the latter forbids reordering a release followed by an acquire. The standard&#8217;s memory_order_seq_cst default means &#8220;sequentially consistent acquire/release&#8221; &#8212; loads are by default &#8220;SC acquire&#8221; and stores are by default &#8220;SC release.&#8221; See the slide &#8220;Enter the memory_order_*&#8221; (page 45 of the handout link) which summarizes these rules.</p>
			<br style="clear: both" />
		</div>
</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1 highlander-comment" id="comment-8556">
		<div id="div-comment-8556">
		<div class="cmtinfo"><em> on <a href="#comment-8556" title="">2013-02-17 at 1:10 am</a></em> <img alt='' src='https://1.gravatar.com/avatar/dd001572ef01005cf4a27107e971638a?s=48&#038;d=identicon&#038;r=G' class='avatar avatar-48' height='48' width='48' /> <cite>Andrea Bigagli</cite></div>
						<div class="pd-rating" id="pd_rating_holder_468178_comm_8556"></div><p>Really liked the talk Herb, I think I get pretty much everything a lot better than before, but I&#8217;m a bit confused about this now:<br />
all the positive ordering effects of atomics are introduced in part 1 in terms of how Acquire/Release form the packaged deal that guarantees the induction of a &#8220;happens-before&#8221; relationship.<br />
But the default memory ordering for atomic operation is std::memory_order_seq_cst (as further explained in part 2), right? So, aren&#8217;t all things introduced in part 1 (related to Acquire/Release) more specific for the cases where you request a std::memory_order_acquire, std::memory_order_release or std::memory_order_acq_rel?<br />
IOW: if using default memory order for atomics, aren&#8217;t all the things explained in part 1 &#8220;over-guaranteed&#8221; because the default std::memory_order_seq_cst is the strongest and hence does all that Acquire/Release do and more? I&#8217;m asking this because after looking at part 1, I got the idea that I reading atomics would use std::memory_order_acquire and writing them would use std::memory_order_release, which I knew wasn&#8217;t true and which you confirm it&#8217;s not true in part 2, the default being std::memory_order_seq_cst&#8230;<br />
Hope I was able to explain my doubt&#8230; </p>
<p>Thanks,<br />
Andrea.</p>
			<br style="clear: both" />
		</div>
</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1 highlander-comment" id="comment-8532">
		<div id="div-comment-8532">
		<div class="cmtinfo"><em> on <a href="#comment-8532" title="">2013-02-12 at 11:09 pm</a></em> <img alt='' src='https://0.gravatar.com/avatar/64abcdfeac5d480fd1f58a7901ad26ee?s=48&#038;d=identicon&#038;r=G' class='avatar avatar-48' height='48' width='48' /> <cite>Michael Marcin</cite></div>
						<div class="pd-rating" id="pd_rating_holder_468178_comm_8532"></div><p>Incredibly good talk, especially part 2. Any chance the slides will be released?</p>
			<br style="clear: both" />
		</div>
</li><!-- #comment-## -->
		<li class="pingback odd alt thread-odd thread-alt depth-1 highlander-comment" id="comment-8526">
		<div id="div-comment-8526">
		<div class="cmtinfo"><em> on <a href="#comment-8526" title="">2013-02-11 at 3:05 pm</a></em>  <cite><a href='http://mjtsai.com/blog/2013/02/11/atomic-weapons/' rel='external nofollow' class='url'>Michael Tsai - Blog - Atomic Weapons: The C++ Memory Model and Modern Hardware</a></cite></div>
						<div class="pd-rating" id="pd_rating_holder_468178_comm_8526"></div><p>[&#8230;] Herb Sutter (via Jean-Francois Roy): [&#8230;]</p>
			<br style="clear: both" />
		</div>
</li><!-- #comment-## -->
	</ol>

	<div class="navigation">
		<div class="alignleft"></div>
		<div class="alignright"></div>
	</div>
	<br />

  	<p class="nocomments">Comments are closed.</p>
  <div class="post-content">
<p>
</p>
</div>

			</div>

		
		<p align="center"></p>

	</div><!-- end id:content-main -->
<div id="sidebar">
<ul>
<li class="sidebox"><h2><label for="subscribe-field">Follow by email</label></h2>
				<form action="https://subscribe.wordpress.com" method="post" accept-charset="utf-8" id="subscribe-blog">
																	<p><input type="text" name="email" style="width: 95%; padding: 1px 2px" placeholder="Enter your email address" value="" id="subscribe-field"/></p>
					
					<p>
						<input type="hidden" name="action" value="subscribe"/>
						<input type="hidden" name="blog_id" value="3379246"/>
						<input type="hidden" name="source" value="https://herbsutter.com/2013/02/11/atomic-weapons-the-c-memory-model-and-modern-hardware/"/>
						<input type="hidden" name="sub-type" value="widget"/>
						<input type="hidden" name="redirect_fragment" value="blog_subscription-3" />
						<input type="hidden" id="_wpnonce" name="_wpnonce" value="4590924cc6" />						<input type="submit" value="Subscribe" />
					</p>
				</form>
			
</li><li class="sidebox"><h2><a href='http://twitter.com/herbsutter'>Tweets</a></h2><ul class='tweets'></ul><a href="http://twitter.com/herbsutter"  class='twitter-follow-button' data-show-count='false' data-link-color='#265e15' data-text-color='#333333'>Follow @herbsutter</a></li><li class="sidebox"><h2>Popular</h2><ul>				<li>
										<a href="https://herbsutter.com/2018/11/13/trip-report-fall-iso-c-standards-meeting-san-diego/" class="bump-view" data-bump-view="tp">
						Trip report: Fall ISO C++ standards meeting (San Diego)					</a>
										</li>
								<li>
										<a href="https://herbsutter.com/gotw/" class="bump-view" data-bump-view="tp">
						GotW					</a>
										</li>
								<li>
										<a href="https://herbsutter.com/2018/09/20/lifetime-profile-v1-0-posted/" class="bump-view" data-bump-view="tp">
						Lifetime profile v1.0 posted					</a>
										</li>
				</ul></li><li class="sidebox"><h2>Categories</h2>		<ul>
				<li class="cat-item cat-item-291"><a href="https://herbsutter.com/category/apple/" >Apple</a>
</li>
	<li class="cat-item cat-item-49277"><a href="https://herbsutter.com/category/c-net/" >C# / .NET</a>
</li>
	<li class="cat-item cat-item-2426"><a href="https://herbsutter.com/category/c/" >C++</a>
</li>
	<li class="cat-item cat-item-69816"><a href="https://herbsutter.com/category/cloud/" >Cloud</a>
</li>
	<li class="cat-item cat-item-214618"><a href="https://herbsutter.com/category/concurrency/" >Concurrency</a>
</li>
	<li class="cat-item cat-item-8259773"><a href="https://herbsutter.com/category/effective-concurrency/" >Effective Concurrency</a>
</li>
	<li class="cat-item cat-item-3696745"><a href="https://herbsutter.com/category/friday-thoughts/" >Friday Thoughts</a>
</li>
	<li class="cat-item cat-item-3867746"><a href="https://herbsutter.com/category/c/gotw/" >GotW</a>
</li>
	<li class="cat-item cat-item-79"><a href="https://herbsutter.com/category/hardware/" >Hardware</a>
</li>
	<li class="cat-item cat-item-1017"><a href="https://herbsutter.com/category/java/" >Java</a>
</li>
	<li class="cat-item cat-item-637"><a href="https://herbsutter.com/category/microsoft/" >Microsoft</a>
</li>
	<li class="cat-item cat-item-420845"><a href="https://herbsutter.com/category/opinion-editorial/" >Opinion &amp; Editorial</a>
</li>
	<li class="cat-item cat-item-1633077"><a href="https://herbsutter.com/category/reader-qa/" >Reader Q&amp;A</a>
</li>
	<li class="cat-item cat-item-2301"><a href="https://herbsutter.com/category/software-development/" >Software Development</a>
</li>
	<li class="cat-item cat-item-393523"><a href="https://herbsutter.com/category/talks-events/" >Talks &amp; Events</a>
</li>
	<li class="cat-item cat-item-1"><a href="https://herbsutter.com/category/uncategorized/" >Uncategorized</a>
</li>
	<li class="cat-item cat-item-151"><a href="https://herbsutter.com/category/web/" >Web</a>
</li>
		</ul>
			</li></ul>
</div><!-- end id:sidebar -->
</div><!-- end id:content -->
</div><!-- end id:container -->
<div id="footer">
	<div id="colophon">
		<p><a href="https://wordpress.com/?ref=footer_blog">Blog at WordPress.com.</a></p>
		<p>WPThemes.</p>
		<br class="clear" />
	</div><!-- end #colophon-->
</div><!-- end #footer-->
<!--  -->
<script type='text/javascript' src='//0.gravatar.com/js/gprofiles.js?ver=201847y'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var WPGroHo = {"my_hash":""};
/* ]]> */
</script>
<script type='text/javascript' src='https://s1.wp.com/wp-content/mu-plugins/gravatar-hovercards/wpgroho.js?m=1380573781h'></script>

	<script>
		//initialize and attach hovercards to all gravatars
		jQuery( document ).ready( function( $ ) {

			if (typeof Gravatar === "undefined"){
				return;
			}

			if ( typeof Gravatar.init !== "function" ) {
				return;
			}			

			Gravatar.profile_cb = function( hash, id ) {
				WPGroHo.syncProfileData( hash, id );
			};
			Gravatar.my_hash = WPGroHo.my_hash;
			Gravatar.init( 'body', '#wp-admin-bar-my-account' );
		});
	</script>

		<div style="display:none">
	<div class="grofile-hash-map-2b7eb78419a0ffdbe2905051ff0cbbbd">
	</div>
	<div class="grofile-hash-map-c0ba56bfd231f8f04feb057728975181">
	</div>
	<div class="grofile-hash-map-e5e00a50da728b9af7c929bdf9ef48d4">
	</div>
	<div class="grofile-hash-map-e33a452ed13636d8f046d2f8a764cdff">
	</div>
	<div class="grofile-hash-map-26230e55188637785a569c6ec8ca0f3f">
	</div>
	<div class="grofile-hash-map-f31fd988e1866788d5d60c02abd4a7d1">
	</div>
	<div class="grofile-hash-map-4c61aa34cee48011c78556f07cba11a9">
	</div>
	<div class="grofile-hash-map-a265f369ee0b813c9deece92c893407c">
	</div>
	<div class="grofile-hash-map-dd001572ef01005cf4a27107e971638a">
	</div>
	<div class="grofile-hash-map-64abcdfeac5d480fd1f58a7901ad26ee">
	</div>
	</div>
<script type='text/javascript' charset='UTF-8' id='polldaddyRatings'><!--//--><![CDATA[//><!--
PDRTJS_settings_468178_comm_23916={"id":468178,"unique_id":"wp-comment-23916","title":"Hi%20Herb%2CFirst%20of%20all%2C%20thank%20you%20for%20the%20great%20talk%20and%20for%20making%20it%20available%20online.A%20section%20of%20the%20slides%20that%20you%20couldn%26%23039%3Bt%20cover%20in%20the%20talk%20was%20that%20on%20the%20Double-Checked%20locking%20pattern%20%28p...","permalink":"https:\/\/herbsutter.com\/2013\/02\/11\/atomic-weapons-the-c-memory-model-and-modern-hardware\/#comment-23916","item_id":"_comm_23916"}; if ( typeof PDRTJS_RATING !== 'undefined' ){if ( typeof PDRTJS_468178_comm_23916 == 'undefined' ){PDRTJS_468178_comm_23916 = new PDRTJS_RATING( PDRTJS_settings_468178_comm_23916 );}}PDRTJS_settings_468178_comm_22258={"id":468178,"unique_id":"wp-comment-22258","title":"%40Jim%3A%20See%20my%20atomic%20weapons%20talk%20at%20http%3A%2F%2Fchannel9.msdn.com%2FShows%2FGoing%2BDeep%2FCpp-and-Beyond-2012-Herb-Sutter-atomic-Weapons-1-of-2%2C%20where%20on%20the%20slides%20page%2041%20mentions%20the%20code%20generation%20on%20AR...","permalink":"https:\/\/herbsutter.com\/2013\/02\/11\/atomic-weapons-the-c-memory-model-and-modern-hardware\/#comment-22258","item_id":"_comm_22258"}; if ( typeof PDRTJS_RATING !== 'undefined' ){if ( typeof PDRTJS_468178_comm_22258 == 'undefined' ){PDRTJS_468178_comm_22258 = new PDRTJS_RATING( PDRTJS_settings_468178_comm_22258 );}}PDRTJS_settings_468178_comm_22253={"id":468178,"unique_id":"wp-comment-22253","title":"Hi%20Herb%2C%20do%20you%20have%20any%20C%2FC%2B%2B%20code%20examples%20that%20illustrate%20how%20the%20new%20lrda%20and%20strl%20in%20ARMv8%20are%20advantageous%20over%20x86%3F%20I%20am%20looking%20for%20a%20few%20practical%20illustrations%20%2Fexercises%20for%20students%20w...","permalink":"https:\/\/herbsutter.com\/2013\/02\/11\/atomic-weapons-the-c-memory-model-and-modern-hardware\/#comment-22253","item_id":"_comm_22253"}; if ( typeof PDRTJS_RATING !== 'undefined' ){if ( typeof PDRTJS_468178_comm_22253 == 'undefined' ){PDRTJS_468178_comm_22253 = new PDRTJS_RATING( PDRTJS_settings_468178_comm_22253 );}}PDRTJS_settings_468178_comm_18975={"id":468178,"unique_id":"wp-comment-18975","title":"%26%23091%3B%26%238230%3B%26%23093%3B%20atomic%20Weapons%3A%20The%20C%2B%2B%20Memory%20Model%20and%20Modern%20Hardware%3B%20Herb%20Sutter%20%26%23091%3B%26%238230%3B%26%23093%3B...","permalink":"https:\/\/herbsutter.com\/2013\/02\/11\/atomic-weapons-the-c-memory-model-and-modern-hardware\/#comment-18975","item_id":"_comm_18975"}; if ( typeof PDRTJS_RATING !== 'undefined' ){if ( typeof PDRTJS_468178_comm_18975 == 'undefined' ){PDRTJS_468178_comm_18975 = new PDRTJS_RATING( PDRTJS_settings_468178_comm_18975 );}}PDRTJS_settings_468178_comm_13021={"id":468178,"unique_id":"wp-comment-13021","title":"Could%20I%20ask%20for%20some%20clarification%3F%20In%20the%20%26quot%3Brelaxed%26quot%3B%20section%20of%20the%20talk%2C%20you%20have%20a%20%26quot%3Bstop%26quot%3B%20variable%20and%20a%20relaxed%20load%20from%20it%20to%20check%20whether%20a%20thread%20should%20end%2C%20paired%20with%20an%20SC%20store%20%26quot%3Bstop...","permalink":"https:\/\/herbsutter.com\/2013\/02\/11\/atomic-weapons-the-c-memory-model-and-modern-hardware\/#comment-13021","item_id":"_comm_13021"}; if ( typeof PDRTJS_RATING !== 'undefined' ){if ( typeof PDRTJS_468178_comm_13021 == 'undefined' ){PDRTJS_468178_comm_13021 = new PDRTJS_RATING( PDRTJS_settings_468178_comm_13021 );}}PDRTJS_settings_468178_comm_12072={"id":468178,"unique_id":"wp-comment-12072","title":"%26%23091%3B%26%238230%3B%26%23093%3B%20months%20ago%2C%20I%20watched%20a%20talk%20by%20Herb%20Stutter%20called%20Atomic%20Weapons%3A%20The%20C%2B%2B%20Memory%20Model%20and%20Modern%20Hardware%20%28Part%201%2C%20Part%202%29.%20One%20of%20the%20lessons%20from%20the%20talk%20is%3A%20if%20you%20want%20sequentia...","permalink":"https:\/\/herbsutter.com\/2013\/02\/11\/atomic-weapons-the-c-memory-model-and-modern-hardware\/#comment-12072","item_id":"_comm_12072"}; if ( typeof PDRTJS_RATING !== 'undefined' ){if ( typeof PDRTJS_468178_comm_12072 == 'undefined' ){PDRTJS_468178_comm_12072 = new PDRTJS_RATING( PDRTJS_settings_468178_comm_12072 );}}PDRTJS_settings_468178_comm_8637={"id":468178,"unique_id":"wp-comment-8637","title":"%26%23091%3B...%26%23093%3B%20one%20of%20Herb%20Sutter%26%23039%3Bs%20talks%20at%20C%2B%2B%20and%20Beyond%202012%20got%20released%20on%20Channel%209.%20atomic%20Weapons%3A%20The%20C%2B%2B%20Memory%20Model%20and%20Modern%20Hardware%20is%20a%20two-part%20talk%20on%20the%20new%20C%2B%2B11%20memory%20model.%20...","permalink":"https:\/\/herbsutter.com\/2013\/02\/11\/atomic-weapons-the-c-memory-model-and-modern-hardware\/#comment-8637","item_id":"_comm_8637"}; if ( typeof PDRTJS_RATING !== 'undefined' ){if ( typeof PDRTJS_468178_comm_8637 == 'undefined' ){PDRTJS_468178_comm_8637 = new PDRTJS_RATING( PDRTJS_settings_468178_comm_8637 );}}PDRTJS_settings_468178_comm_8634={"id":468178,"unique_id":"wp-comment-8634","title":"What%20if%20in%20the%20example%20where%20you%26%23039%3Bre%20talking%20about%20benign%20races%2C%20reading%20x%20could%20generate%20a%20hardware%20error%20%28page%20fault%20or%20so%29%20due%20to%20being%20in%20an%20unmapped%20page.%20Wouldn%26%23039%3Bt%20reading%20x%20speculatively%20%28by...","permalink":"https:\/\/herbsutter.com\/2013\/02\/11\/atomic-weapons-the-c-memory-model-and-modern-hardware\/#comment-8634","item_id":"_comm_8634"}; if ( typeof PDRTJS_RATING !== 'undefined' ){if ( typeof PDRTJS_468178_comm_8634 == 'undefined' ){PDRTJS_468178_comm_8634 = new PDRTJS_RATING( PDRTJS_settings_468178_comm_8634 );}}PDRTJS_settings_468178_comm_8612={"id":468178,"unique_id":"wp-comment-8612","title":"Very%20interesting%20talk%21%20You%20mention%20that%20.net%20is%20not%20fully%20SC.%20Do%20you%20know%20if%20that%20is%20still%20true%20or%20did%20they%20fix%20it%20in%20.net%204.5%3F%20You%20also%20mention%20this%20in%20your%20%26quot%3Bvolatile%20vs%20volatile%26quot%3B%20paper%20and%20that...","permalink":"https:\/\/herbsutter.com\/2013\/02\/11\/atomic-weapons-the-c-memory-model-and-modern-hardware\/#comment-8612","item_id":"_comm_8612"}; if ( typeof PDRTJS_RATING !== 'undefined' ){if ( typeof PDRTJS_468178_comm_8612 == 'undefined' ){PDRTJS_468178_comm_8612 = new PDRTJS_RATING( PDRTJS_settings_468178_comm_8612 );}}PDRTJS_settings_468178_comm_8610={"id":468178,"unique_id":"wp-comment-8610","title":"%40peeterjoot%3A%20Yes%2C%20the%20instruction%20sequences%20shown%20are%20for%20directly%20mapping%20each%20atomic%20operation%20in%20the%20source%20in%20isolation%20conservatively%2C%20so%20that%20it%26%23039%3Bs%20correct%20no%20matter%20what%20else%20is%20going%20on%20ne...","permalink":"https:\/\/herbsutter.com\/2013\/02\/11\/atomic-weapons-the-c-memory-model-and-modern-hardware\/#comment-8610","item_id":"_comm_8610"}; if ( typeof PDRTJS_RATING !== 'undefined' ){if ( typeof PDRTJS_468178_comm_8610 == 'undefined' ){PDRTJS_468178_comm_8610 = new PDRTJS_RATING( PDRTJS_settings_468178_comm_8610 );}}PDRTJS_settings_468178_comm_8597={"id":468178,"unique_id":"wp-comment-8597","title":"First%20off.%20%20Excellent%20presentation%28s%29%21%20%20I%26%23039%3Bd%20loved%20to%20have%20had%20this%20available%20ten%20years%20ago%20when%20I%20was%20first%20blundering%20through%20these%20concepts.%20%20I%26%23039%3Bve%20done%20similar%20ones%20for%20our%20internal%20developers%2C...","permalink":"https:\/\/herbsutter.com\/2013\/02\/11\/atomic-weapons-the-c-memory-model-and-modern-hardware\/#comment-8597","item_id":"_comm_8597"}; if ( typeof PDRTJS_RATING !== 'undefined' ){if ( typeof PDRTJS_468178_comm_8597 == 'undefined' ){PDRTJS_468178_comm_8597 = new PDRTJS_RATING( PDRTJS_settings_468178_comm_8597 );}}PDRTJS_settings_468178_comm_8572={"id":468178,"unique_id":"wp-comment-8572","title":"Herb%2C%20congratulations%20on%20pretty%20good%20attempt%20to%20push%20arcane%20knowledge%20into%20mainstream.%20It%20has%20been%20around%20for%20at%20least%2017%20years%20%28I%20am%20referring%20to%20wonderful%20but%20hard%20to%20read%20paper%20%26%23039%3BMemory%20Consist...","permalink":"https:\/\/herbsutter.com\/2013\/02\/11\/atomic-weapons-the-c-memory-model-and-modern-hardware\/#comment-8572","item_id":"_comm_8572"}; if ( typeof PDRTJS_RATING !== 'undefined' ){if ( typeof PDRTJS_468178_comm_8572 == 'undefined' ){PDRTJS_468178_comm_8572 = new PDRTJS_RATING( PDRTJS_settings_468178_comm_8572 );}}PDRTJS_settings_468178_comm_8557={"id":468178,"unique_id":"wp-comment-8557","title":"%40Michael%3A%20The%20slides%20are%20now%20linked%20from%20the%20video%20page.%20Here%26%23039%3Bs%20the%20link%20for%20convenience%3A%20https%3A%2F%2F1drv.ms%2Fb%2Fs%21Aq0V7yDPsIZOgcI0y2P8R-VifbnTtw%40Andrea%3A%20See%20the%20part%20where%20I%20mentioned%20two%20kinds%20of%20ac...","permalink":"https:\/\/herbsutter.com\/2013\/02\/11\/atomic-weapons-the-c-memory-model-and-modern-hardware\/#comment-8557","item_id":"_comm_8557"}; if ( typeof PDRTJS_RATING !== 'undefined' ){if ( typeof PDRTJS_468178_comm_8557 == 'undefined' ){PDRTJS_468178_comm_8557 = new PDRTJS_RATING( PDRTJS_settings_468178_comm_8557 );}}PDRTJS_settings_468178_comm_8556={"id":468178,"unique_id":"wp-comment-8556","title":"Really%20liked%20the%20talk%20Herb%2C%20I%20think%20I%20get%20pretty%20much%20everything%20a%20lot%20better%20than%20before%2C%20but%20I%26%23039%3Bm%20a%20bit%20confused%20about%20this%20now%3A%20all%20the%20positive%20ordering%20effects%20of%20atomics%20are%20introduced%20in%20pa...","permalink":"https:\/\/herbsutter.com\/2013\/02\/11\/atomic-weapons-the-c-memory-model-and-modern-hardware\/#comment-8556","item_id":"_comm_8556"}; if ( typeof PDRTJS_RATING !== 'undefined' ){if ( typeof PDRTJS_468178_comm_8556 == 'undefined' ){PDRTJS_468178_comm_8556 = new PDRTJS_RATING( PDRTJS_settings_468178_comm_8556 );}}PDRTJS_settings_468178_comm_8532={"id":468178,"unique_id":"wp-comment-8532","title":"Incredibly%20good%20talk%2C%20especially%20part%202.%20Any%20chance%20the%20slides%20will%20be%20released%3F...","permalink":"https:\/\/herbsutter.com\/2013\/02\/11\/atomic-weapons-the-c-memory-model-and-modern-hardware\/#comment-8532","item_id":"_comm_8532"}; if ( typeof PDRTJS_RATING !== 'undefined' ){if ( typeof PDRTJS_468178_comm_8532 == 'undefined' ){PDRTJS_468178_comm_8532 = new PDRTJS_RATING( PDRTJS_settings_468178_comm_8532 );}}PDRTJS_settings_468178_comm_8526={"id":468178,"unique_id":"wp-comment-8526","title":"%26%23091%3B...%26%23093%3B%20Herb%20Sutter%20%28via%20Jean-Francois%20Roy%29%3A%20%26%23091%3B...%26%23093%3B...","permalink":"https:\/\/herbsutter.com\/2013\/02\/11\/atomic-weapons-the-c-memory-model-and-modern-hardware\/#comment-8526","item_id":"_comm_8526"}; if ( typeof PDRTJS_RATING !== 'undefined' ){if ( typeof PDRTJS_468178_comm_8526 == 'undefined' ){PDRTJS_468178_comm_8526 = new PDRTJS_RATING( PDRTJS_settings_468178_comm_8526 );}}
//--><!]]></script><script type='text/javascript' charset='UTF-8' src='https://polldaddy.com/js/rating/rating.js'></script><script type='text/javascript' src='https://platform.twitter.com/widgets.js?ver=20111117'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var actionbardata = {"siteID":"3379246","siteName":"Sutter\u2019s Mill","siteURL":"https:\/\/herbsutter.com","icon":"<img alt='' src='https:\/\/secure.gravatar.com\/blavatar\/4554b8d24c7f200dc5e2e1b18db1893f?s=50&d=https%3A%2F%2Fs2.wp.com%2Fi%2Flogo%2Fwpcom-gray-white.png' class='avatar avatar-50' height='50' width='50' \/>","canManageOptions":"","canCustomizeSite":"","isFollowing":"","themeSlug":"pub\/mistylook","signupURL":"https:\/\/wordpress.com\/start\/","loginURL":"https:\/\/herbsutter.wordpress.com\/wp-login.php?redirect_to=https%3A%2F%2Fherbsutter.com%2F2013%2F02%2F11%2Fatomic-weapons-the-c-memory-model-and-modern-hardware%2F","themeURL":"","xhrURL":"https:\/\/herbsutter.com\/wp-admin\/admin-ajax.php","nonce":"8fb9818ae2","isSingular":"1","isFolded":"","isLoggedIn":"","isMobile":"","subscribeNonce":"<input type=\"hidden\" id=\"_wpnonce\" name=\"_wpnonce\" value=\"4590924cc6\" \/>","referer":"https:\/\/herbsutter.com\/2013\/02\/11\/atomic-weapons-the-c-memory-model-and-modern-hardware\/","canFollow":"1","feedID":"171936","statusMessage":"","customizeLink":"https:\/\/herbsutter.wordpress.com\/wp-admin\/customize.php?url=https%3A%2F%2Fherbsutter.wordpress.com%2F2013%2F02%2F11%2Fatomic-weapons-the-c-memory-model-and-modern-hardware%2F","postID":"1784","shortlink":"https:\/\/wp.me\/peb5Y-sM","canEditPost":"","editLink":"https:\/\/wordpress.com\/post\/herbsutter.com\/1784","statsLink":"https:\/\/wordpress.com\/stats\/post\/1784\/herbsutter.com","i18n":{"view":"View site","follow":"Follow","following":"Following","edit":"Edit","login":"Log in","signup":"Sign up","customize":"Customize","report":"Report this content","themeInfo":"Get theme: MistyLook","shortlink":"Copy shortlink","copied":"Copied","followedText":"New posts from this site will now appear in your <a href=\"https:\/\/wordpress.com\/\">Reader<\/a>","foldBar":"Collapse this bar","unfoldBar":"Expand this bar","editSubs":"Manage subscriptions","viewReader":"View site in Reader","viewReadPost":"View post in Reader","subscribe":"Sign me up","enterEmail":"Enter your email address","followers":"Join 19,532 other followers","alreadyUser":"Already have a WordPress.com account? <a href=\"https:\/\/herbsutter.wordpress.com\/wp-login.php?redirect_to=https%3A%2F%2Fherbsutter.com%2F2013%2F02%2F11%2Fatomic-weapons-the-c-memory-model-and-modern-hardware%2F\">Log in now.<\/a>","stats":"Stats"}};
/* ]]> */
</script>
<script type='text/javascript' src='https://s0.wp.com/_static/??-eJyVjcEOgjAQRH/IuoIYT8Zvqe2GLrQLdlvAv7ceJEYTEg+bTGbe7MA8KjNwQk7QCVicyOC47DvZwUcUshp9bokFPPUocM+Y0Wm2HuM3/CblwUkvjlrnyyWMv87GjraBWN10hKCloEWpYcIYyZb91fvzQ4ra9LJVMokGfpVWVehruFSnujo0x+Zcd0+y+3Rn'></script>
<script type="text/javascript">
// <![CDATA[
(function() {
try{
  if ( window.external &&'msIsSiteMode' in window.external) {
    if (window.external.msIsSiteMode()) {
      var jl = document.createElement('script');
      jl.type='text/javascript';
      jl.async=true;
      jl.src='/wp-content/plugins/ie-sitemode/custom-jumplist.php';
      var s = document.getElementsByTagName('script')[0];
      s.parentNode.insertBefore(jl, s);
    }
  }
}catch(e){}
})();
// ]]>
</script><script src="//stats.wp.com/w.js?56" type="text/javascript" async defer></script>
<script type="text/javascript">
_tkq = window._tkq || [];
_stq = window._stq || [];
_tkq.push(['storeContext', {'blog_id':'3379246','blog_tz':'-8','user_lang':'en','blog_lang':'en','user_id':'0'}]);
_stq.push(['view', {'blog':'3379246','v':'wpcom','tz':'-8','user_id':'0','post':'1784','subd':'herbsutter'}]);
_stq.push(['extra', {'crypt':'UE40eW5QN0p8M2Y/RE1TaVhzUzFMbjdWNHpwZGhTayxPSUFCMGNrd29+Smw0TDhnZmRTK0hlRi9QSGh6bi9GXVhBJWIlZlR5U1JMLU8/MkNtblkvY1d1TjBELytHc0k/MXdHUVQyK2IyUVA5SjU1bj9VX3ExLHYsREFpcnlfNHYtXV1HSUIsLkJrcnp0eS5sLmtYcy9deTl3OERpNWt3bCYsZ0dCaDdRaVNuVzNYcnlyQlh3ZGpPdmkvRkVJRkNZTS5OXUtaMjQzci09fk0uNkROMTJSSEhCM011bXc2JXpwVXx4amw2cXJvNWQxeWdmLnxNZVl5WkFdZT0mcHR2Rks3TGV+WG9pXUVSU3E/NEtTb0lnciVTOVdfLi5PM2V1SnV8TX5HfEhjMmU9TWpIWD9CRk1tQSVoRU84L0M1QkUrbFtGU1BULVJxTlNhZn5XQlo0WElUQw=='}]);
_stq.push([ 'clickTrackerInit', '3379246', '1784' ]);
	</script>
<noscript><img src="https://pixel.wp.com/b.gif?v=noscript" style="height:0px;width:0px;overflow:hidden" alt="" /></noscript>
<script>
if ( 'object' === typeof wpcom_mobile_user_agent_info ) {

	wpcom_mobile_user_agent_info.init();
	var mobileStatsQueryString = "";
	
	if( false !== wpcom_mobile_user_agent_info.matchedPlatformName )
		mobileStatsQueryString += "&x_" + 'mobile_platforms' + '=' + wpcom_mobile_user_agent_info.matchedPlatformName;
	
	if( false !== wpcom_mobile_user_agent_info.matchedUserAgentName )
		mobileStatsQueryString += "&x_" + 'mobile_devices' + '=' + wpcom_mobile_user_agent_info.matchedUserAgentName;
	
	if( wpcom_mobile_user_agent_info.isIPad() )
		mobileStatsQueryString += "&x_" + 'ipad_views' + '=' + 'views';

	if( "" != mobileStatsQueryString ) {
		new Image().src = document.location.protocol + '//pixel.wp.com/g.gif?v=wpcom-no-pv' + mobileStatsQueryString + '&baba=' + Math.random();
	}
	
}
</script></body>
</html>